const request = require("request-promise");
const Emitter = require("events").EventEmitter;
const debug = require('debug');
const FileCookieStore = require('tough-cookie-filestore');
const md5 = require("md5");
const fs = require("fs");
const getMocker = require("./fake.js");

//request.debug = true;
const system = {
	userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36"
};
/**
 * I don't know what this is, just input a array ,output a number
 * JUST USE IN KEY POINT
 * 
 * @param  {[array]}
 * @return {[number]}
 */
const evalSet = function(a) {
    var b = a && typeof a === "object" && !(a instanceof String) && a.length > 0;
    if (b) {
        for (var c = 0; c < a.length; c += 1) {
            a[c] = evalSet(a[c])
        }
    }
    return b && a[0] === "+" ? a[1] + a[2] : b && a[0] === "-" ? a[1] - a[2] : b && a[0] === "*" ? a[1] * a[2] : b && a[0] === "/" ? a[1] / a[2] : b && a[0] === "%" ? a[1] % a[2] : b && a[0] === "|" ? a[1] | a[2] : b && a[0] === "&" ? a[1] & a[2] : b && a[0] === "^" ? Math.pow(a[1], a[2]) : b && a[0] === "l" ? a[1].length : b && a[0] === "abs" ? Math.abs(a[1]) : b && a[0] === "sin" ? Math.sin(a[1]) : b && a[0] === "cos" ? Math.cos(a[1]) : b && a[0] === "tan" ? Math.tan(a[1]) : b && a[0] === "#" ? Math.sqrt(a[1]) : b && a[0] === "@" ? Math.log(a[1]) / Math.log(a[2]) : a
};
const actions = {
	/**
	 * just get a cookie
	 * 
	 */
	scanItem: {
		url: (context, lastRes) => context.iphone.detailUrl,
		method: "get"
	},
	selectItem: {
		url: (context, lastRes) => context.iphone.detailUrl,
		method: "get",
		params: (context, lastRes) =>{
			const {product, dimensionCapacity, dimensionColor, dimensionScreensize} = context.iphone;
			return {
				product, dimensionCapacity, dimensionColor, dimensionScreensize,
				"purchaseOption": "fullPrice",
				"step":"select",
				"complete":true,
				"add-to-cart":"add-to-cart"
			}
		}
	},
	addBag: {
		/*redefined it*/
		url: context => `https://www.apple.com/cn/shop/buy-iphone/${context.iphone.name}`,
		method: "get",
		params: context => ({
			
			"product": context.iphone.product,

			"proceed":"proceed",
			"step":"attach"
		})
	},
	scanBag: {
		url: "https://www.apple.com/cn/shop/bag",
		method: "get",
		parser: function(rawRes){
			const result = {
				itemName: rawRes.match(/\[\"(item-.{36})\"\]/)[1],
				//  "x-aos-stk":"6e5d32c3"
				"x-aos-stk": rawRes.match(/"x-aos-stk":"(.{8})"/)[1]
			}
			this.context.session.quantity = result;
			return result;
		}
		/*
		 * the response is like below
		 *
		 *	{"meta":{"v":"1.0","l":["/shoppingCart"],"h":{"x-aos-stk":"6e5d32c3"}},"shoppingCart":{"d":{"metricId":"09b9ae3958b77dda14efbf47d91fb7cf","evar1":"AOS: Bag | Bag | Continue shopping | ","hasItems":true,"id":"cart","showFinancingInfoMessage":false},"a":{"checkout":{"url":"/cn/shop/bagx/checkout_now?_a=checkout&_m=shoppingCart","submit":true,"module":"shoppingCart"}},"c":["recommendations","banner","items","footnotes","summary","actions"],"v":[{"id":"cart","template":"{{#if _c_recommendedSystem}} <div id=\"recommended-system\"></div> {{/if}} {{#hasItems}} <div id=\"{{id}}-header\"></div> {{#if _c_addToCart}} <div id=\"add-to-cart\"></div> {{/if}} {{#_c_items}} {{> CartItems }} {{/_c_items}}  {{#_c_summary}} {{> OfferSummary }} {{/_c_summary}} <div id=\"{{id}}-actions\" class=\"hrt nmh10\"></div> {{/hasItems}} {{^hasItems}} {{#if _c_addToCart}} <div id=\"add-to-cart\"></div> {{/if}} <div class=\"tac ptl hrt empty-cart-container\"> <div class=\"fwb ptl  pbs fsm\" id=\"{{id}}-items-empty\"> <p>你的购物袋内没有产品</p> {{#signInUrl}} <p class=\"pbs fwb fsm\"> 如果你已有帐户， <a href=\"{{signInUrl}}\" data-evar1=\"{{signInEvar1}}\" data-s-object-id=\"{{signInMetricId}}\" data-autom=\"bagsigninlink\">登录</a> 即可查看购物袋。 </p> {{/signInUrl}} </div> <div id=\"cookies-message\" class=\"pvl tac\"><span> 如果你已将货品放入购物袋，但购物袋仍为空，可能是因为你在浏览器设置中禁用了 Cookie。如果禁用了 Cookie，请启用接受 Cookie，然后再试一次。 </span></div>  <div class=\"empty-cart-action-container hrt \"> <div class=\"empty-cart-action-group\">  <div class=\"tal\"> <ul class=\"clearfix cart-actions-left-inner\"> <li> <a href=\"{{shopAccessoriesLink}}\" data-evar1=\"{{accessoriesEvar1}}\" data-s-object-id=\"{{metricId}}\" class=\"link\" data-autom=\"{{automationData}}\"> <span class=\"\">{{shopAccessoriesLinkDisplay}}</span> </a> </li> <li> <a href=\"/cn/shop/bag/saved_bags\" class=\"link pipe\" data-autom=\"bagviewsavebagslink\"> <span>查看已保存的购物袋</span> </a> </li> </ul> </div> <div class=\"tar\"> <a class=\"button continue-shopping\" href=\"/cn/.\" data-evar1=\"{{evar1}}\" data-s-object-id=\"{{metricId}}\" data-autom=\"bagcontinueshoppinglink\"> <span class=\"icon-home\"></span>  继续购物 </a> </div>   </div> </div> </div> {{/hasItems}} "}],"recommendations":{"d":{"id":"cart-recommendations"},"b":{"items":{"id":"cart-recommendations-items","p":{"visible":{"get":"^d.hasItems"}}}},"c":{"f":{"abstract":"/abs.RecommendedItem","url":"/cn/shop/recommendedForYou-mvc?allProducts=MNFQ2CH/A&product=MNFQ2CH/A","key":"body.content.items","name":"recommendedItem","data":{"id":"cart-recommendations-item-"}},"d":{"id":"cart-recommendations-item"}},"v":[{"id":"cart-recommendations","template":"{{#if items_visible}} {{#if _c.length}} <div id=\"{{id}}\" class=\"recommendations inset-row mbs box box--white box--is-rounded box--has-shadow mvm pbl ptm \"> <div class=\"grid-row phm\"> <h2 class=\"fst pvs mbm hrb fwl\">为你推荐</h2> </div> <ul class=\"row  phm pts\"> {{#each _c}}{{> RecommendedItem }}{{/each}} </ul> </div> <div class=\"platter-break\"></div> {{/if}} {{/if}} "}],"recommendedItem":{"f":{"abstract":"/abs.RecommendedItem","url":"/cn/shop/recommendedForYou-mvc?allProducts=MNFQ2CH/A&product=MNFQ2CH/A","key":"body.content.items","name":"recommendedItem","data":{"id":"cart-recommendations-item-"}},"d":{"id":"cart-recommendations-item"}}},"banner":{"f":{"abstract":"/abs.BagBanner"},"d":{"id":"bag-banner","_visible":false,"deliveryMessageBannerEnabled":true,"deliveryMessage":"免费送货，还可免费退货。"}},"items":{"d":{"id":"cart-items","disableRemove":false,"_editing":true},"p":{"editing":true},"c":["item-b64d9529-d08a-467f-955e-c34a8e41c197"],"v":[{"id":"cart-items","template":"<ul class=\"inset-row\" id=\"{{id}}\"> {{#each _c}} {{>CartItem}} {{/each}} </ul> ","name":"CartItems"}],"item-b64d9529-d08a-467f-955e-c34a8e41c197":{"f":{"abstract":"/abs.CartItem"},"d":{"name":"iPhone 7 Plus 128GB 银色","productEvar1":"AOS: Bag | Bag |  | MNFQ2CH/A","quantity":2,"productUrl":"/cn/shop/product/MNFQ2CH/A/5.5-%E8%8B%B1%E5%AF%B8%E5%B1%8F%E5%B9%95-128gb-%E9%93%B6%E8%89%B2","showSingleHeader":false,"wasUpdateQuantityInvoked":false,"height":78,"data-scale-params-1":"wid=110&hei=78&fmt=jpeg&qlt=95&op_sharpen=0&resMode=bicub&op_usm=0.5,1.5,0,0&iccEmbed=0&layer=comp&.v=1472430173129","canShareCartItem":false,"totalPrice":"RMB 12,776","id":"cart-items-item-b64d9529-d08a-467f-955e-c34a8e41c197","alt":"","isBlockProductDetails":false,"src":"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone7/plus/iphone7-plus-silver-select-2016?wid=220&hei=156&fmt=jpeg&qlt=80&op_sharpen=0&resMode=bicub&op_usm=0.5,1.5,0,0&iccEmbed=0&layer=comp&.v=1472430173129","productId":"MNFQ2CH/A","unitPrice":"RMB 6,388","productMetricId":"2901f235e72a40c5f09e9a548ebb6e60","originalQty":2,"width":110,"showQuantity":true},"b":{"delete":{"id":"cart-items-item-b64d9529-d08a-467f-955e-c34a8e41c197-delete","events":[{"on":"click","do":["a.delete",{"set":"d.removing","to":true},{"set":"^d.disableRemove","to":true}],"metric":"t.removeItem"}]}},"a":{"delete":{"url":"/cn/shop/bagx?_a=delete&_m=shoppingCart.items.item-b64d9529-d08a-467f-955e-c34a8e41c197","module":"shoppingCart.items.item-b64d9529-d08a-467f-955e-c34a8e41c197"},"updateQuantity":{"url":"/cn/shop/bagx?_a=updateQuantity&_m=shoppingCart.items.item-b64d9529-d08a-467f-955e-c34a8e41c197","submit":true,"module":"shoppingCart.items.item-b64d9529-d08a-467f-955e-c34a8e41c197"}},"t":{"removeItem":{"microEvents":[{"key":"prop37","value":"RemoveItem","feature":"Bag"}],"macroEvents":"scRemove","products":"iphone;MNFQ2;2;12776.00;event101 = 2 | event102 = 12776.00"}},"c":["confirmDeleteOverlay","delivery"],"confirmDeleteOverlay":{"f":{"abstract":"/abs.ConfirmDeleteOverlay"},"d":{"id":"cart-items-item-b64d9529-d08a-467f-955e-c34a8e41c197-confirmDeleteOverlay"}},"delivery":{"f":{"abstract":"/abs.ItemDelivery"},"d":{"id":"cart-items-item-b64d9529-d08a-467f-955e-c34a8e41c197-delivery","sthEnabled":true,"ships":{"showShipLabel":false,"shipMethodQuote":[{"date":"1 个工作日","postfix":null,"isLast":true}],"resolvedShipLabel":"发货："}}}}},"footnotes":{"d":{"id":"amount-due-text","exitWithBuyUp":false},"v":[{"id":"amount-due-text","template":"{{#if exitWithBuyUp}}*The Remaining iPhone Upgrade Program Balance is based on information provided by Citizens One regarding payments made to date. It will be re-calculated when your iPhone ships or becomes available for pickup.{{/if}}"}]},"summary":{"d":{"showTaxInclusivePrices":true,"financingMessage":"<span class=\"installments\">   <br />   分期每月最低约 <span class=\"nowrap\">RMB 1,103</span>。   <br />   <a href=\"/cn/shop/browse/finance/installments\" name=\"browse\" class=\"more\" target=\"_blank\">更多信息</a>    </span>","total":"RMB 12,776","id":"cart-summary","totalNoShip":"RMB 12,776","showBuacMessage":false,"showInstallmentMessage":false,"shipping":{"cost":"RMB 0","free":true,"enabled":true}},"c":["initialAmountDue"],"v":[{"id":"cart-summary","template":"  <div id=\"{{id}}\" class=\"inset-row clearfix\"> <div class=\"summary-container hrt clearfix\"> <ul class=\"gs cart-message\" role=\"presentation\"> <li><ul id=\"{{id}}-deliveryDatesOverlay\"><li></li></ul></li> <li></li> <li></li> {{#showInstallmentMessage}} <li>Installments are only available on single item purchases.</li> {{/showInstallmentMessage}} {{#showBuacMessage}} <li class=\"buac\"> <span class=\"buac-help-message-img\"><img src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/b/ua/buac/asterisk/buac-asterisk?wid=11&amp;hei=13&amp;fmt=png-alpha&amp;qlt=95&amp;.v=As8kd0\" alt=\"“transaction.cart.asterisk”/\" width=\"11\" height=\"13\" class=\"ir\" /> </span>\n&nbsp;<span class=\"buac-help-message-text\"> Shipping and pickup options can be selected in Checkout.</span> </li> {{/showBuacMessage}} <li {{#showBuacMessage}}class=\"hidden\"{{/showBuacMessage}}> {{#showFinancingMessage 'general'}}{{#if content}}{{{content}}}{{/content}}{{/showFinancingMessage}} </li> {{#financeCalculatorUrl}} <li><a href=\"{{financeCalculatorUrl}}\" id=\"estimate-your-monthly-amount\" class=\"finance-calculator-link\" rel=\"nofollow\" role=\"button\">{{financeCalculatorText}} </a></li> {{/financeCalculatorUrl}} </ul> <div class=\"offer-summary cmg\"> <table class=\"r-align\"> <caption><span class=\"a11y\">总费用明细</span></caption> <tr {{#unless subtotal}}class=\"hidden\"{{/unless}}> {{#if subtotal}} <th class=\"label\" data-autom=\"bagsubtotallabel\">购物袋小计</th> <td data-autom=\"bagsubtotalvalue\">{{subtotal}}</td> {{/if}} </tr> <tr {{#unless installmentTotal}}class=\"hidden\"{{/unless}}> {{#if installmentTotal}} <th class=\"label\" data-autom=\"baginstallmenttotallabel\">Total Amount</th> <td data-autom=\"baginstallmenttotalvalue\">{{installmentTotal}}</td> {{/if}} </tr> <tr {{#unless installmentTotalFinanced}}class=\"hidden\"{{/unless}}> {{#if installmentTotalFinanced}} <th class=\"label\" data-autom=\"bagfinancedlabel\">Total Financed Via Citizens One</th> <td data-autom=\"bagfinancedvalue\">{{installmentTotalFinanced}}</td> {{/if}} </tr> <tr {{#unless shipping}}class=\"hidden\"{{/unless}}> {{#shipping}} <td class=\"label\" data-autom=\"bagshippinglabel\"> {{#addForFreeShipping}} <span class=\"label add-shipping text-alert\">{{.}}</span> {{/addForFreeShipping}} {{#free}} <span class=\"label free-shipping\">免费送货</span>{{/free}} {{^free}} <span class=\"label\">送货</span>{{/free}} </td> <td data-autom=\"bagshippingvalue\" {{#free}}class=\"free-shipping\"{{/free}}>{{cost}}</td> {{/shipping}} </tr> <tr class=\"text-alert {{#unless savings}}hidden{{/unless}}\"> {{#savings}} <td class=\"label\"> 优惠 </td> <td>{{savings}}</td> {{/savings}} </tr> <tr id=\"tax-calculator\" > {{^taxCalculatorEnabled}} {{#tax}} <td class=\"label\">GST</td> <td>{{.}}</td> {{/tax}} {{/taxCalculatorEnabled}} </tr> <tr class=\"offer-upgrade cmg {{#unless upgrade}}hidden{{/unless}}\"> {{#upgrade}} <th class=\"label\">{{upgradePaymentLabel}}</th> <td>{{upgradeProgramBalance}}</td> {{/upgrade}} </tr> <tr {{#unless installmentsremainingpayments}}class=\"hidden\"{{/unless}}> {{#if installmentsremainingpayments}} <th class=\"label\" data-autom=\"baginstallmentremaininglabel\">First Monthly Installment</th> <td data-autom=\"baginstallmentremainingvalue\">{{installmentsremainingpayments}}</td> {{/if}} </tr> {{^totalDisable}} <tr class=\"offer-total fsl fweb\"> <td class=\"label total-top\" data-autom=\"bagtotallabel\">总计</td> <td class=\"offer-total-value total-top\" data-autom=\"bagtotalvalue\">{{total}}</td> </tr> {{/totalDisable}} {{#if installmentsAmountDue}} <tr id=\"intial-amount-due\" class=\"offer-total fsl fweb\"></tr> {{/if}} <tr class=\"text-alert {{#unless totalSavings}}hidden{{/unless}}\"> {{#if totalSavings}} <td class=\"label\">优惠总计</td> <td>{{totalSavings}}</td> {{/if}} </tr> <tr class=\"text-alert {{#unless totalSavingsInclusiveTax}}hidden{{/unless}}\"> {{#if totalSavingsInclusiveTax}} <td class=\"label\">优惠总计</td> <td>{{totalSavingsInclusiveTax}}</td> {{/if}} </tr> <tr {{#unless taxExclusiveTax}}class=\"hidden\"{{/unless}}> {{#if taxExclusiveTax}} <td colspan=\"2\" class=\"total-message\"> <span>含增值税</span> <span>{{taxExclusiveTax}}</span> </td> {{/if}} </tr> {{#showFinancingMessage 'total'}} {{#if content}} <tr> <td colspan=\"2\" class=\"total-message\">{{{content}}}</td> </tr> {{/if}} {{/showFinancingMessage}} {{#showDynamicFinancing}} {{#creditOffer}} <tr> <td colspan=\"2\" class=\"dynamicFinancing\">{{{loanOffer}}}</td> </tr> {{/creditOffer}} {{/showDynamicFinancing}} </table> </div> </div> </div>  ","name":"OfferSummary"}],"initialAmountDue":{"d":{"id":"intial-amount-due"},"v":[{"id":"intial-amount-due","template":"  <td class=\"label total-top\" data-autom=\"baginitialamountlabel\"> <info data-title=\"Initial Amount Due*\" data-uid=\"amountdue-help\" data-position=\"top left\"> {{#if installmentAmountDueHelp}} {{{installmentAmountDueHelp}}} {{/if}} </info> Initial Amount Due*</td> <td class=\"offer-total-value total-top\" data-autom=\"baginitialamountvalue\">{{installmentsAmountDue}}</td> "}]}},"actions":{"d":{"metricId":"4f717b23c055213d6ac147f3a64b282a","globalAccessoriesLink":"/cn/shop/accessories/all-accessories","evar1":"AOS: Bag | Bag | Shop iPhone Accessories | ","shopAccessoriesLinkDisplay":"选购 iPhone 配件","chatDisabled":false,"consumerStore":true,"automationData":"bagiphoneaccessorieslink","id":"cart-actions","shouldShowChat":true,"shopAccessoriesLink":"/cn/shop/iphone/iphone-accessories","apwEnabled":false},"b":{"saveCart":{"id":"cart-actions-saveCart","events":[{"on":"click","do":"a.saveCart","metric":"t.saveCart"}]},"fcs2":{"id":"cart-actions-fcs2","localKey":"fcs2"},"checkout":{"id":"cart-actions-checkout","events":[{"on":"click","do":[{"set":"d.fcsdata","to":{"get":"d.fcs1"}},{"set":"d.fcs1","to":""},{"set":"d.fcscounter","to":{"get":"d.fcs2"}},{"set":"d.fcs2","to":""},"^a.checkout"],"metric":"t.checkoutStandard"}]},"fcscounter":{"id":"cart-actions-fcscounter","key":"d.fcscounter","submit":true},"BagCount":{"id":"cart-actions-BagCount","key":"d.BagCount","events":[{"on":"load","do":[{"method":"updateBagCount","args":[2]}]}]},"fcs1":{"id":"cart-actions-fcs1","localKey":"fcs1"},"fcsdata":{"id":"cart-actions-fcsdata","key":"d.fcsdata","submit":true}},"a":{"saveCart":{"url":"/cn/shop/bagx?_a=saveCart&_m=shoppingCart.actions","module":"shoppingCart.actions"}},"t":{"saveCart":{"microEvents":[{"key":"prop37","value":"SaveBag","feature":"Bag"}],"macroEvents":"event12"},"checkoutStandard":{"microEvents":[{"key":"eVar39","value":"StandardCheckout","feature":"Bag"}]}},"v":[{"id":"cart-actions","template":"  <div class=\"cart-action-group pv14 clearfix\"> <div class=\"cart-actions-left\"> <ul class=\"clearfix cart-actions-left-inner\"> {{^disableCheckout}} <li> <a href=\"{{shopAccessoriesLink}}\" data-evar1=\"{{evar1}}\" data-s-object-id=\"{{metricId}}\" class=\"link\" data-autom=\"{{automationData}}\"> <span>{{shopAccessoriesLinkDisplay}}</span> </a> </li> <li class=\"pipe\"> <button class=\"link\" id=\"{{id}}-saveCart\" data-autom=\"bagsavebaglink\"> 保存购物袋 </button> </li> {{/disableCheckout}} <li {{^disableCheckout}}class=\"pipe\"{{/disableCheckout}}> <a href=\"/cn/shop/bag/saved_bags\" class=\"link\" data-autom=\"bagviewsavebagslink\"> <span>查看已保存的购物袋</span> </a> </li> <li class=\"pipe\"> <button class=\"cart-action-chat-now link cchat\"> 现在聊天 </button> </li> </ul> </div> <div class=\"cart-actions-right {{#apwEnabled}}cart-action-apnoten{{/apwEnabled}}\"> {{#if disableCheckout}} <button id=\"{{id}}-saveCart\" class=\"cart-action-checkout button button-transaction {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagsavebagbutton\"> 保存购物袋 </button> {{else}} <button id=\"{{id}}-checkout\" class=\"cart-action-checkout button button-transaction {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagcheckoutbutton\"> 结帐 <spinner></spinner> </button> {{/if}} </div> {{#apwEnabled}} <div class=\"cart-actions-right cart-action-apen\"> <button id=\"{{id}}-apenCart\" class=\"cart-action-apencheckout button merchandising {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagcheckoutbutton\"> 使用 Apple Pay 结账 <spinner></spinner> </button> <div class=\"cart-apen-otheroptions\"> <button id=\"{{id}}-checkout-otheroptions\" class=\"cart-action-checkout button {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagcheckoutbutton\" aria-describedby=\"apen-otheroptions-text\"> 请选择其他付款方式结账 <spinner></spinner> </button> <p id=\"apen-otheroptions-text\">Other payment options include Debit/Credit card, Barclaycard Visa, PayPal, Apple Store gift cards.</p> </div> </div> {{/apwEnabled}} </div>  "}]}},"abs":{"RecommendedItem":{"b":{"add":{"id":{"op":"ADD","args":[{"get":"d.id"},"-add"]},"events":[{"on":"click","do":"a.add","metric":"t.addToCart"}]},"view":{"id":{"op":"ADD","args":[{"get":"d.id"},"-view"]},"events":[{"on":"click","do":"a.view","metric":"t.viewProduct"}]},"recommended-img":{"id":{"op":"ADD","args":[{"get":"d.id"},"-recommended-img"]},"events":[{"on":"click","do":"a.recommended-img","metric":"t.viewProduct"}]}},"a":{"add":{"url":{"get":"d.addToCartOverlay"},"module":"abs.RecommendedItem"},"view":{"url":{"get":"d.productDetailsUrl"},"target":"_top","module":"abs.RecommendedItem"},"recommended-img":{"url":{"get":"d.productDetailsUrl"},"target":"_top","module":"abs.RecommendedItem"}},"t":{"addToCart":{"microEvents":[{"key":"eVar1","value":{"op":"ADD","args":["AddToBag"," | ",{"get":"d.partNumber"}]},"feature":"Recommended"}],"url":{"get":"d.addtoCartFeedbackUrl"}},"viewProduct":{"microEvents":[{"key":"eVar1","value":{"op":"ADD","args":["ViewProduct"," | ",{"get":"d.partNumber"}]},"feature":"Recommended"}],"url":{"get":"d.productViewFeedbackUrl"}}},"v":[{"id":{"get":"d.id"},"template":"  <li id=\"{{id}}\" class=\"ib gs grid-1of2 mbl item-{{@index}} {{#if description}}item-featured{{/if}}\"> <div class=\"gs grid-1of3 mtm {{#if description}}prl mrl{{/if}}\"> <div > <a href=\"javascript:void(0)\" id=\"{{id}}-recommended-img\" {{#basePartNumber}}data-evar11=\"{{.}}|recommended cart\"{{/basePartNumber}}> <img data-autom=\"bagRFYimage-{{id}}\" alt=\"{{title}}\" src=\"{{image.srcSet.src}}\" width=\"{{image.width}}\" height=\"{{image.height}}\" {{#if image.srcSet.scaleParams1}} data-scale-params-1=\"{{image.srcSet.scaleParams1}}\" {{/if}} {{#unless image.srcSet.scaleParams1}} {{#if image.srcSet.scaleParams2}} data-scale-params-2=\"{{image.srcSet.scaleParams2}}\" {{/if}} {{/unless}} > </a> </div> </div> <div class=\"gs {{#if description}} grid-1of2 pll {{else}} grid-2of3 {{/if}}\"> <h3 class=\"h3 heading strong mbs\"> <a href=\"javascript:void(0)\" id=\"{{id}}-view\" class=\" alt cdg recommended-item-title\" data-autom=\"bagRFYtitle-{{id}}\" {{#basePartNumber}}data-evar11=\"{{.}}|recommended cart\"{{/basePartNumber}}> {{title}} </a> </h3> {{#if description}} <div class=\"gs recommended-item-description tal mtm mbm\"> {{{description}}} </div> {{/if}} <div class=\"price fsm mvm\" data-autom=\"bagRFYprice-{{id}}\">{{price.current_price}}</div> {{#if price.previous_price}} <div class=\"fss clg strikethrough\">原价 {{price.previous_price}}</div> {{/if}} <a href=\"javascript:void(0)\" role=\"button\" data-ase-trigger=\"32 to preventDefault click\" class=\"button secondary\" id=\"{{id}}-add\" data-ase-overlay=\"recommendations-add-to-cart\" {{#basePartNumber}}data-evar11=\"{{.}}|recommended cart\"{{/basePartNumber}} data-autom=\"bagRFYaddbtn-{{id}}\"> 添加到购物袋 <span class=\"a11y\">({{title}})</span> </a> <p class=\"footnote\">{{insuranceText}}</p> </div> </li>  ","name":"RecommendedItem"}]},"BagBanner":{"b":{"bag-banner":{"id":{"op":"ADD","args":[{"get":"d.id"},"-bag-banner"]},"key":"d.bag-banner","events":[{"on":"load","delay":50,"do":[{"set":"d._visible","to":true}]}]}},"v":[{"id":{"get":"d.id"},"template":"{{#deliveryMessageBannerEnabled}} <div class=\"box--white box--is-rounded box--has-shadow ph10 pv10 mb8\">\n\t<div class=\"icon-shipping as-purchaseinfo-availabilityicons\" style=\"padding: 17px 0 17px 14px;\">\n\t\t<span>\n\t\t\t<img src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/d/el/delivery/message/delivery-message-banner?wid=19&amp;hei=21&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1504554657567\" alt=\"Shipping Information\" width=\"19\" height=\"21\" data-scale-params-2=\"wid=38&amp;hei=42&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1504554657567\" style=\"vertical-align: middle;padding-right: 7px;\" class=\"ir\" /> \n\t\t</span>\n\t\t<span style=\"display: inline-block;vertical-align: middle;max-width: 96%;font-family: 'Myriad Set Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size: 14px;line-height: 24px;\">\n\t\t\t免费送货，还可免费退货。\n\t\t</span>\n     </div>\n</div> {{/deliveryMessageBannerEnabled}}"}]},"CartItem":{"b":{"quantity":{"id":{"op":"ADD","args":[{"get":"d.id"},"-quantity"]},"key":"d.quantity","name":"quantity","type":"text","maxLen":3,"events":[{"on":"set","condition":{"op":"LTE","args":[{"val":"_"},999]},"do":"a.updateQuantity"},{"on":"load","do":[{"set":"b.quantity.p.focused","to":{"get":"d.wasUpdateQuantityInvoked"}}]}],"submit":true,"p":{"enabled":true,"valid":{"if":{"op":"AND","args":[{"op":"GT","args":[{"val":"_"},0]},{"op":"LTE","args":[{"val":"_"},999]},{"op":"!EQ","args":[{"val":"_"},""]},{"op":"MATCH","args":["^[^.]*$",{"val":"_"}]}]},"then":{"error":""},"else":{"error":"请输入一个介于 1 和 999 之间的有效数量。"}}}}},"v":[{"id":{"get":"d.id"},"template":"  <li id=\"{{id}}\" class=\"cart-item is-removable is-removable-height hrt {{#_deleting}}removing{{/_deleting}}\"> <div class=\"remove-mask {{#removing}}is-removing{{/removing}}\"> <span class=\"fwb fsl\">从购物袋中移除此产品</span> </div> {{#messages}} <div class=\"row mts oln\" id=\"{{id}}-messages\" tabindex=\"-1\"> <div> {{#infos}}<div class=\"info-message mbs\">{{.}}</div>{{/infos}} {{#errors}}<div class=\"error-message mbs\">{{.}}</div>{{/errors}} </div> </div> {{/messages}} <div class=\"cart-product\"> {{! > CartItem/Image !}} <div {{^if isBlockProductDetails}} data-relatedlink=\"{{productUrl}}\" {{/if}} class=\"cart-item-image mt15 mr10 tac inline ftl\" data-autom=\"bagitemimage-{{id}}\" > <img alt=\"{{alt}}\" src=\"{{src}}\" width=\"{{width}}\" height=\"{{height}}\" {{#if data-scale-params-1}} data-scale-params-1=\"{{data-scale-params-1}}\" {{/if}} {{#unless data-scale-params-1}} {{#if data-scale-params-2}} data-scale-params-2=\"{{data-scale-params-2}}\" {{/if}} {{/unless}} > </div> {{! > CartItem/ProductName !}} <div class =\"content product-info pv10\"> <div class=\"table oln pbs hrb-lg row\"> <div class=\"product-title\"> <h2 class=\"mbs content\"> <a id=\"{{id}}-name\" class=\"cart-item-name fwb fsml cdg prl\" {{#if isBlockProductDetails}}href=\"javascript:void(0);\"{{else}}href=\"{{productUrl}}\"{{/if}} data-relatedlink=\"{{productUrl}}\" data-evar1=\"{{productEvar1}}\" data-s-object-id=\"{{productMetricId}}\" data-autom=\"bagitemname-{{id}}\"> {{name}} </a> </h2> </div> <ul class=\"media price-quantity\"> {{#if _editing}} <li class=\"item first product-price\" data-autom=\"bagitemunitprice-{{id}}\"> <span class=\"a11y\"> 物品价格：</span>{{unitPrice}} </li> {{/if}} <li class=\"item quantity-select ph50\"> {{#if _editing}} <label for=\"{{id}}-quantity\" class=\"a11y\">Quantity ({{name}}) {{#if wasUpdateQuantityInvoked}} 此订单的总额已更新，以反映新增数量。 {{/if}}</label> <input class=\"integer\" type=\"number\" pattern=\"[0-9]*\" id=\"{{id}}-quantity\" min=\"0\" maxlength=\"3\" max=\"999\" data-autom=\"bagitemquantity-{{id}}\"> {{else}} {{#if showQuantity}}{{quantity}}{{/if}} {{/if}} </li> <li class=\"item quantity-price plm fwb\" data-autom=\"bagitemtotalprice-{{id}}\"> <span class=\"a11y\">合计价格：</span> {{totalPrice}} </li> </ul> </div> {{! > CartItem/Productshipping !}} <div class=\"shipping-product-admin section\"> <p class=\"product-admin h-group\"> {{#if canShareCartItem}} <button type=\"button\" class=\"ftr item pipe\" id=\"{{id}}-share\"> 共享 <span class=\"a11y\">({{name}})</span> </button> {{/if}} {{#if _editing}} <button type=\"button\" class=\"ftr item\" id=\"{{id}}-delete\" {{#disableRemove}}disabled{{/disableRemove}} data-autom=\"bagitemremovebutton-{{id}}\"> 删除 <span class=\"a11y\">从购物袋中({{name}})</span> </button> {{/if}} </p> <div class=\"part-number\"> 编号: <span>{{productId}}</span> </div> <ul class=\"product-shipping\" role=\"presentation\"> <li> <div id=\"{{id}}-delivery\"></div> </li> </ul> </div> {{#if _editing}} {{#editIPhoneUrl}} <p class=\"product-customize\"> <a class=\"first-link\" href=\"{{.}}\" data-evar1=\"{{iPhoneEvar1}}\" data-s-object-id=\"{{iPhoneMetricId}}\"> 编辑大小和颜色 </a> </p> {{/editIPhoneUrl}} {{/if}} {{#promos}} {{#list}} <div class=\"specials section clearfix\"> <div class=\"title text-alert fwb gs\"> {{#showPrefix}} {{#taxInclusive}}节省{{/taxInclusive}} {{^taxInclusive}}优惠{{/taxInclusive}} {{/showPrefix}} {{label}} </div> <div class=\"price text-alert\"> - <span class=\"fwb\"> {{amount}} </span> </div> </div> {{/list}} {{/promos}} <div id=\"{{id}}-macDetails\"></div> <div id=\"{{id}}-phoneDetails\"></div> <div class=\"engraving-gifting section clearfix\"> {{#engraving}} <div class=\"mbm\"> {{#url}} {{^lines.length}} <a href=\"{{url}}\" data-evar1=\"{{engravingEvar1}}\" data-s-object-id=\"{{engravingMetricId}}\" data-autom=\"bagitemaddengravinglink-{{id}}\"> 添加镌刻 <span class=\"a11y\">({{name}})</span> </a> {{/lines.length}} {{/url}} {{#lines.length}} <div> <h3 class=\"fwb dib\"> 镌刻 </h3> {{#if _editing}} {{#url}} <a href=\"{{url}}\" data-evar1=\"{{engravingEvar1}}\" data-s-object-id=\"{{engravingMetricId}}\" class=\"pipe fwn\" data-autom=\"bagitemeditengravinglink-{{id}}\"> 编辑 <span class=\"a11y\">({{name}})</span> </a> {{/url}} {{/if}} </div> <ul class=\"cmg mtxs\"> {{#lines}} <li class=\"engraving-line\">{{.}}</li> {{/lines}} </ul> {{/lines.length}} </div> {{/engraving}} <div id=\"{{id}}-gifting\"></div> </div> {{#financeOfferPlanDetails}} <div class=\"hrt mtm ptl section\"> <div class=\"tradeIn-Section\"> <h3 class=\"tradein-Header fwb mbm\">{{headerLabel}}</h3> {{#row}} <div class=\"label\">{{label}}</div> <div class=\"value\">{{value}}</div> {{/row}} </div> </div> {{/financeOfferPlanDetails}} {{#tradeinDetails}} <div class=\"{{#headerLabel}}hrt mtm ptl {{/headerLabel}}section{{^headerLabel}} no-header{{/headerLabel}}\"> <div class=\"tradeIn-Section\"> {{#headerLabel}}<h3 class=\"tradein-Header fwb mbm\">{{headerLabel}}</h3>{{/headerLabel}} {{#row}} <div class=\"label\">{{label}}</div> <div class=\"value\">{{value}}</div> {{/row}} </div> {{#upgradeProgramBalance}} <div class=\"hrt mtl ptm\"> <span>{{.}}</span> </div> {{/upgradeProgramBalance}} </div> {{/tradeinDetails}} <div id=\"{{id}}-egc\"></div> {{#showSingleHeader}} {{^./promos}} <p class=\"mb5 fwb fsm\"> 服务和支持 </p> {{/promos}} {{/showSingleHeader}} {{#each _c}} {{#if isChildItem}} {{> CartChildItem }} {{/if}} {{/each}} {{#netLevy}} <p class=\"fsm mbs\"> {{.}} </p> {{/netLevy}} {{#grossLevyList}} <p class=\"levy fsm mbm\"> {{levy}} </p> {{/grossLevyList}} {{#recycleFee}} <div class=\"row mvl\"> <div class=\"fwb fsm\"> <div class=\"gs\"> 免费回收 </div> <div class=\"r-align\"> {{.}} </div> </div> </div> {{/recycleFee}} </div> </div> </li>  ","name":"CartItem"}]},"ConfirmDeleteOverlay":{"b":{"remove-button":{"id":{"op":"ADD","args":[{"get":"d.id"},"-remove-button"]},"events":[{"on":"click","do":["^a.delete",{"set":"b.overlay.p.visible","to":false}]}]},"overlay":{"id":{"op":"ADD","args":[{"get":"d.id"},"-overlay"]},"p":{"visible":false}},"cancel-button":{"id":{"op":"ADD","args":[{"get":"d.id"},"-cancel-button"]},"events":[{"on":"click","do":[{"set":"b.overlay.p.visible","to":false},{"set":"^d.quantity","to":{"get":"^d.originalQty"}}]}]}},"v":[{"id":{"get":"d.id"},"template":"<overlay data-uid=\"confirm-delete-overlay\" data-shown=\"{overlay_visible}\"> <div class=\"row\"> <div class=\"gs grid-12of12 mbs\"> 是否确实要删除此商品？ </div> </div> <div class=\"row\"> <div class=\"gs grid-6of12\"> <button class=\"button button-small\" id=\"{{id}}-cancel-button\"> 取消 </button> </div> <div class=\"gs grid-6of12\"> <button class=\"button button-small button-action\" id=\"{{id}}-remove-button\"> 删除 </button> </div> </div> </overlay> ","appendTo":"body-main"}]},"ItemDelivery":{"v":[{"id":{"get":"d.id"},"template":"<div class=\"ship mbm\"> {{#sthEnabled}} {{#ships}} <div class=\"availShip\"> {{#showShipLabel}} Ship: {{/showShipLabel}} {{#resolvedShipLabel}} {{.}} {{/resolvedShipLabel}} {{#each shipMethodQuote}} {{date}} {{#postfix}} - {{.}} {{/postfix}} {{^isLast}} | {{/isLast}} {{/each}} {{#shipPromo}} <div class=\"text-alert pipe inline\"> {{.}} </div> {{/shipPromo}} </div> {{/ships}} {{#delivers}} <div class=\"ship {{#delivers}}mts{{/delivers}}\"> {{#showDeliveryLabel}}交货:{{/showDeliveryLabel}} <span class=\"cmg\">{{quote}}</span> {{#shipMethod}}通过 {{{quote}}}{{/shipMethod}} </div> {{/delivers}} {{#pickup}} <div class=\"ship {{#pickup}}mts{{/pickup}}\"> {{#showPickupLabel}}Pick up:{{/showPickupLabel}} 提货： <span class=\"cmg\">{{{quote}}}</span> </div> {{/pickup}} {{/sthEnabled}} {{^sthEnabled}} 发货： <span class=\"cmg\">仅供到店取货。</span> {{/sthEnabled}} </div> "}]}}}
		 */
	},
	updateQuantity: {
		skipAble: true,
		url: (context, lastRes) => `https://www.apple.com/cn/shop/bagx?_a=updateQuantity&_m=shoppingCart.items.${lastRes.itemName}`,
		method: "post",
		headers: (context, lastRes) => ({
			"x-aos-stk": context.session.quantity["x-aos-stk"]
		}),
		params: (context, lastRes) => ({
			[`shoppingCart.items.${context.session.quantity.itemName}.quantity`]: context.iphone.quantity
		}),
		parser: JSON.parse
		/**
		 * {"head":{"status":200,"data":{}},"body":{"meta":{"v":"1.0","l":["/shoppingCart.banner","/shoppingCart.items","/shoppingCart.cartMessages","/shoppingCart.footnotes","/shoppingCart.summary","/shoppingCart.actions"],"h":{"x-aos-stk":"6e5d32c3"}},"shoppingCart":{"footnotes":{"d":{"id":"amount-due-text","exitWithBuyUp":false},"v":[{"id":"amount-due-text","template":"{{#if exitWithBuyUp}}*The Remaining iPhone Upgrade Program Balance is based on information provided by Citizens One regarding payments made to date. It will be re-calculated when your iPhone ships or becomes available for pickup.{{/if}}"}]},"actions":{"d":{"metricId":"4f717b23c055213d6ac147f3a64b282a","globalAccessoriesLink":"/cn/shop/accessories/all-accessories","evar1":"AOS: Bag | Bag | Shop iPhone Accessories | ","shopAccessoriesLinkDisplay":"选购 iPhone 配件","chatDisabled":false,"consumerStore":true,"automationData":"bagiphoneaccessorieslink","id":"cart-actions","shouldShowChat":true,"shopAccessoriesLink":"/cn/shop/iphone/iphone-accessories","apwEnabled":false},"b":{"saveCart":{"id":"cart-actions-saveCart","events":[{"on":"click","do":"a.saveCart","metric":"t.saveCart"}]},"fcs2":{"id":"cart-actions-fcs2","localKey":"fcs2"},"checkout":{"id":"cart-actions-checkout","events":[{"on":"click","do":[{"set":"d.fcsdata","to":{"get":"d.fcs1"}},{"set":"d.fcs1","to":""},{"set":"d.fcscounter","to":{"get":"d.fcs2"}},{"set":"d.fcs2","to":""},"^a.checkout"],"metric":"t.checkoutStandard"}]},"fcscounter":{"id":"cart-actions-fcscounter","key":"d.fcscounter","submit":true},"BagCount":{"id":"cart-actions-BagCount","key":"d.BagCount","events":[{"on":"load","do":[{"method":"updateBagCount","args":[2]}]}]},"fcs1":{"id":"cart-actions-fcs1","localKey":"fcs1"},"fcsdata":{"id":"cart-actions-fcsdata","key":"d.fcsdata","submit":true}},"a":{"saveCart":{"url":"/cn/shop/bagx?_a=saveCart&_m=shoppingCart.actions","module":"shoppingCart.actions"}},"t":{"saveCart":{"microEvents":[{"key":"prop37","value":"SaveBag","feature":"Bag"}],"macroEvents":"event12"},"checkoutStandard":{"microEvents":[{"key":"eVar39","value":"StandardCheckout","feature":"Bag"}]}},"v":[{"id":"cart-actions","template":"  <div class=\"cart-action-group pv14 clearfix\"> <div class=\"cart-actions-left\"> <ul class=\"clearfix cart-actions-left-inner\"> {{^disableCheckout}} <li> <a href=\"{{shopAccessoriesLink}}\" data-evar1=\"{{evar1}}\" data-s-object-id=\"{{metricId}}\" class=\"link\" data-autom=\"{{automationData}}\"> <span>{{shopAccessoriesLinkDisplay}}</span> </a> </li> <li class=\"pipe\"> <button class=\"link\" id=\"{{id}}-saveCart\" data-autom=\"bagsavebaglink\"> 保存购物袋 </button> </li> {{/disableCheckout}} <li {{^disableCheckout}}class=\"pipe\"{{/disableCheckout}}> <a href=\"/cn/shop/bag/saved_bags\" class=\"link\" data-autom=\"bagviewsavebagslink\"> <span>查看已保存的购物袋</span> </a> </li> <li class=\"pipe\"> <button class=\"cart-action-chat-now link cchat\"> 现在聊天 </button> </li> </ul> </div> <div class=\"cart-actions-right {{#apwEnabled}}cart-action-apnoten{{/apwEnabled}}\"> {{#if disableCheckout}} <button id=\"{{id}}-saveCart\" class=\"cart-action-checkout button button-transaction {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagsavebagbutton\"> 保存购物袋 </button> {{else}} <button id=\"{{id}}-checkout\" class=\"cart-action-checkout button button-transaction {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagcheckoutbutton\"> 结帐 <spinner></spinner> </button> {{/if}} </div> {{#apwEnabled}} <div class=\"cart-actions-right cart-action-apen\"> <button id=\"{{id}}-apenCart\" class=\"cart-action-apencheckout button merchandising {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagcheckoutbutton\"> 使用 Apple Pay 结账 <spinner></spinner> </button> <div class=\"cart-apen-otheroptions\"> <button id=\"{{id}}-checkout-otheroptions\" class=\"cart-action-checkout button {{#isLoading}}busy{{/isLoading}}\" data-autom=\"bagcheckoutbutton\" aria-describedby=\"apen-otheroptions-text\"> 请选择其他付款方式结账 <spinner></spinner> </button> <p id=\"apen-otheroptions-text\">Other payment options include Debit/Credit card, Barclaycard Visa, PayPal, Apple Store gift cards.</p> </div> </div> {{/apwEnabled}} </div>  "}]},"items":{"d":{"id":"cart-items","disableRemove":false,"_editing":true},"p":{"editing":true},"c":["item-7a13c154-1d35-4bc0-a865-9b68e068fac2"],"v":[{"id":"cart-items","template":"<ul class=\"inset-row\" id=\"{{id}}\"> {{#each _c}} {{>CartItem}} {{/each}} </ul> ","name":"CartItems"}],"item-7a13c154-1d35-4bc0-a865-9b68e068fac2":{"f":{"abstract":"/abs.CartItem"},"d":{"name":"iPhone 8 Plus 256GB 金色","productEvar1":"AOS: Bag | Bag |  | MQ8J2CH/A","quantity":2,"productUrl":"/cn/shop/product/MQ8J2CH/A/5.5-%E8%8B%B1%E5%AF%B8%E5%B1%8F%E5%B9%95-256gb-%E9%87%91%E8%89%B2","showSingleHeader":false,"wasUpdateQuantityInvoked":true,"height":78,"data-scale-params-1":"wid=110&hei=78&fmt=jpeg&qlt=95&op_sharpen=0&resMode=bicub&op_usm=0.5,1.5,0,0&iccEmbed=0&layer=comp&.v=1504041014365","canShareCartItem":false,"totalPrice":"RMB 15,976","id":"cart-items-item-7a13c154-1d35-4bc0-a865-9b68e068fac2","alt":"","isBlockProductDetails":false,"src":"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&hei=156&fmt=jpeg&qlt=80&op_sharpen=0&resMode=bicub&op_usm=0.5,1.5,0,0&iccEmbed=0&layer=comp&.v=1504041014365","productId":"MQ8J2CH/A","unitPrice":"RMB 7,988","productMetricId":"198b5fe6de8f6f6d25e07a89f1ed3fb9","originalQty":2,"width":110,"showQuantity":true},"b":{"delete":{"id":"cart-items-item-7a13c154-1d35-4bc0-a865-9b68e068fac2-delete","events":[{"on":"click","do":["a.delete",{"set":"d.removing","to":true},{"set":"^d.disableRemove","to":true}],"metric":"t.removeItem"}]}},"a":{"delete":{"url":"/cn/shop/bagx?_a=delete&_m=shoppingCart.items.item-7a13c154-1d35-4bc0-a865-9b68e068fac2","module":"shoppingCart.items.item-7a13c154-1d35-4bc0-a865-9b68e068fac2"},"updateQuantity":{"url":"/cn/shop/bagx?_a=updateQuantity&_m=shoppingCart.items.item-7a13c154-1d35-4bc0-a865-9b68e068fac2","submit":true,"module":"shoppingCart.items.item-7a13c154-1d35-4bc0-a865-9b68e068fac2"}},"t":{"removeItem":{"microEvents":[{"key":"prop37","value":"RemoveItem","feature":"Bag"}],"macroEvents":"scRemove","products":"iphone;MQ8J2;2;15976.00;event101 = 2 | event102 = 15976.00"}},"c":["confirmDeleteOverlay","delivery"],"confirmDeleteOverlay":{"f":{"abstract":"/abs.ConfirmDeleteOverlay"},"d":{"id":"cart-items-item-7a13c154-1d35-4bc0-a865-9b68e068fac2-confirmDeleteOverlay"}},"delivery":{"f":{"abstract":"/abs.ItemDelivery"},"d":{"id":"cart-items-item-7a13c154-1d35-4bc0-a865-9b68e068fac2-delivery","sthEnabled":true,"ships":{"showShipLabel":false,"shipMethodQuote":[{"date":"2017/10/28 - 2017/11/01","postfix":"免费","isLast":true}],"resolvedShipLabel":"今日订购，送达日期为："}}}}},"banner":{"f":{"abstract":"/abs.BagBanner"},"d":{"id":"bag-banner","_visible":false,"deliveryMessageBannerEnabled":true,"deliveryMessage":"免费送货，还可免费退货。"}},"summary":{"d":{"showTaxInclusivePrices":true,"financingMessage":"<span class=\"installments\">   <br />   分期每月最低约 <span class=\"nowrap\">RMB 1,379</span>。   <br />   <a href=\"/cn/shop/browse/finance/installments\" name=\"browse\" class=\"more\" target=\"_blank\">更多信息</a>    </span>","total":"RMB 15,976","id":"cart-summary","totalNoShip":"RMB 15,975","showBuacMessage":false,"showInstallmentMessage":false,"shipping":{"cost":"RMB 0","free":true,"enabled":true}},"c":["initialAmountDue"],"v":[{"id":"cart-summary","template":"  <div id=\"{{id}}\" class=\"inset-row clearfix\"> <div class=\"summary-container hrt clearfix\"> <ul class=\"gs cart-message\" role=\"presentation\"> <li><ul id=\"{{id}}-deliveryDatesOverlay\"><li></li></ul></li> <li></li> <li></li> {{#showInstallmentMessage}} <li>Installments are only available on single item purchases.</li> {{/showInstallmentMessage}} {{#showBuacMessage}} <li class=\"buac\"> <span class=\"buac-help-message-img\"><img src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/b/ua/buac/asterisk/buac-asterisk?wid=11&amp;hei=13&amp;fmt=png-alpha&amp;qlt=95&amp;.v=mnNjz2\" alt=\"“transaction.cart.asterisk”/\" width=\"11\" height=\"13\" class=\"ir\" /> </span>\n&nbsp;<span class=\"buac-help-message-text\"> Shipping and pickup options can be selected in Checkout.</span> </li> {{/showBuacMessage}} <li {{#showBuacMessage}}class=\"hidden\"{{/showBuacMessage}}> {{#showFinancingMessage 'general'}}{{#if content}}{{{content}}}{{/content}}{{/showFinancingMessage}} </li> {{#financeCalculatorUrl}} <li><a href=\"{{financeCalculatorUrl}}\" id=\"estimate-your-monthly-amount\" class=\"finance-calculator-link\" rel=\"nofollow\" role=\"button\">{{financeCalculatorText}} </a></li> {{/financeCalculatorUrl}} </ul> <div class=\"offer-summary cmg\"> <table class=\"r-align\"> <caption><span class=\"a11y\">总费用明细</span></caption> <tr {{#unless subtotal}}class=\"hidden\"{{/unless}}> {{#if subtotal}} <th class=\"label\" data-autom=\"bagsubtotallabel\">购物袋小计</th> <td data-autom=\"bagsubtotalvalue\">{{subtotal}}</td> {{/if}} </tr> <tr {{#unless installmentTotal}}class=\"hidden\"{{/unless}}> {{#if installmentTotal}} <th class=\"label\" data-autom=\"baginstallmenttotallabel\">Total Amount</th> <td data-autom=\"baginstallmenttotalvalue\">{{installmentTotal}}</td> {{/if}} </tr> <tr {{#unless installmentTotalFinanced}}class=\"hidden\"{{/unless}}> {{#if installmentTotalFinanced}} <th class=\"label\" data-autom=\"bagfinancedlabel\">Total Financed Via Citizens One</th> <td data-autom=\"bagfinancedvalue\">{{installmentTotalFinanced}}</td> {{/if}} </tr> <tr {{#unless shipping}}class=\"hidden\"{{/unless}}> {{#shipping}} <td class=\"label\" data-autom=\"bagshippinglabel\"> {{#addForFreeShipping}} <span class=\"label add-shipping text-alert\">{{.}}</span> {{/addForFreeShipping}} {{#free}} <span class=\"label free-shipping\">免费送货</span>{{/free}} {{^free}} <span class=\"label\">送货</span>{{/free}} </td> <td data-autom=\"bagshippingvalue\" {{#free}}class=\"free-shipping\"{{/free}}>{{cost}}</td> {{/shipping}} </tr> <tr class=\"text-alert {{#unless savings}}hidden{{/unless}}\"> {{#savings}} <td class=\"label\"> 优惠 </td> <td>{{savings}}</td> {{/savings}} </tr> <tr id=\"tax-calculator\" > {{^taxCalculatorEnabled}} {{#tax}} <td class=\"label\">GST</td> <td>{{.}}</td> {{/tax}} {{/taxCalculatorEnabled}} </tr> <tr class=\"offer-upgrade cmg {{#unless upgrade}}hidden{{/unless}}\"> {{#upgrade}} <th class=\"label\">{{upgradePaymentLabel}}</th> <td>{{upgradeProgramBalance}}</td> {{/upgrade}} </tr> <tr {{#unless installmentsremainingpayments}}class=\"hidden\"{{/unless}}> {{#if installmentsremainingpayments}} <th class=\"label\" data-autom=\"baginstallmentremaininglabel\">First Monthly Installment</th> <td data-autom=\"baginstallmentremainingvalue\">{{installmentsremainingpayments}}</td> {{/if}} </tr> {{^totalDisable}} <tr class=\"offer-total fsl fweb\"> <td class=\"label total-top\" data-autom=\"bagtotallabel\">总计</td> <td class=\"offer-total-value total-top\" data-autom=\"bagtotalvalue\">{{total}}</td> </tr> {{/totalDisable}} {{#if installmentsAmountDue}} <tr id=\"intial-amount-due\" class=\"offer-total fsl fweb\"></tr> {{/if}} <tr class=\"text-alert {{#unless totalSavings}}hidden{{/unless}}\"> {{#if totalSavings}} <td class=\"label\">优惠总计</td> <td>{{totalSavings}}</td> {{/if}} </tr> <tr class=\"text-alert {{#unless totalSavingsInclusiveTax}}hidden{{/unless}}\"> {{#if totalSavingsInclusiveTax}} <td class=\"label\">优惠总计</td> <td>{{totalSavingsInclusiveTax}}</td> {{/if}} </tr> <tr {{#unless taxExclusiveTax}}class=\"hidden\"{{/unless}}> {{#if taxExclusiveTax}} <td colspan=\"2\" class=\"total-message\"> <span>含增值税</span> <span>{{taxExclusiveTax}}</span> </td> {{/if}} </tr> {{#showFinancingMessage 'total'}} {{#if content}} <tr> <td colspan=\"2\" class=\"total-message\">{{{content}}}</td> </tr> {{/if}} {{/showFinancingMessage}} {{#showDynamicFinancing}} {{#creditOffer}} <tr> <td colspan=\"2\" class=\"dynamicFinancing\">{{{loanOffer}}}</td> </tr> {{/creditOffer}} {{/showDynamicFinancing}} </table> </div> </div> </div>  ","name":"OfferSummary"}],"initialAmountDue":{"d":{"id":"intial-amount-due"},"v":[{"id":"intial-amount-due","template":"  <td class=\"label total-top\" data-autom=\"baginitialamountlabel\"> <info data-title=\"Initial Amount Due*\" data-uid=\"amountdue-help\" data-position=\"top left\"> {{#if installmentAmountDueHelp}} {{{installmentAmountDueHelp}}} {{/if}} </info> Initial Amount Due*</td> <td class=\"offer-total-value total-top\" data-autom=\"baginitialamountvalue\">{{installmentsAmountDue}}</td> "}]}},"cartMessages":{"d":{"id":"cart-level-messages"},"v":[{"id":"cart-level-messages","template":"{{#messages}} <div class=\"  cart-level-messages \"> <div class=\"row\"> <div > {{#infos}} <div class=\"info-message mbs\"> <p>{{.}}</p> </div> {{/infos}} {{#errors}} <div class=\"error-message mbs\"> <p>{{.}}</p> </div> {{/errors}} </div> </div> </div> {{/messages}} <overlay data-uid=\"ack-messages\" data-shown=\"{ackOverlay_visible}\" data-aria-labelledby=\"{{id}}-heading\"> <div class=\"\"> <div class=\"  pam fs18 \"> <h2 id=\"{{id}}-heading\"> 请注意以下内容... </h2> </div> <div class=\" pal tac fs12 bgc-ffffff radius-bl5 radius-br5 \"> {{#ackMessages}} {{{.}}} {{/ackMessages}} <button id=\"{{id}}-ack\" class=\" mtl  button button-small button-action button-secondary\"> 继续 </button> </div> </div> </overlay> "}]}},"abs":{"BagBanner":{"b":{"bag-banner":{"id":{"op":"ADD","args":[{"get":"d.id"},"-bag-banner"]},"key":"d.bag-banner","events":[{"on":"load","delay":50,"do":[{"set":"d._visible","to":true}]}]}},"v":[{"id":{"get":"d.id"},"template":"{{#deliveryMessageBannerEnabled}} <div class=\"box--white box--is-rounded box--has-shadow ph10 pv10 mb8\">\n\t<div class=\"icon-shipping as-purchaseinfo-availabilityicons\" style=\"padding: 17px 0 17px 14px;\">\n\t\t<span>\n\t\t\t<img src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/d/el/delivery/message/delivery-message-banner?wid=19&amp;hei=21&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1504554657567\" alt=\"Shipping Information\" width=\"19\" height=\"21\" data-scale-params-2=\"wid=38&amp;hei=42&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1504554657567\" style=\"vertical-align: middle;padding-right: 7px;\" class=\"ir\" /> \n\t\t</span>\n\t\t<span style=\"display: inline-block;vertical-align: middle;max-width: 96%;font-family: 'Myriad Set Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size: 14px;line-height: 24px;\">\n\t\t\t免费送货，还可免费退货。\n\t\t</span>\n     </div>\n</div> {{/deliveryMessageBannerEnabled}}"}]},"CartItem":{"b":{"quantity":{"id":{"op":"ADD","args":[{"get":"d.id"},"-quantity"]},"key":"d.quantity","name":"quantity","type":"text","maxLen":3,"events":[{"on":"set","condition":{"op":"LTE","args":[{"val":"_"},999]},"do":"a.updateQuantity"},{"on":"load","do":[{"set":"b.quantity.p.focused","to":{"get":"d.wasUpdateQuantityInvoked"}}]}],"submit":true,"p":{"enabled":true,"valid":{"if":{"op":"AND","args":[{"op":"GT","args":[{"val":"_"},0]},{"op":"LTE","args":[{"val":"_"},999]},{"op":"!EQ","args":[{"val":"_"},""]},{"op":"MATCH","args":["^[^.]*$",{"val":"_"}]}]},"then":{"error":""},"else":{"error":"请输入一个介于 1 和 999 之间的有效数量。"}}}}},"v":[{"id":{"get":"d.id"},"template":"  <li id=\"{{id}}\" class=\"cart-item is-removable is-removable-height hrt {{#_deleting}}removing{{/_deleting}}\"> <div class=\"remove-mask {{#removing}}is-removing{{/removing}}\"> <span class=\"fwb fsl\">从购物袋中移除此产品</span> </div> {{#messages}} <div class=\"row mts oln\" id=\"{{id}}-messages\" tabindex=\"-1\"> <div> {{#infos}}<div class=\"info-message mbs\">{{.}}</div>{{/infos}} {{#errors}}<div class=\"error-message mbs\">{{.}}</div>{{/errors}} </div> </div> {{/messages}} <div class=\"cart-product\"> {{! > CartItem/Image !}} <div {{^if isBlockProductDetails}} data-relatedlink=\"{{productUrl}}\" {{/if}} class=\"cart-item-image mt15 mr10 tac inline ftl\" data-autom=\"bagitemimage-{{id}}\" > <img alt=\"{{alt}}\" src=\"{{src}}\" width=\"{{width}}\" height=\"{{height}}\" {{#if data-scale-params-1}} data-scale-params-1=\"{{data-scale-params-1}}\" {{/if}} {{#unless data-scale-params-1}} {{#if data-scale-params-2}} data-scale-params-2=\"{{data-scale-params-2}}\" {{/if}} {{/unless}} > </div> {{! > CartItem/ProductName !}} <div class =\"content product-info pv10\"> <div class=\"table oln pbs hrb-lg row\"> <div class=\"product-title\"> <h2 class=\"mbs content\"> <a id=\"{{id}}-name\" class=\"cart-item-name fwb fsml cdg prl\" {{#if isBlockProductDetails}}href=\"javascript:void(0);\"{{else}}href=\"{{productUrl}}\"{{/if}} data-relatedlink=\"{{productUrl}}\" data-evar1=\"{{productEvar1}}\" data-s-object-id=\"{{productMetricId}}\" data-autom=\"bagitemname-{{id}}\"> {{name}} </a> </h2> </div> <ul class=\"media price-quantity\"> {{#if _editing}} <li class=\"item first product-price\" data-autom=\"bagitemunitprice-{{id}}\"> <span class=\"a11y\"> 物品价格：</span>{{unitPrice}} </li> {{/if}} <li class=\"item quantity-select ph50\"> {{#if _editing}} <label for=\"{{id}}-quantity\" class=\"a11y\">Quantity ({{name}}) {{#if wasUpdateQuantityInvoked}} 此订单的总额已更新，以反映新增数量。 {{/if}}</label> <input class=\"integer\" type=\"number\" pattern=\"[0-9]*\" id=\"{{id}}-quantity\" min=\"0\" maxlength=\"3\" max=\"999\" data-autom=\"bagitemquantity-{{id}}\"> {{else}} {{#if showQuantity}}{{quantity}}{{/if}} {{/if}} </li> <li class=\"item quantity-price plm fwb\" data-autom=\"bagitemtotalprice-{{id}}\"> <span class=\"a11y\">合计价格：</span> {{totalPrice}} </li> </ul> </div> {{! > CartItem/Productshipping !}} <div class=\"shipping-product-admin section\"> <p class=\"product-admin h-group\"> {{#if canShareCartItem}} <button type=\"button\" class=\"ftr item pipe\" id=\"{{id}}-share\"> 共享 <span class=\"a11y\">({{name}})</span> </button> {{/if}} {{#if _editing}} <button type=\"button\" class=\"ftr item\" id=\"{{id}}-delete\" {{#disableRemove}}disabled{{/disableRemove}} data-autom=\"bagitemremovebutton-{{id}}\"> 删除 <span class=\"a11y\">从购物袋中({{name}})</span> </button> {{/if}} </p> <div class=\"part-number\"> 编号: <span>{{productId}}</span> </div> <ul class=\"product-shipping\" role=\"presentation\"> <li> <div id=\"{{id}}-delivery\"></div> </li> </ul> </div> {{#if _editing}} {{#editIPhoneUrl}} <p class=\"product-customize\"> <a class=\"first-link\" href=\"{{.}}\" data-evar1=\"{{iPhoneEvar1}}\" data-s-object-id=\"{{iPhoneMetricId}}\"> 编辑大小和颜色 </a> </p> {{/editIPhoneUrl}} {{/if}} {{#promos}} {{#list}} <div class=\"specials section clearfix\"> <div class=\"title text-alert fwb gs\"> {{#showPrefix}} {{#taxInclusive}}节省{{/taxInclusive}} {{^taxInclusive}}优惠{{/taxInclusive}} {{/showPrefix}} {{label}} </div> <div class=\"price text-alert\"> - <span class=\"fwb\"> {{amount}} </span> </div> </div> {{/list}} {{/promos}} <div id=\"{{id}}-macDetails\"></div> <div id=\"{{id}}-phoneDetails\"></div> <div class=\"engraving-gifting section clearfix\"> {{#engraving}} <div class=\"mbm\"> {{#url}} {{^lines.length}} <a href=\"{{url}}\" data-evar1=\"{{engravingEvar1}}\" data-s-object-id=\"{{engravingMetricId}}\" data-autom=\"bagitemaddengravinglink-{{id}}\"> 添加镌刻 <span class=\"a11y\">({{name}})</span> </a> {{/lines.length}} {{/url}} {{#lines.length}} <div> <h3 class=\"fwb dib\"> 镌刻 </h3> {{#if _editing}} {{#url}} <a href=\"{{url}}\" data-evar1=\"{{engravingEvar1}}\" data-s-object-id=\"{{engravingMetricId}}\" class=\"pipe fwn\" data-autom=\"bagitemeditengravinglink-{{id}}\"> 编辑 <span class=\"a11y\">({{name}})</span> </a> {{/url}} {{/if}} </div> <ul class=\"cmg mtxs\"> {{#lines}} <li class=\"engraving-line\">{{.}}</li> {{/lines}} </ul> {{/lines.length}} </div> {{/engraving}} <div id=\"{{id}}-gifting\"></div> </div> {{#financeOfferPlanDetails}} <div class=\"hrt mtm ptl section\"> <div class=\"tradeIn-Section\"> <h3 class=\"tradein-Header fwb mbm\">{{headerLabel}}</h3> {{#row}} <div class=\"label\">{{label}}</div> <div class=\"value\">{{value}}</div> {{/row}} </div> </div> {{/financeOfferPlanDetails}} {{#tradeinDetails}} <div class=\"{{#headerLabel}}hrt mtm ptl {{/headerLabel}}section{{^headerLabel}} no-header{{/headerLabel}}\"> <div class=\"tradeIn-Section\"> {{#headerLabel}}<h3 class=\"tradein-Header fwb mbm\">{{headerLabel}}</h3>{{/headerLabel}} {{#row}} <div class=\"label\">{{label}}</div> <div class=\"value\">{{value}}</div> {{/row}} </div> {{#upgradeProgramBalance}} <div class=\"hrt mtl ptm\"> <span>{{.}}</span> </div> {{/upgradeProgramBalance}} </div> {{/tradeinDetails}} <div id=\"{{id}}-egc\"></div> {{#showSingleHeader}} {{^./promos}} <p class=\"mb5 fwb fsm\"> 服务和支持 </p> {{/promos}} {{/showSingleHeader}} {{#each _c}} {{#if isChildItem}} {{> CartChildItem }} {{/if}} {{/each}} {{#netLevy}} <p class=\"fsm mbs\"> {{.}} </p> {{/netLevy}} {{#grossLevyList}} <p class=\"levy fsm mbm\"> {{levy}} </p> {{/grossLevyList}} {{#recycleFee}} <div class=\"row mvl\"> <div class=\"fwb fsm\"> <div class=\"gs\"> 免费回收 </div> <div class=\"r-align\"> {{.}} </div> </div> </div> {{/recycleFee}} </div> </div> </li>  ","name":"CartItem"}]},"ConfirmDeleteOverlay":{"b":{"remove-button":{"id":{"op":"ADD","args":[{"get":"d.id"},"-remove-button"]},"events":[{"on":"click","do":["^a.delete",{"set":"b.overlay.p.visible","to":false}]}]},"overlay":{"id":{"op":"ADD","args":[{"get":"d.id"},"-overlay"]},"p":{"visible":false}},"cancel-button":{"id":{"op":"ADD","args":[{"get":"d.id"},"-cancel-button"]},"events":[{"on":"click","do":[{"set":"b.overlay.p.visible","to":false},{"set":"^d.quantity","to":{"get":"^d.originalQty"}}]}]}},"v":[{"id":{"get":"d.id"},"template":"<overlay data-uid=\"confirm-delete-overlay\" data-shown=\"{overlay_visible}\"> <div class=\"row\"> <div class=\"gs grid-12of12 mbs\"> 是否确实要删除此商品？ </div> </div> <div class=\"row\"> <div class=\"gs grid-6of12\"> <button class=\"button button-small\" id=\"{{id}}-cancel-button\"> 取消 </button> </div> <div class=\"gs grid-6of12\"> <button class=\"button button-small button-action\" id=\"{{id}}-remove-button\"> 删除 </button> </div> </div> </overlay> ","appendTo":"body-main"}]},"ItemDelivery":{"v":[{"id":{"get":"d.id"},"template":"<div class=\"ship mbm\"> {{#sthEnabled}} {{#ships}} <div class=\"availShip\"> {{#showShipLabel}} Ship: {{/showShipLabel}} {{#resolvedShipLabel}} {{.}} {{/resolvedShipLabel}} {{#each shipMethodQuote}} {{date}} {{#postfix}} - {{.}} {{/postfix}} {{^isLast}} | {{/isLast}} {{/each}} {{#shipPromo}} <div class=\"text-alert pipe inline\"> {{.}} </div> {{/shipPromo}} </div> {{/ships}} {{#delivers}} <div class=\"ship {{#delivers}}mts{{/delivers}}\"> {{#showDeliveryLabel}}交货:{{/showDeliveryLabel}} <span class=\"cmg\">{{quote}}</span> {{#shipMethod}}通过 {{{quote}}}{{/shipMethod}} </div> {{/delivers}} {{#pickup}} <div class=\"ship {{#pickup}}mts{{/pickup}}\"> {{#showPickupLabel}}Pick up:{{/showPickupLabel}} 提货： <span class=\"cmg\">{{{quote}}}</span> </div> {{/pickup}} {{/sthEnabled}} {{^sthEnabled}} 发货： <span class=\"cmg\">仅供到店取货。</span> {{/sthEnabled}} </div> "}]}}}}
		 */
	},
	shoppingCart: {
		url: "https://www.apple.com/cn/shop/bagx/checkout_now?_a=checkout&_m=shoppingCart",
		method: "post",
		headers: (context, lastRes) => ({
			"x-aos-stk": context.session.quantity["x-aos-stk"]
		}),
		params: (context, lastRes) => {
			return {
				[`shoppingCart.items.${context.session.quantity.itemName}.quantity`]: context.iphone.quantity,
				"shoppingCart.actions.fcscounter":"",
				"shoppingCart.actions.fcsdata":""
			}
		},
		parser: rawRes => JSON.parse(rawRes)

		/**
		 *	the response is like below, parse the next step's url
		 * {"body":{},"head":{"status":302,"data":{"url":"https://secure1.store.apple.com/cn/shop/sign_in?c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&o=O01ORlEy&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF&up=t"}}}
		 *
		 */
	},
	gotoSign: {
		url: (context, lastRes) => {return lastRes.head.data.url},
		method: "get",
		parser: rawRes => JSON.parse(rawRes.match(/controller.content.set\((.+)/)[1])
		/**
		 *the response is like below, parse the signInQuest url
		 *controller.content.set({"replace":{"omniture":{"signIn":{"guest":{"microEvent":[{"action":"Checkout: LogIn: Guest","page":"Login","slot":"Checkout","feature":"","eVar":"prop37"}]},"returningUser":{"microEvent":[{"action":"Checkout: LogIn: SignIn","page":"Login","slot":"Checkout","feature":"","eVar":"prop37"}]}},"createAccount":{"microEvent":[{"action":"Checkout: Login: Create Apple ID","page":"Login","slot":"Checkout","feature":"","eVar":"prop37"}]}},"common":{"_forms":{"main":{"subForms":["login._forms.main"]}}},"login":{"_actions":{"cancel":{"url":"/cn/shop/sentryx/sign_in?_a=login.cancel&c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&_fid=si&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF"},"resetPassword":{"url":"/cn/shop/sentryx/sign_in?_a=login.goIforgot&c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&_fid=si&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF"},"continueShopping":{"url":"/cn/shop/sentryx/sign_in?_a=login.continueShopping&c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&_fid=si&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF"},"signInGuest":{"form":"login._forms.guestCheckoutForm","url":"/cn/shop/sentryx/sign_in?_a=login.guestSign&c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&_fid=si&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF&up=true"},"signIn":{"form":"login._forms.main","url":"/cn/shop/sentryx/sign_in?_a=login.sign&c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&_fid=si&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF&up=true"},"createAccount":{"url":"/cn/shop/sentryx/sign_in?_a=login.createAccount&c=aHR0cHM6Ly93d3cuYXBwbGUuY29tL2NuL3Nob3AvYmFnfDFhb3M0MzYxMjI5OWRhYjE0YWM3OThkYzk4NTMyZjE1MWUzZTZhMTMzMThj&_fid=si&r=SXYD4UDAPXU7P7KXF&s=aHR0cHM6Ly9zZWN1cmUxLnN0b3JlLmFwcGxlLmNvbS9jbi9zaG9wL2NoZWNrb3V0L3N0YXJ0P3BsdG49N0EwNzg3MTR8MWFvczBlOTU0MWZmM2ZkNDYxMjQ1OTFkOTQ3Yzk3N2VjMDdiMTNiOGRiMDI&t=SXYD4UDAPXU7P7KXF"}},"_forms":{"main":{"fields":[{"name":"login-appleId","id":"login-appleId","validations":{"maxSize":"128","size":"30","required":true,"requiredError":"Apple ID 未填写。"},"key":"login.appleId"},{"name":"login-password","id":"login-password","validations":{"maxSize":"32","size":"30","required":true,"requiredError":"密码未填写。"},"key":"login.password"},{"name":"aywysya","type":"aywysya"},{"name":"fdcBrowserData","type":"fdcBrowserData"}],"subForms":["login._forms.guestCheckoutForm"]},"guestCheckoutForm":{"fields":[{"name":"aywysya","type":"aywysya"},{"name":"fdcBrowserData","type":"fdcBrowserData"}]}},"_events":[{"perform":"action","omniture":"omniture.signIn.returningUser","id":"sign-in","event":"click","target":"login._actions.signIn"},{"perform":"action","omniture":"omniture.signIn.returningUser","id":"sign-in-form","event":"submit","target":"login._actions.signIn"},{"perform":"action","id":"reset-password","event":"click","target":"login._actions.resetPassword"},{"perform":"action","omniture":"omniture.createAccount","id":"create-account","event":"click","target":"login._actions.createAccount"},{"perform":"action","id":"cancel-button","event":"click","target":"login._actions.cancel"},{"perform":"action","id":"continue-shopping","event":"click","target":"login._actions.continueShopping"},{"perform":"show","event":"load","target":"sign-in-content"},{"perform":"hide","event":"load","target":"forgot-password-content"},{"perform":"action","omniture":"omniture.signIn.guest","id":"guest-checkout","event":"click","target":"login._actions.signInGuest"}]}},"update":{"htmls":[{"value":" <h1>请登录<\/h1> <p class=\"secure\">安全<\/p> ","id":"account-page-header"},{"value":" <div class=\"login-checkout\"> <div tabindex=\"-1\" id=\"sign-in-content\" class=\"returning-customer\"> <div class=\"form\"> <form method=\"post\" autocomplete=\"off\" action=\"#\" id=\"sign-in-form\" class=\"sign-in\"> <h2>输入您的 Apple ID 和密码<\/h2> <div id=\"error-message\"><\/div> <fieldset><legend class=\"a11y\">登录<\/legend> <p> <span class=\"field-with-placeholder\"> <label for=\"login-appleId\" class=\"placeholder\"><span id=\"username-label\">Apple ID*<span class=\"a11y\">必填<\/span><\/span><\/label> <input name=\"login-appleId\" size=\"30\" type=\"email\" maxlength=\"128\" required=\"required\" class=\"login\" id=\"login-appleId\" /> <\/span> <span class=\"field-with-placeholder\"> <label for=\"login-password\" class=\"placeholder\"><span style=\"\" id=\"password-label\">密码*<span class=\"a11y\">必填<\/span><\/span><\/label> <input name=\"login-password\" size=\"30\" type=\"password\" maxlength=\"32\" required=\"required\" class=\"password\" id=\"login-password\" /> <\/span> <\/p> <\/fieldset> <div class=\"actions\"> <button type=\"submit\" class=\"button rect\" id=\"sign-in\"> <span> <span class=\"effect\"><\/span> <span class=\"label\"> 登录 <\/span> <\/span> <\/button> <\/div> <p id=\"iforgot-link\"><\/p> <\/form> <\/div> <\/div> <div style=\"display: none;\" id=\"forgot-password-content\"> <div class=\"form\"> <form method=\"post\" name=\"forgetPasswordForm\" action=\"\"> <h3>忘了自己的 Apple ID 或密码？<\/h3> <p><span id=\"iforgot-lockout\"><\/span><\/p> <p>重设自己的密码后，你便可以<button id=\"continue-shopping\">继续购物<\/button>。 <\/form> <\/div> <\/div> <div class=\"contact-us secondary\"> <\/div> <div class=\"guest-checkout\"> <h2>访客结帐<\/h2> <p>继续结帐，您可以在结束时创建一个 Apple ID。<\/p> <div class=\"actions\"> <button id=\"guest-checkout\" class=\"button rect\"> <span> <span class=\"effect\"><\/span> <span class=\"label\"> 以访客身份继续 <\/span> <\/span> <\/button> <\/div> <\/div> <\/div> ","id":"account-content"},{"value":" <a target=\"browser\" id=\"go-iforgot\" href=\"https://iforgot.apple.com/cgi-bin/iforgot.cgi?&language=CN-ZH&app_id=2083&newWindow=true&border=false\" data-prop37=\"AOS: | Checkout: LogIn: Forgot AppleID / Password\">忘了自己的 Apple ID 或密码？<\/a> <span class=\"a11y\">链接在新窗口中打开<\/span> ","id":"iforgot-link"},{"value":" <a target=\"browser\" href=\"https://iforgot.apple.com/cgi-bin/iforgot.cgi?&language=CN-ZH&app_id=2083&newWindow=true&border=false\" id=\"go-iforgot-lockout\">重设密码<\/a> ","id":"iforgot-lockout"}]},"url":"/cn/shop/sentryx/sign_in?_fid=si"}
		 *
		 */
	},
	signIn: (context, lastRes) => ({
		url: (context, lastRes) => `${context.lastStep.url.match(/https?\:\/\/[^\/\?]+/)[0]}${lastRes.replace.login._actions.signInGuest.url}`,
		method: "post",
		params: (context, lastRes) => {
			const result = {
				_a:'login.guestSign',
				_fid:'si',	
				up:true
			};
			// process some sp args
			const fields = lastRes.replace.login._forms.guestCheckoutForm.fields;
			const spArgs = fields.map( field => {
				/*
				if(field.type === "aywysya") {
					return {
						name: field.name || "aywysya",
						value: getMocker({documentUrl: context.lastStep.url}).aosform()
					};
				}
				if(field.type === "fdcBrowserData") {
					return {
						name: field.name,
						value: encodeURIComponent(JSON.stringify({"U": context.system.userAgent,"L":"en-US","Z":"GMT+08:00","V":"1.0"}))
					}
				}
				*/

				if(field.value) {
					return {
						name: field.name,
						value: field.value
					};
				}

				if(field.key) {
					const event = lastRes.replace.login._events.find(e => e.perform === "eset" && e.target === field.key);
					if(event) {
						return {
							name: field.name,
							value: evalSet(event.value)
						}
					} else {
						return null;
					}
				}
				return null;
			}).reduce((result, field) => {
				return Object.assign(result, field?{
					[field.name]: field.value
				}:{});
			}, {});


		},
		parser: rawRes => {
			const result = JSON.parse(rawRes);
			context.session.pltn = result.head.data.args.pltn;
			return result;
		}

		/**
		 * the response is like 
		 * {"head":{"data":{"args":{"pltn":"56B05441"},"method":"post","url":"https://secure1.store.apple.com/cn/shop/checkout/start"},"status":"302"},"body":{}}
		 */
	}),
	startSession: function(context, lastRes){
		const data = lastRes.head.data;
		return {
			url: data.url,
			method: data.method,
			params: data.args,
			parser: rawRes => {
				const result = {
					sessionID: rawRes.match(/name=\"sessionID\" type=\"hidden\" value=\"(\w{64})\"/)[1],
					checkoutUrl: rawRes.match(/action=\"(https?\:\/\/[\w\.\/]+)\"/)[1]
				}
				context.session.sessionID = result.sessionID;
				context.session.checkoutUrl = result.checkoutUrl;
				context.session.host = result.checkoutUrl.match(/^(https?\:\/\/[^\/]+)/)[1]
				return result;
			}
		};

		/**
		 *
		 * the response is like, parse the session id
		 *
		 * <html>
				<head><title>Apple (中国)</title></head>
				<body onload="proceed(); return true;">
					<noscript><p style="text-align:center;">请启用 JavaScript 以便正确显示此页。</p></noscript>
					<form method="POST" name="redirector" action="https://secure3.store.apple.com/cn/shop/checkout" data-evar1="AOS: ">
						<input name="pltn" type="hidden" value="7A078714" />
						<input name="v" type="hidden" value="on"/>
						<input name="sessionID" type="hidden" value="4d01435a708df522844f17aab8f72f6ca931e3a7d2165ba9bef39bd1355d34df" />
					</form>
					
					<script>
						function proceed() {
							this.document.forms[0].submit();
						}
					</script>
				</body>
			</html>
		 * 
		 */
	},
	checkout: {
		url: context => context.session.checkoutUrl,
		method: "post",
		params: context => ({
			pltn: context.session.pltn,
			sessionID: context.session.sessionID,
			v: "on"
		}),
		parser: rawRes => {
			const dataStr = rawRes.match(/var checkoutData = ({.+})/)[1];
			const checkoutData = JSON.parse(dataStr);
			let key, value;
			for(name in checkoutData.replace) {
				if(name.match(/^item-[\w-]{36}-delivery$/)) {
					key = name;
					value = checkoutData.replace[name].deliveryLocationType;
					break;
				}
			}
			return {
				keyName: key,
				value: value
			};
		}

		/**
		 *  detail refer ./refers/checkout.html
		 *  var checkoutData = {"replace":{"summary":{"total":"RMB 7,988","show-tax-inclusive-prices":true,"totalnoship":"RMB 7,988","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 7,988","cart-subtotal-enabled":false,"placeOrderTerms":"","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}}},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"omniture":{"pickUpRadioButtonWarmStartDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"microEvent":[{"action":"pickUpRadioButtonWarmStart","feature":"Delivery","eVar":"prop37"}]}},"changeStoreDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"microEvent":[{"action":"changeStore","feature":"Delivery","eVar":"prop37"}]}},"pickUpRadioButtonColdStartDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"microEvent":[{"action":"pickUpRadioButtonColdStart","feature":"Delivery","eVar":"prop37"}]}},"selectStoreDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"microEvent":[{"action":"selectStore","feature":"Delivery","eVar":"prop37"}]}},"rushHourItem":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"metrics":{"events":"event53","products":";MQ8J2CH/A"}}},"removeMessageDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"microEvent":[{"action":"removeMessage","feature":"Delivery","eVar":"prop37"}]}}},"_actions":{"update":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=up&_fid=co&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery","validate":false}},"deliveryLocationType":"A8","_forms":{"main":{"fields":[{"id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-deliveryLocationType","field":true,"type":"radio","events":[{"perform":"action","event":"change","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._actions.update"}],"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery.deliveryLocationType"}],"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 送达日期 2017/10/24 - 2017/10/26 <\/span> <span> - 免费 <\/span> <\/span> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions\"><\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"edit","_actions":{"continue":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.cont&_fid=co&_m=cart"}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"event":"click","omniture":"omniture.ShipPartialDefault + SingleAddressDelivery"}],"id":"cart-continue-button"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}],"events":[{"event":"load","omniture":"omniture.metricEvent"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"action","id":"cart-continue-button","event":"click","target":"cart._actions.continue"},{"perform":"method","event":"load","target":"closeStoreLocator"},{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"blank","editable":true,"enabled":true},"promo":{"_actions":{"apply":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=promo.apply&_fid=co","validate":false}},"omniture":{"editPromoButton":{"microEvent":[{"action":"enter promo code","feature":"PaymentCredit","eVar":"prop37"}]},"applyPromoButton":{"microEvent":[{"action":"apply promo code","feature":"PaymentCredit","eVar":"prop37"}]}},"code":null,"tab":"editable","_forms":{"main":{"fields":[{"name":"promo-code","id":"promo-code-edit-field-input","key":"promo.code"}],"views":[{"tabs":["editable","edit","summary"],"type":"tabGroup","prefix":"promo-code","key":"promo.tab"}]}},"_events":[{"perform":"action","omniture":"promo.omniture.applyPromoButton","id":"promo-code-edit-apply-button","event":"click","target":"promo._actions.apply"},{"perform":"focus","omniture":"promo.omniture.editPromoButton","id":"promo-code-edit-button","event":"click","target":"promo-code-edit-field-input"}]},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":1199644,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"scrollToShippingCallToActionCart-auto":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Cart-auto","eVar":"eVar21"}]},"3rd Party Pickup SMSDelivery":{"microEvent":[{"action":"3rd Party Pickup SMS","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar21"}]},"businessAddressCheckedDelivery":{"microEvent":[{"action":"businessAddressChecked","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"ShipPartialDefault + MultipleAddressDelivery":{"microEvent":[{"action":"ShipPartialDefault + MultipleAddress","feature":"Delivery","eVar":"eVar40"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Delivery"}},"businessAddressUncheckedDelivery":{"microEvent":[{"action":"businessAddressUnchecked","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"ShipPartialDefault + SingleAddressDelivery":{"microEvent":[{"action":"ShipPartialDefault + SingleAddress","feature":"Delivery","eVar":"eVar40"}]},"ShipPartial + MultipleAddressDelivery":{"microEvent":[{"action":"ShipPartial + MultipleAddress","feature":"Delivery","eVar":"eVar40"}]},"immediateDeliveryItem":{"metrics":{"events":"event70"}},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"SMS Notification selectedDelivery":{"microEvent":[{"action":"SMS Notification selected","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar21"}]},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"ShipPartial + SingleAddressDelivery":{"microEvent":[{"action":"ShipPartial + SingleAddress","feature":"Delivery","eVar":"eVar40"}]},"continueDelivery":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"smsSelectedDelivery":{"microEvent":[{"action":"smsSelected","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar21"}]},"Primary Pickup SMSDelivery":{"microEvent":[{"action":"Primary Pickup SMS","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar21"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"ShipComplete + SingleAddressDelivery":{"microEvent":[{"action":"ShipComplete + SingleAddress","feature":"Delivery","eVar":"eVar40"}]},"editShippingCallToActionCart-auto":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Cart-auto","eVar":"eVar21"}]},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"Business address uncheckedDelivery":{"microEvent":[{"action":"Business address unchecked","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"SMS Notification not selectedDelivery":{"microEvent":[{"action":"SMS Notification not selected","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar21"}]},"smsNotificationSelectedDelivery":{"microEvent":[{"action":"smsNotificationSelected","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar21"}]},"errorDelivery":{"microEvent":[{"action":"error | ","slot":"AOS: Checkout","feature":"Delivery","eVar":"eVar25"}]},"ShipCompleteDefault + SingleAddressDelivery":{"microEvent":[{"action":"ShipCompleteDefault + SingleAddress","feature":"Delivery","eVar":"eVar40"}]},"Business address checkedDelivery":{"microEvent":[{"action":"Business address checked","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}}},"common":{"_actions":{"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"2cfe903b178e5ca17d609b2e81615b151d6c818428c033995108da4e155df759"},{"name":"overrideFormat"}],"subForms":["cart._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 东城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"blank","title":true,"editable":true,"enabled":true},"terms":{"mode":"blank","editable":true,"enabled":true},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":1,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item phl quantity-select\"> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 7,988<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided edit-mode-change mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"blank","editable":true,"enabled":true},"account":{"mode":"blank","editable":true,"enabled":true}},"update":{"htmls":[{"value":" <div id=\"promo-code-editable-content\" style=\"display: none\"> <button class=\"text-action\" id=\"promo-code-edit-button\">输入促销代码<\/button> <\/div> <div id=\"promo-code-edit-content\" style=\"display: none\"> <span class=\"promoCode-field\"> <label for=\"promo-code-edit-field-input\" class=\"placeholder\"><span>促销代码<\/span><\/label> <input maxlength=\"12\" type=\"text\" id=\"promo-code-edit-field-input\" /> <\/span> <button class=\"text-action\" id=\"promo-code-edit-apply-button\">应用 <span class=\"a11y\">促销代码<\/span><\/button> <\/div> <div id=\"promo-code-summary-content\" style=\"display: none\"> 促销代码 - <span id=\"promo-code\"><\/span> <button class=\"text-action\" id=\"promo-code-remove-button\"><span class=\"replaced\">删除<\/span><\/button> <\/div> ","id":"promo-code-box"}]},"url":"/cn/shop/checkoutx"}
		 */
	},
	fillCart: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: (context, lastRes) => ({
			['cart-${lastRes.keyName}-deliveryLocationType']:lastRes.value,
			sessionID: context.session.sessionID,
			_a:'cart.cont',
			_fid:'co',
			_m: 'cart'
		}),
		parser: JSON.parse

		/**
		 *  response is like below
		 *
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"summary":{"total":"RMB 15,976","show-tax-inclusive-prices":true,"totalnoship":"RMB 15,975","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 15,976","cart-subtotal-enabled":false,"placeOrderTerms":"","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}}},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 送达日期 2017/10/24 - 2017/10/26 <\/span> <span> - 免费 <\/span> <\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"summary","_actions":{"edit":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.edit&_fid=co&_m=cart","validate":false}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"perform":"action","omniture":"omniture.Edit ButtonDelivery","event":"click","target":"cart._actions.edit"},{"perform":"focus","event":"click","target":"delivery-box"}],"id":"edit-deliveryandpickup-link"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"blank","editable":true,"enabled":true},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":1074904,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"editDelivery":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Edit ButtonDelivery":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Shipping"}},"editShippingCallToActionShipping-auto":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Shipping-auto","eVar":"eVar21"}]},"continueShipping":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"scrollToShippingCallToActionShipping-auto":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Shipping-auto","eVar":"eVar21"}]},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}},"errorShipping":{"microEvent":[{"action":"error | ","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar25"}]}},"common":{"_actions":{"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"},{"name":"overrideFormat"}],"subForms":["cart._forms.main","shipping._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 西城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"edit","_actions":{"continue":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=ship.cont&_fid=co"}},"address":{"country":"中国","_actions":{"localityLookup":{"city":{"form":"shipping._forms.localityLookupForm.shipping.city","url":"/cn/shop/addressx/locality_lookup?_a=locale.lkup&_fid=locale","validate":false},"state":{"form":"shipping._forms.localityLookupForm.shipping.state","url":"/cn/shop/addressx/locality_lookup?_a=locale.lkup&_fid=locale","validate":false}}},"city":"北京","countryCode":"CN","district":"西城区","state":"北京","localityOptions":{"state":[{"value":"","text":"省份"},{"value":"北京","text":"北京"},{"value":"上海","text":"上海"},{"value":"天津","text":"天津"},{"value":"重庆","text":"重庆"},{"value":"安徽","text":"安徽"},{"value":"福建","text":"福建"},{"value":"甘肃","text":"甘肃"},{"value":"广东","text":"广东"},{"value":"广西壮族自治区","text":"广西壮族自治区"},{"value":"贵州","text":"贵州"},{"value":"海南","text":"海南"},{"value":"河北","text":"河北"},{"value":"河南","text":"河南"},{"value":"黑龙江","text":"黑龙江"},{"value":"湖北","text":"湖北"},{"value":"湖南","text":"湖南"},{"value":"吉林","text":"吉林"},{"value":"江苏","text":"江苏"},{"value":"江西","text":"江西"},{"value":"辽宁","text":"辽宁"},{"value":"内蒙古自治区","text":"内蒙古自治区"},{"value":"宁夏回族自治区","text":"宁夏回族自治区"},{"value":"青海","text":"青海"},{"value":"山东","text":"山东"},{"value":"山西","text":"山西"},{"value":"陕西","text":"陕西"},{"value":"四川","text":"四川"},{"value":"西藏自治区","text":"西藏自治区"},{"value":"新疆维吾尔自治区","text":"新疆维吾尔自治区"},{"value":"云南","text":"云南"},{"value":"浙江","text":"浙江"}],"city":[{"value":"","text":"城镇/城市"},{"value":"北京","text":"北京"}],"district":[{"value":"","text":"区"},{"value":"东城区","text":"东城区"},{"value":"西城区","text":"西城区"},{"value":"朝阳区","text":"朝阳区"},{"value":"海淀区","text":"海淀区"},{"value":"丰台区","text":"丰台区"},{"value":"石景山区","text":"石景山区"},{"value":"通州区","text":"通州区"},{"value":"平谷区","text":"平谷区"},{"value":"顺义区","text":"顺义区"},{"value":"怀柔区","text":"怀柔区"},{"value":"密云区","text":"密云区"},{"value":"延庆区","text":"延庆区"},{"value":"昌平区","text":"昌平区"},{"value":"门头沟区","text":"门头沟区"},{"value":"房山区","text":"房山区"},{"value":"大兴区","text":"大兴区"}]}},"editable":true,"title":true,"_forms":{"shippingAddressForm":{"fields":[{"name":"shipping-user-lastName","id":"shipping-user-lastName","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":20,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入姓氏。"},"key":"shipping.address.lastName"},{"name":"shipping-user-firstName","id":"shipping-user-firstName","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":14,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入名字。"},"key":"shipping.address.firstName"},{"name":"shipping-user-daytimePhoneAreaCode","id":"shipping-user-daytimePhoneAreaCode","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":4,"validRegexes":["^[0-9]{1,4}$"],"maxSize":4,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入电话号码区号。"},"type":"phoneNumber","key":"shipping.address.daytimePhoneAreaCode"},{"name":"shipping-user-daytimePhone","id":"shipping-user-daytimePhone","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":11,"validRegexes":["^(1[0-9]{10}|[0-9]{7}|[0-9]{8})$"],"maxSize":11,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入电话号码。"},"type":"phoneNumber","key":"shipping.address.daytimePhone"},{"resetOnDisable":false,"optionsValueKey":"shipping.address.localityOptions.state.value","optionsDisplayKey":"shipping.address.localityOptions.state.text","name":"shipping-user-state","id":"shipping-user-state","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","validValues":["北京","天津","辽宁","吉林","上海","浙江","江苏","安徽","福建","山东","湖北","广东","海南","重庆","四川","贵州","云南","黑龙江","甘肃","河北","河南","湖南","江西","内蒙古自治区","宁夏回族自治区","陕西","山西","广西壮族自治区","新疆维吾尔自治区","青海","西藏自治区"],"required":true,"requiredError":"请填写此必填字段。"},"type":"localitySelect","optionsKey":"shipping.address.localityOptions.state","key":"shipping.address.state"},{"resetOnDisable":false,"optionsValueKey":"shipping.address.localityOptions.city.value","optionsDisplayKey":"shipping.address.localityOptions.city.text","name":"shipping-user-city","id":"shipping-user-city","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":30,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"type":"localitySelect","optionsKey":"shipping.address.localityOptions.city","key":"shipping.address.city"},{"resetOnDisable":false,"optionsValueKey":"shipping.address.localityOptions.district.value","optionsDisplayKey":"shipping.address.localityOptions.district.text","name":"shipping-user-district","id":"shipping-user-district","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"type":"localitySelect","optionsKey":"shipping.address.localityOptions.district","key":"shipping.address.district"},{"name":"shipping-user-street","id":"shipping-user-street","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":20,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入街道地址。"},"key":"shipping.address.street"},{"name":"shipping-user-street2","id":"shipping-user-street2","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":20,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请填写此必填字段。"},"key":"shipping.address.street2"},{"name":"shipping-user-postalCode","id":"shipping-user-postalCode","validations":{"invalidValueError":"此输入无效。请填入3至6位数字。","size":5,"validRegexes":["^[0-9]{3,6}$"],"maxSize":6,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请输入邮政编码。"},"key":"shipping.address.postalCode"},{"name":"shipping-user-emailAddress","id":"shipping-user-emailAddress","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":35,"maxSize":64,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"shipping.address.emailAddress"},{"name":"shipping-user-mobilePhone","id":"shipping-user-mobilePhone","validations":{"invalidValueError":"手机号码必须为 11 位数或 12 位数，且不含任何特殊字符。","size":16,"validRegexes":["^[0-9]{11,12}$"],"maxSize":16,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请填写此必填字段。"},"type":"phoneNumber","key":"shipping.address.mobilePhone"}],"views":[{"id":"shipping-user-address_section"},{"id":"shipping-user-contact_section"},{"key":"shipping.address.country","id":"shipping-user-country"}]},"main":{"subForms":["shipping._forms.shippingAddressForm","shipping._forms.localityLookupForm.shipping.state","shipping._forms.localityLookupForm.shipping.city","shipping._forms.shippingSaveAsDefaultForm"],"views":[{"events":[{"perform":"action","event":"click","target":"shipping._actions.continue"}],"id":"shipping-continue-button"},{"events":[{"perform":"method","event":"click","target":"copyAddressPhone"}],"id":"shipping-user-copyShippingAddressPhone"}],"events":[{"event":"load","omniture":"omniture.metricEvent"},{"event":"load","omniture":"omniture.startShipping"}]},"localityLookupForm":{"shipping":{"city":{"fields":[{"name":"state","key":"shipping.address.state"},{"name":"city","key":"shipping.address.city"},{"name":"keyPath","value":"shipping.address"}]},"state":{"fields":[{"name":"state","key":"shipping.address.state"},{"name":"keyPath","value":"shipping.address"}]}}},"shippingSaveAsDefaultForm":{"views":[{"html":" ","id":"shipping-step-defaults"}]}},"enabled":true,"_events":[{"perform":"action","event":"change","key":"shipping.address.state","target":"shipping.address._actions.localityLookup.state"},{"perform":"action","event":"change","key":"shipping.address.city","target":"shipping.address._actions.localityLookup.city"}]},"terms":{"mode":"blank","editable":true,"enabled":true},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":2,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item first product-price\"> <span class=\"a11y\">物品价格：<\/span> RMB 7,988 <\/li> <li class=\"item phl quantity-select\"> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity\"><\/span> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 15,976<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"blank","editable":true,"enabled":true},"account":{"mode":"blank","editable":true,"enabled":true}},"update":{"htmls":[{"value":" <fieldset class=\"CN first user-form-fieldset\"> <legend class=\"label\">送货地址 <\/legend> <div class=\"user-address fieldset-content\" id=\"shipping-user-address_section\"> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-nameLines-0-prf\"><\/span> <span class=\"lastName-field field-with-placeholder\"> <label for=\"shipping-user-lastName\" class=\"placeholder\"> <span>姓氏<\/span> <\/label> <input name=\"shipping-user-lastName\" type=\"text\" size=\"10\" maxlength=\"20\" id=\"shipping-user-lastName\" /> <\/span> <span class=\"firstName-field field-with-placeholder\"> <label for=\"shipping-user-firstName\" class=\"placeholder\"> <span>名字<\/span> <\/label> <input name=\"shipping-user-firstName\" type=\"text\" size=\"10\" maxlength=\"14\" id=\"shipping-user-firstName\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-contactLines-0-prf\"><\/span> <span class=\"daytimePhoneAreaCode-field field-with-placeholder\"> <label for=\"shipping-user-daytimePhoneAreaCode\" class=\"placeholder\"> <span>区号<\/span> <\/label> <input name=\"shipping-user-daytimePhoneAreaCode\" type=\"text\" size=\"4\" maxlength=\"4\" class=\"kp-tel\" id=\"shipping-user-daytimePhoneAreaCode\" /> <\/span> <span class=\"daytimePhone-field field-with-placeholder\"> <label for=\"shipping-user-daytimePhone\" class=\"placeholder\"> <span>联系号码 (如手机，区号输0)<\/span> <\/label> <input name=\"shipping-user-daytimePhone\" type=\"text\" size=\"11\" maxlength=\"11\" class=\"kp-tel\" id=\"shipping-user-daytimePhone\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-addressLines-0-prf\"><\/span> <span class=\"state-field field-with-placeholder\"> <label for=\"shipping-user-state\" class=\"a11y\"> 省份 <\/label> <select name=\"shipping-user-state\" id=\"shipping-user-state\"><\/select> <\/span> <span class=\"city-field field-with-placeholder\"> <label for=\"shipping-user-city\" class=\"a11y\"> 城镇/城市 <\/label> <select name=\"shipping-user-city\" id=\"shipping-user-city\"><\/select> <\/span> <span class=\"district-field field-with-placeholder\"> <label for=\"shipping-user-district\" class=\"a11y\"> 区 <\/label> <select name=\"shipping-user-district\" id=\"shipping-user-district\"><\/select> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-addressLines-1-prf\"><\/span> <span class=\"street-field field-with-placeholder\"> <label for=\"shipping-user-street\" class=\"placeholder\"> <span>区，街道编号/名称，楼宇名称<\/span> <\/label> <input name=\"shipping-user-street\" type=\"text\" size=\"20\" maxlength=\"35\" id=\"shipping-user-street\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-addressLines-2-prf\"><\/span> <span class=\"street2-field field-with-placeholder\"> <label for=\"shipping-user-street2\" class=\"placeholder\"> <span>房间、套房、单元、楼层或街区<\/span> <\/label> <input name=\"shipping-user-street2\" type=\"text\" size=\"20\" maxlength=\"35\" id=\"shipping-user-street2\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-addressLines-3-prf\"><\/span> <span class=\"postalCode-field field-with-placeholder\"> <label for=\"shipping-user-postalCode\" class=\"placeholder\"> <span>邮政编码<\/span> <\/label> <input name=\"shipping-user-postalCode\" type=\"text\" size=\"5\" maxlength=\"6\" id=\"shipping-user-postalCode\" /> <\/span> <\/div> <div class=\"optional-multicol\"> <span class=\"country-field field-with-placeholder first\"><span id=\"shipping-user-country\"><\/span><\/span> <\/div> <\/div> <\/fieldset> <fieldset class=\"CN user-form-fieldset\"> <legend class=\"label\">发货通知 <div rel=\"contact_section_rel\" class=\"whats-this right bottom\"> <span class=\"toggle\">这是什么？<\/span> <div class=\"contact-section info\"><p><strong>将您订购的商品发送给其他人？<\/strong><br /> 如果您提供收货人的联系电话和电子邮件地址，我们可以就发货问题与收货人联系。<br /><\/p> <strong>针对送礼顾客的特别提醒<\/strong><br /> 提供收货人的电子邮件地址或手机号码，即表示您允许我们向收货人发送确认信息。如果您要将购买的商品作为赠礼，确认电子邮件很可能会破坏超酷的全新 Apple 产品送达时所带来的\u201c惊喜\u201d。<\/div> <\/div> <\/legend> <div class=\"user-contact fieldset-content\" id=\"shipping-user-contact_section\"> <span class=\"address-info\"><p class=\"text-alt\">发货通知电子邮件已发送至帐单联系人。可在下方添加其他收件人的电子邮件地址。<\/p><\/span> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-emailLines-0-prf\"><\/span> <span class=\"emailAddress-field field-with-placeholder\"> <label for=\"shipping-user-emailAddress\" class=\"placeholder\"> <span>电子邮件<\/span> <\/label> <input name=\"shipping-user-emailAddress\" type=\"text\" size=\"35\" maxlength=\"64\" class=\"kp-email\" id=\"shipping-user-emailAddress\" /> <\/span> <\/div> <span class=\"address-info\"><p class=\"text-alt\"> 请在下面输入手机号码，以接收短信了解最新发货状态。此处号码仅限于接收短信。<\/p><\/span> <div class=\"optional-multicol\"> <span id=\"copyShippingAddressPhonePhone-wrapper\" class=\"last\"> <button type=\"button\" class=\"text-action\" id=\"shipping-user-copyShippingAddressPhone\"> <em>与收货地址的电话相同<\/em> <\/button> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"shipping-user-notificationLines-0-prf\"><\/span> <span class=\"mobilePhone-field field-with-placeholder\"> <label for=\"shipping-user-mobilePhone\" class=\"placeholder\"> <span>手机号码（可选）<\/span> <\/label> <input name=\"shipping-user-mobilePhone\" type=\"text\" size=\"16\" maxlength=\"16\" class=\"kp-tel\" id=\"shipping-user-mobilePhone\" /> <\/span> <\/div> <\/div> <\/fieldset> ","id":"shipping-user"}]},"url":"/cn/shop/checkoutx"}}
		 */
	},
	fillShip: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: context => ({
			sessionID: context.session.sessionID,
			'shipping-user-lastName': context.user.lastName,
			'shipping-user-firstName':context.user.firstName,
			'shipping-user-daytimePhoneAreaCode': context.user.daytimePhoneAreaCode,
			'shipping-user-daytimePhone': context.user.daytimePhone,
			'shipping-user-state':context.user.state,
			'shipping-user-city':context.user.city,
			'shipping-user-district':context.user.district,
			'shipping-user-street': context.user.street,
			'shipping-user-street2':context.user.street2,
			'shipping-user-postalCode': context.user.postalCode,
			'shipping-user-emailAddress': context.user.emailAddress,
			'shipping-user-mobilePhone': `${context.user.daytimePhoneAreaCode}${context.user.daytimePhone}`,
			'state':context.user.state,
			'city': context.user.city,
			'keyPath':'shipping.address',
			'_a':'ship.cont',
			'_fid':'co'
		}),
		parser: JSON.parse

		/**
		 *
		 * the reponse is like below 
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"summary":{"total":"RMB 15,976","show-tax-inclusive-prices":true,"totalnoship":"RMB 15,975","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 15,976","cart-subtotal-enabled":false,"placeOrderTerms":"","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}}},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 送达日期 2017/10/24 - 2017/10/26 <\/span> <span> - 免费 <\/span> <\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"summary","_actions":{"edit":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.edit&_fid=co&_m=cart","validate":false}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"perform":"action","omniture":"omniture.Edit ButtonDelivery","event":"click","target":"cart._actions.edit"},{"perform":"focus","event":"click","target":"delivery-box"}],"id":"edit-deliveryandpickup-link"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"edit","_actions":{"continue":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=bill.cont&_fid=co"}},"external":{"phonePay":{"6359463ebf2f4fe19f4e883f80181095-273":{"customerIdCardNumber":"","mobilePhoneNumber":"","bankCardNumber":"","type":"PAYEASE_PHONE_LOCAL","accountHolderName":""}},"omniture":{"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Payment"}}},"countrySelector":{"_actions":{"country":{"form":"common._forms.document","url":"/cn/shop/checkoutx/billing?_a=countrySelector&_fid=co","validate":false}}},"local":"ONLINE","creditCardPay":{"6359463ebf2f4fe19f4e883f80181095-273":{"expirationYear":null,"securityCode":null,"expirationMonth":null,"type":"VISA","cardNumber":""}}},"editable":true,"_forms":{"billingCodPaymentForm":{"views":[{"tabs":["COD"],"aliases":{"COD":"pay-onDelivery"},"type":"tabGroup","key":"billing.external.bankOption"},{"tabs":["CODPOS"],"aliases":{"CODPOS":"pay-onDelivery-pos"},"type":"tabGroup","key":"billing.external.bankOption"}]},"billingPaymentOptions":{"fields":[{"name":"bankOption","id":"payment-form-options","validations":{"required":true,"requiredError":"请从以下付款方式中选择一种进行支付。"},"alertId":"payment-form-options-error","type":"radio","key":"billing.external.bankOption","events":[{"perform":"method","event":"change","target":"bankmethod"}]}],"views":[{"id":"payment-bank-phone-options"},{"id":"payment-other-options"}]},"paymentParentForm":{"activations":[{"key":"billing.external.bankOption","validations":{"validRegexes":["38","18"],"required":true}}],"fields":[{"resetOnDisable":false,"name":"payment-form-countrySelector-countryCode","id":"payment-form-countrySelector-countryCode","validations":{"required":true,"requiredError":"请选择帐单地址所在的国家/地区。"},"key":"billing.external.countrySelector.countryCode"}]},"billingExternalInstallmentsPaymentForm":{"activations":[{"omniture":"omniture.deferred payment | continuePayment","validations":{"validValues":["0000791680","0000833448","0000882241"]},"key":"billing.external.bankOption"}],"views":[{"tabs":["0000791680","0000833448","0000882241"],"aliases":{"0000833448":"payment-form-options-installments","0000882241":"payment-form-options-installments","0000791680":"payment-form-options-installments"},"type":"tabGroup","key":"billing.external.bankOption"}]},"main":{"subForms":["billing._forms.billingCodPaymentForm","billing._forms.billingExternalInstallmentsPaymentForm","installments._forms.main","billing._forms.billingLocalPaymentForm","billing._forms.billingSaveAsDefaultForm","billing._forms.billingMethodCcForm","billing._forms.paymentParentForm","billing._forms.billingAddressForm","billing._forms.billingExternalIccPaymentForm","billing._forms.billingAlipayForm","billing._forms.billingWeChatForm","creditTypes._forms.main","billing._forms.billingPaymentOptions"],"views":[{"events":[{"perform":"action","event":"click","target":"billing._actions.continue"}],"id":"payment-continue-button"}],"events":[{"event":"load","omniture":"omniture.LocalBankPayment"}]},"billingSaveAsDefaultForm":{"activations":[{"validations":{"validRegexes":["38","18"]},"key":"billing.external.bankOption","validate":false}],"views":[{"html":" ","id":"payment-step-defaults"}]},"billingWeChatForm":{"activations":[{"omniture":"omniture.deferred payment | continuePayment","validations":{"validRegexes":["WeChat"]},"key":"billing.external.bankOption"}],"views":[{"tabs":["WeChat"],"aliases":{"WeChat":"wechat-instr"},"type":"tabGroup","key":"billing.external.bankOption"}]},"billingExternalIccPaymentForm":{"views":[{"tabs":["38","18"],"aliases":{"38":"international-credit-cards","18":"international-credit-cards"},"type":"tabGroup","key":"billing.external.bankOption"}]},"billingPhonePaymentForm":{"activations":[{"key":"billing.external.local","validations":{"validRegexes":["PHONE"]}}],"fields":[{"name":"payment-form-phonePay-accountHolderName","id":"payment-form-phonePay-accountHolderName","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":20,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"billing.external.phonePay.6359463ebf2f4fe19f4e883f80181095-273.accountHolderName"},{"name":"payment-form-phonePay-bankCardNumber","id":"payment-form-phonePay-bankCardNumber","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"validRegexes":["^[0-9]{15,19}$"],"maxSize":19,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"type":"cardNumber","key":"billing.external.phonePay.6359463ebf2f4fe19f4e883f80181095-273.bankCardNumber","paymentType":"billing.external.phonePay.6359463ebf2f4fe19f4e883f80181095-273.type"},{"name":"payment-form-phonePay-mobilePhoneNumber","id":"payment-form-phonePay-mobilePhoneNumber","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"validRegexes":["^1[0-9]{10}$"],"maxSize":11,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"billing.external.phonePay.6359463ebf2f4fe19f4e883f80181095-273.mobilePhoneNumber"},{"name":"payment-form-phonePay-customerIdCardNumber","id":"payment-form-phonePay-customerIdCardNumber","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"validRegexes":["^[0-9]{14}([a-zA-Z]|[0-9])$|^[0-9]{17}(x|X|[0-9])$"],"maxSize":20,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"billing.external.phonePay.6359463ebf2f4fe19f4e883f80181095-273.customerIdCardNumber"}]},"billingAddressForm":{"activations":[{"key":"billing.external.bankOption","validations":{"validRegexes":["38","18"]}}]},"billingLocalPaymentForm":{"activations":[{"omniture":"omniture.deferred payment | continuePayment","validations":{"validValues":["3","0000833266","43","4","85","74","28","84","14"]},"key":"billing.external.bankOption"}],"fields":[{"name":"local","id":"payment-localbank-options","validations":{"required":true,"requiredError":"请从以下付款方式中选择一种进行支付。"},"alertId":"options-error","type":"radio","key":"billing.external.local","events":[{"perform":"method","event":"change","target":"bankmethod"}]}],"subForms":["billing._forms.billingPhonePaymentForm"],"views":[{"tabs":["PHONE"],"aliases":{"PHONE":"payment-localbank-options"},"type":"tabGroup","key":"billing.external.local"},{"tabs":["3","0000833266","43","4","85","74","28","84","14"],"aliases":{"3":"bank-phone-1","14":"bank-phone-4","4":"bank-phone-1","28":"bank-phone-3","0000833266":"bank-phone-1","84":"bank-phone-4","85":"bank-phone-2","74":"bank-phone-3","43":"bank-phone-1"},"type":"tabGroup","key":"billing.external.bankOption"}]},"billingAlipayForm":{"activations":[{"omniture":"omniture.deferred payment | continuePayment","validations":{"validRegexes":["Alipay"]},"key":"billing.external.bankOption"}],"views":[{"tabs":["Alipay"],"aliases":{"Alipay":"alipay-instr"},"type":"tabGroup","key":"billing.external.bankOption"}]},"billingMethodCcForm":{"activations":[{"key":"billing.external.bankOption","validations":{"validRegexes":["38","18"]}}],"fields":[{"id":"payment-form-creditCardPay-cardNumber","validations":{"validRegexes":["^[0-9]+$"],"invalidValueError":"此输入无效。请检查信息是否正确。","maxSize":16,"required":true},"type":"cardNumber","key":"billing.external.creditCardPay.6359463ebf2f4fe19f4e883f80181095-273.cardNumber","paymentType":"payment-form-creditCardPay-type"},{"id":"payment-form-creditCardPay-security-code","validations":{"validRegexes":["^[0-9]+$"],"invalidValueError":"此输入无效。请检查信息是否正确。","maxSize":3,"required":true},"type":"securityCodeField","key":"billing.external.creditCardPay.6359463ebf2f4fe19f4e883f80181095-273.securityCode","paymentType":"billing.external.creditCardPay.6359463ebf2f4fe19f4e883f80181095-273.type"},{"id":"payment-form-creditCardPay-expirationMonth","validations":{"required":true,"requiredError":"请选择有效月份。"},"type":"expirationMonth","key":"billing.external.creditCardPay.6359463ebf2f4fe19f4e883f80181095-273.expirationMonth"},{"id":"payment-form-creditCardPay-expirationYear","validations":{"required":true,"requiredError":"请选择有效年份。"},"type":"expirationYear","key":"billing.external.creditCardPay.6359463ebf2f4fe19f4e883f80181095-273.expirationYear"}],"views":[{"tabs":["38","18"],"aliases":{"38":"save-as-default","18":"save-as-default"},"type":"tabGroup","key":"billing.external.bankOption"}]}},"enabled":true,"_events":[{"perform":"method","id":"show-more-banks","event":"click","target":"showdetails"},{"perform":"action","event":"change","key":"billing.external.countrySelector.countryCode","target":"billing.external.countrySelector._actions.country"},{"event":"load","omniture":"billing.external.omniture.metricEvent"},{"perform":"method","event":"load","target":"setBankMethod"}]},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":585069,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"continuePayment":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"smsNotificationSelectedShipping":{"microEvent":[{"action":"smsNotificationSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Business address uncheckedShipping":{"microEvent":[{"action":"Business address unchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"Primary Pickup SMSShipping":{"microEvent":[{"action":"Primary Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Edit ButtonShipping":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Payment"}},"smsSelectedShipping":{"microEvent":[{"action":"smsSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Business address checkedShipping":{"microEvent":[{"action":"Business address checked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"3rd Party Pickup SMSShipping":{"microEvent":[{"action":"3rd Party Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"SMS Notification not selectedShipping":{"microEvent":[{"action":"SMS Notification not selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"businessAddressUncheckedShipping":{"microEvent":[{"action":"businessAddressUnchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editDelivery":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Edit ButtonDelivery":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"businessAddressCheckedShipping":{"microEvent":[{"action":"businessAddressChecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"scrollToShippingCallToActionBilling-init":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Billing-init","eVar":"eVar21"}]},"LocalBankPayment":{"microEvent":[{"action":"LocalBank |  | continue","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"editShippingCallToActionBilling-init":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Billing-init","eVar":"eVar21"}]},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"errorPayment":{"microEvent":[{"action":"error | 请输入有效的付款信息。,请输入有效的付款信息。","slot":"AOS: Checkout","feature":"Payment","eVar":"eVar25"}]},"SMS Notification selectedShipping":{"microEvent":[{"action":"SMS Notification selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"editShipping":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}}},"creditTypes":{"messages":{"invalidValueError":"此输入无效。请检查信息是否正确。","invalidFieldsError":"请更正突出显示的字段。","requiredError":"请填写此必填字段。"},"_forms":{"VISA":{"fields":[{"key":"securityCode","validations":{"maxSize":3,"required":true,"minLength":3}},{"key":"cardNumber","validations":{"maxSize":16,"validRanges":["4","51","52","53","55","54","58"],"required":true,"validLengths":[16,13]}}]},"main":{"subForms":["creditTypes._forms.VISA","creditTypes._forms.PAYEASE_PHONE_LOCAL"]},"PAYEASE_PHONE_LOCAL":{"fields":[{"key":"bankCardNumber","validations":{"maxSize":19,"required":true,"validLengths":[15,16,17,18,19]}}]}}},"common":{"_actions":{"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"},{"name":"overrideFormat"}],"subForms":["cart._forms.main","shipping._forms.main","billing._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 西城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=ship.edit&_fid=co","validate":false}},"address":{"lastName":"刘","country":"中国","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","mobilePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"title":true,"_forms":{"shippingAddressForm":{"views":[{"key":"shipping.address.lastName","id":"shipping-summary-user-lastName"},{"key":"shipping.address.firstName","id":"shipping-summary-user-firstName"},{"key":"shipping.address.daytimePhoneAreaCode","id":"shipping-summary-user-daytimePhoneAreaCode"},{"key":"shipping.address.daytimePhone","id":"shipping-summary-user-daytimePhone"},{"key":"shipping.address.state","id":"shipping-summary-user-state"},{"key":"shipping.address.city","id":"shipping-summary-user-city"},{"key":"shipping.address.district","id":"shipping-summary-user-district"},{"key":"shipping.address.street","id":"shipping-summary-user-street"},{"key":"shipping.address.street2","id":"shipping-summary-user-street2"},{"key":"shipping.address.postalCode","id":"shipping-summary-user-postalCode"},{"key":"shipping.address.country","id":"shipping-summary-user-country"},{"key":"shipping.address.emailAddress","id":"shipping-summary-user-emailAddress"},{"key":"shipping.address.mobilePhone","id":"shipping-summary-user-mobilePhone"}]},"main":{"subForms":["shipping._forms.shippingAddressForm"],"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonShipping","event":"click","target":"shipping._actions.edit"},{"perform":"focus","event":"click","target":"shipping-box"}],"id":"shipping-edit-button"}],"events":[{"event":"load","omniture":"omniture.smsNotificationSelectedShipping"},{"event":"load","omniture":"omniture.businessAddressUncheckedShipping"}]}},"enabled":true},"installments":{"shouldShowInstallments":false,"_actions":{"installmentsComparison":{"url":"/cn/shop/checkoutx/billing?_a=bill.instcomp&_fid=co","validate":false},"installmentsLookup":{"form":"billing._forms.main","url":"/cn/shop/checkoutx/billing?_a=bill.instlkup&_fid=co","validate":false}},"omniture":{"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Payment"}},"compareInstallmentOptionsOverlayClickedBilling":{"microEvent":[{"action":"compareInstallmentOptionsOverlayClicked","feature":"Billing","eVar":"eVar21"}]}},"_forms":{"main":{"views":[{"html":" ","id":"payment-form-options-installments-content"},{"html":" <span class=\"payment-compare-installments\" id=\"payment-form-options-installments-content-comparison\"> <button type=\"button\" class=\"link separated-link\" id=\"payment-form-options-installments-content-comparison-button\"> <em>比较分期付款方案<\/em> <span class=\"a11y\">进一步了解分期付款选项<\/span> <\/button> <\/span> ","id":"payment-form-options-installments-content-comparison"}]}},"_events":[{"perform":"action","id":"payment-form-options-0000791680-1","event":"click","target":"installments._actions.installmentsLookup"},{"perform":"action","id":"payment-form-options-0000833448-2","event":"click","target":"installments._actions.installmentsLookup"},{"perform":"action","id":"payment-form-options-0000882241-3","event":"click","target":"installments._actions.installmentsLookup"},{"perform":"focus","event":"load","target":"payment-installment-options"},{"perform":"action","omniture":"installments.omniture.compareInstallmentOptionsOverlayClickedBilling","id":"payment-form-options-installments-content-comparison-button","event":"click","target":"installments._actions.installmentsComparison"}]},"terms":{"mode":"blank","editable":true,"enabled":true},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":2,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item first product-price\"> <span class=\"a11y\">物品价格：<\/span> RMB 7,988 <\/li> <li class=\"item phl quantity-select\"> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity\"><\/span> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 15,976<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"blank","editable":true,"enabled":true},"account":{"mode":"blank","editable":true,"enabled":true}},"update":{"htmls":[{"value":" <div class=\"user-address subsection\" id=\"shipping-summary-user-address_section\"> <h3 class=\"label\">送货地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"shipping-summary-user-lastName\"> <\/span> <span class=\"firstName\" id=\"shipping-summary-user-firstName\"> <\/span> <span id=\"shipping-summary-user-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-contactLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"shipping-summary-user-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"shipping-summary-user-daytimePhone\"> <\/span><span id=\"shipping-summary-user-contactLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-0-prf\"><\/span><span class=\"state\" id=\"shipping-summary-user-state\"> <\/span> <span class=\"city\" id=\"shipping-summary-user-city\"> <\/span> <span class=\"district\" id=\"shipping-summary-user-district\"> <\/span> <span id=\"shipping-summary-user-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-1-prf\"><\/span><span class=\"street\" id=\"shipping-summary-user-street\"> <\/span><span id=\"shipping-summary-user-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-2-prf\"><\/span><span class=\"street2\" id=\"shipping-summary-user-street2\"> <\/span><span id=\"shipping-summary-user-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-3-prf\"><\/span><span class=\"postalCode\" id=\"shipping-summary-user-postalCode\"> <\/span> <span id=\"shipping-summary-user-addressLines-3-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"shipping-summary-user-country\"><\/span><\/span> <\/p> <div id=\"shipping-summary-user-address-aux\"><\/div> <\/div> <div id=\"shipping-summary-user-address_section-aux\"><\/div> <\/div> <div class=\"user-contact subsection\" id=\"shipping-summary-user-contact_section\"> <h3 class=\"label\">发货通知<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-emailLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"shipping-summary-user-emailAddress\"> <\/span><span id=\"shipping-summary-user-emailLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-notificationLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"mobilePhone\" id=\"shipping-summary-user-mobilePhone\"> <\/span><span id=\"shipping-summary-user-notificationLines-0-ext\"><\/span><\/p> <\/div> <div id=\"shipping-summary-user-contact_section-aux\"><\/div> <\/div> ","id":"shipping-summary-user"},{"value":" <div id=\"payment-form-options-CheckoutBillingPopularPayment\"><\/div> <div id=\"payment-form-options-CheckoutBillingExternalInstallments\"><\/div> <div id=\"payment-form-options-CheckoutBillingLocalBank\"><\/div> <div id=\"payment-form-options-CheckoutBillingExternalOther\"><\/div> <div id=\"payment-form-options-payOnDelivery\"><\/div> <div class=\"ptm\" id=\"payment-step-defaults\"><\/div> ","id":"payment-form-options"},{"value":" <div id=\"payment-onDelivery-options\" class=\"payment-additional-options clearfix\"> <fieldset aria-labelledby=\"\" tabindex=\"\" role=\"\" id=\"cash-option\"> <legend> <strong>货到付款<\/strong> <\/legend> <div> <div class=\"options-list\"> 货到付款服务目前由于以下原因无法使用： <ul> <li> <span>以下商品不符合货到付款的条件： iPhone 8 Plus 256GB 金色<\/span><br/> <\/li> <\/ul> <\/div> <\/div> <\/fieldset> <\/div> ","id":"payment-form-options-payOnDelivery"},{"value":" <div id=\"payment-installments-options\" class=\"payment-additional-options clearfix\"> <fieldset aria-labelledby=\"\" tabindex=\"\" role=\"\"> <legend class=\"compare-installment-legend\"> <strong>分期付款<\/strong> <\/legend> <div class=\"clearfix\"> <div class=\"payment-compare-installments\" id=\"payment-form-options-installments-content-comparison\"><\/div> <\/div> <div class=\"options-list\"> <span class=\"card-option\"> <input class=\"row1 left inst-bank-option\" id=\"payment-form-options-0000791680-1\" type=\"radio\" value=\"0000791680\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-0000791680-1\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CMB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=4PskD0\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=4PskD0\" /> <span class=\"a11y\"> 招商银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row1 middle-1 inst-bank-option\" id=\"payment-form-options-0000833448-2\" type=\"radio\" value=\"0000833448\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-0000833448-2\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-ICBC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=LVUjn3\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=LVUjn3\" /> <span class=\"a11y\"> 工商银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row1 middle-2 inst-bank-option\" id=\"payment-form-options-0000882241-3\" type=\"radio\" value=\"0000882241\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-0000882241-3\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-ABC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=dqwj72\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=dqwj72\" /> <span class=\"a11y\"> 中国农业银行 <\/span> <\/label> <\/span> <div class=\"popup-wdgt\" id=\"payment-form-options-installments-content\"><\/div> <\/div> <\/fieldset> <\/div> ","id":"payment-form-options-CheckoutBillingExternalInstallments"},{"value":"","id":"installment-learn-more-link"},{"value":" <div id=\"payment-bank-phone-options\" class=\"payment-additional-options clearfix\"> <fieldset aria-labelledby=\"\" tabindex=\"\" role=\"\" id=\"phonepay-option\"> <legend><strong> 网上支付 &mdash; 本地信用卡/借记卡<br /><a href=\"http://www.beijing.com.cn/news.do?mid=402880191c30afb9011c31015efc0005\" target=\"_blank\"><b>请点击此链接查询各银行卡支付限额规定<\/b><\/a> <\/strong><\/legend> <div> <div class=\"options-list\"> <span class=\"card-option\"> <input class=\"row1 left\" id=\"payment-form-options-3-1\" type=\"radio\" value=\"3\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-3-1\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CMB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=4PskD0\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=4PskD0\" /> <span class=\"a11y\"> 中国招商银行 (一网通) <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row1 middle-1\" id=\"payment-form-options-0000833266-2\" type=\"radio\" value=\"0000833266\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-0000833266-2\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-ICBC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=LVUjn3\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=LVUjn3\" /> <span class=\"a11y\"> 中国工商银行 (ICBC) <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row1 middle-2\" id=\"payment-form-options-43-3\" type=\"radio\" value=\"43\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-43-3\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-ABC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=dqwj72\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=dqwj72\" /> <span class=\"a11y\"> 中国农业银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row1\" id=\"payment-form-options-4-4\" type=\"radio\" value=\"4\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-4-4\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CCB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=PMGj_3\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=PMGj_3\" /> <span class=\"a11y\"> 中国建设银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row1 right\" id=\"payment-form-options-69-5\" type=\"radio\" value=\"69\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-69-5\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-SPDB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=UKEkj2\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=UKEkj2\" /> <span class=\"a11y\"> 上海浦东发展银行 <\/span> <\/label> <\/span> <div class=\"popup-wdgt bankPhoneRow\" id=\"bank-phone-1-content\" style=\"display: none;\"><\/div> <div class=\"popup-wdgt bankOnlineRow\" id=\"bank-phone-msg-1-content\" style=\"display: none;\"><\/div> <span class=\"card-option\"> <input class=\"row2 left\" id=\"payment-form-options-67-6\" type=\"radio\" value=\"67\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-67-6\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-BOC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=KRjk70\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=KRjk70\" /> <span class=\"a11y\"> 交通银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row2 middle-1\" id=\"payment-form-options-50-7\" type=\"radio\" value=\"50\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-50-7\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-BOB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=9G_jH3\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=9G_jH3\" /> <span class=\"a11y\"> 北京银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row2 middle-2\" id=\"payment-form-options-85-8\" type=\"radio\" value=\"85\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-85-8\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-BOF?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=VPhkt1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=VPhkt1\" /> <span class=\"a11y\"> 中国银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row2\" id=\"payment-form-options-44-9\" type=\"radio\" value=\"44\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-44-9\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-GDB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=KQ-j93\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=KQ-j93\" /> <span class=\"a11y\"> 广东发展银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row2 right\" id=\"payment-form-options-40-10\" type=\"radio\" value=\"40\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-40-10\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-SDB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=6__kp2\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=6__kp2\" /> <span class=\"a11y\"> 深圳发展银行 <\/span> <\/label> <\/span> <div class=\"popup-wdgt bankPhoneRow\" id=\"bank-phone-2-content\" style=\"display: none;\"><\/div> <div class=\"popup-wdgt bankOnlineRow\" id=\"bank-phone-msg-2-content\" style=\"display: none;\"><\/div> <div id='show-more-bank-content' style='display:none' class='show-more-bank-content-class'> <span class=\"card-option\"> <input class=\"row3 left\" id=\"payment-form-options-33-11\" type=\"radio\" value=\"33\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-33-11\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-IBC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=BSrkD2\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=BSrkD2\" /> <span class=\"a11y\"> 兴业银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row3 middle-1\" id=\"payment-form-options-74-12\" type=\"radio\" value=\"74\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-74-12\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CEB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=6ZzkT1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=6ZzkT1\" /> <span class=\"a11y\"> 中国光大银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row3 middle-2\" id=\"payment-form-options-83-13\" type=\"radio\" value=\"83\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-83-13\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CBB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=ZKxjT1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=ZKxjT1\" /> <span class=\"a11y\"> 中国渤海银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row3\" id=\"payment-form-options-28-14\" type=\"radio\" value=\"28\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-28-14\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-MSB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=85nk_1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=85nk_1\" /> <span class=\"a11y\"> 民生银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row3 right\" id=\"payment-form-options-59-15\" type=\"radio\" value=\"59\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-59-15\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CP?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=Mx_j51\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=Mx_j51\" /> <span class=\"a11y\"> 中国邮政 <\/span> <\/label> <\/span> <div class=\"popup-wdgt bankPhoneRow\" id=\"bank-phone-3-content\" style=\"display: none;\"><\/div> <div class=\"popup-wdgt bankOnlineRow\" id=\"bank-phone-msg-3-content\" style=\"display: none;\"><\/div> <span class=\"card-option\"> <input class=\"row4 left\" id=\"payment-form-options-84-16\" type=\"radio\" value=\"84\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-84-16\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-CCITICB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=QAUkD1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=QAUkD1\" /> <span class=\"a11y\"> 中信银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row4 middle-1\" id=\"payment-form-options-14-17\" type=\"radio\" value=\"14\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-14-17\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-SPAB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=Nsekz0\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=Nsekz0\" /> <span class=\"a11y\"> 深圳平安银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row4 middle-2\" id=\"payment-form-options-16-18\" type=\"radio\" value=\"16\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-16-18\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-SHRCB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=g0dkb1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=g0dkb1\" /> <span class=\"a11y\"> 上海农村商业银行 (银联支付, 如意卡) <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row4\" id=\"payment-form-options-75-19\" type=\"radio\" value=\"75\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-75-19\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-BRCB?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=54Wkf0\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=54Wkf0\" /> <span class=\"a11y\"> 北京农村商业银行 <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"row4 right\" id=\"payment-form-options-121-20\" type=\"radio\" value=\"121\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-121-20\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-BOS?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1469072325723\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1469072325723\" /> <span class=\"a11y\"> 上海银行 <\/span> <\/label> <\/span> <div class=\"popup-wdgt bankPhoneRow\" id=\"bank-phone-4-content\" style=\"display: none;\"><\/div> <div class=\"popup-wdgt bankOnlineRow\" id=\"bank-phone-msg-4-content\" style=\"display: none;\"><\/div> <\/div> <button name=\"show-more-banks\" id=\"show-more-banks\" class=\"show-more-banks-class\">显示更多银行<\/button> <div id=\"bank-phone-content\" class=\"popup-wdgt\"><\/div> <div id=\"bank-phone-msg-content\" class=\"popup-wdgt\"><\/div> <\/div> <\/div> <\/fieldset> <\/div> ","id":"payment-form-options-CheckoutBillingLocalBank"},{"value":" <div style=\"display: none;\" class=\"bank-phone\"> <span class=\"beak\"><\/span> <div class=\"wdgt-mdl\"> <div class=\"wdgt-left\"> <div> <div id=\"payment-localbank-options\" class=\"clearfix\"> <fieldset> <legend> <span class=\"a11y\">银行帐户类型<\/span> <\/legend> <div class=\"options-list\"> <span class=\"card-option\"> <input id=\"payment-localbank-options-1\" type=\"radio\" value=\"ONLINE\" name=\"payment-form-options-localBank\" /> <label for=\"payment-localbank-options-1\">在线付款<\/label> <\/span> <span class=\"card-option\"> <input id=\"payment-localbank-options-2\" type=\"radio\" value=\"PHONE\" name=\"payment-form-options-localBank\" /> <label for=\"payment-localbank-options-2\">电话付款<\/label> <\/span> <\/div> <\/fieldset> <\/div> <\/div> <\/div> <\/div> <div id=\"payment-localbank-options-content\" class=\"popup-wdgt showPhonePay\"> <div class=\"wdgt-mdl payment-phonePay-parent\"> <div class=\"wdgt-left\"> <div> <div class=\"payment-phonePay\" id=\"payment-form-phonePay\"><\/div> <\/div> <\/div> <\/div> <\/div> <\/div> ","id":"bank-phone-content"},{"value":" <div class=\"user-form-block\"> <fieldset> <div class=\"fieldset-content\"> <p> <span class=\"accountHolderName-field field-with-placeholder\"> <label for=\"payment-form-phonePay-accountHolderName\" class=\"placeholder\"> <span>顾客帐户持有人姓名<\/span> <\/label> <input name=\"payment-form-phonePay-accountHolderName\" type=\"text\" maxlength=\"20\" id=\"payment-form-phonePay-accountHolderName\" /> <\/span> <\/p> <p> <span class=\"bankCardNumber-field field-with-placeholder\"> <label for=\"payment-form-phonePay-bankCardNumber\" class=\"placeholder\"> <span>银行卡号<\/span> <\/label> <input name=\"payment-form-phonePay-bankCardNumber\" type=\"text\" maxlength=\"19\" id=\"payment-form-phonePay-bankCardNumber\" /> <\/span> <\/p> <p> <span class=\"mobilePhoneNumber-field field-with-placeholder\"> <label for=\"payment-form-phonePay-mobilePhoneNumber\" class=\"placeholder\"> <span>银行登记电话(招商银行)或手机号码(招商银行和其他银行)<\/span> <\/label> <input name=\"payment-form-phonePay-mobilePhoneNumber\" type=\"text\" maxlength=\"11\" id=\"payment-form-phonePay-mobilePhoneNumber\" /> <\/span> <\/p> <p> <span class=\"customerIdCardNumber-field field-with-placeholder\"> <label for=\"payment-form-phonePay-customerIdCardNumber\" class=\"placeholder\"> <span>身份证号<\/span> <\/label> <input name=\"payment-form-phonePay-customerIdCardNumber\" type=\"text\" maxlength=\"20\" id=\"payment-form-phonePay-customerIdCardNumber\" /> <\/span> <\/p> <p style=\"width:300px;\"> 请注意:<br/> <ol class=\"ol\"> <li>完成订单后的 5 分钟之内，您将会接获一通电话而您所提供的电话号码必须是您注册银行帐户时登记的号码。<\/li> <li>如果您是使用中国招商银行付款，并尚未启用电话支付服务，请立即致电 95555 启用这项服务。其他银行将无需启用电话支付服务，也无需开通网上银行，但支付使用的手机号码必须是您开卡时登记的手机号码。<\/li> <li>中国银行和中国民生银行，只接受信用卡。<\/li> <li>在支付交易的过程中，您将需要银行卡号和银行卡的密码。<\/li> <li>有关如何使用电话支付的更多信息，<a href=\"http://store.apple.com/cn/help/payments\" target=\"_blank\">请点按此处<\/a> 。<\/li> <\/ol> <\/p> <\/div> <\/fieldset> <\/div> ","id":"payment-form-phonePay"},{"value":" <div id=\"payment-other-options\" class=\"payment-additional-options clearfix\"> <fieldset aria-labelledby=\"\" tabindex=\"\" role=\"\" id=\"cash-option\"> <legend> <strong> 其他付款类型 <\/strong> <\/legend> <div> <div class=\"options-list\"> <span class=\"card-option\"> <input class=\"card-type\" id=\"payment-form-options-38-0\" type=\"radio\" value=\"38\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-38-0\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-VISA?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=5OukX1\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=5OukX1\" /> <span class=\"a11y\"> Visa <\/span> <\/label> <\/span> <span class=\"card-option\"> <input class=\"card-type\" id=\"payment-form-options-18-0\" type=\"radio\" value=\"18\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-18-0\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-MC?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=QEvkD3\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=QEvkD3\" /> <span class=\"a11y\"> MasterCard <\/span> <\/label> <\/span> <\/div> <div id=\"international-credit-cards-content\" class=\"popup-wdgt\"> <span class=\"beak\"><\/span> <div class=\"international-card\"> <div class=\"wdgt-left\"> <div class=\"gs grid-1of2 ptl\" id=\"payment-form-countrySelector\"><\/div> <\/div> <\/div> <\/div> <\/div> <\/fieldset> <\/div> ","id":"payment-form-options-CheckoutBillingExternalOther"},{"value":" <div class=\"user-form-block\"> <fieldset class=\"CN first\"> <div class=\"fieldset-content\"> <div class=\"mbs\"> <span class=\"cardNumber-field field-with-placeholder\"> <label for=\"payment-form-creditCardPay-cardNumber\" class=\"placeholder\"> <span> 信用卡号 <\/span> <\/label> <input type=\"text\" class=\"kp-num\" id=\"payment-form-creditCardPay-cardNumber\" /> <\/span> <div class=\"security-code\"> <span class=\"securityCode-field field-with-placeholder\"> <label for=\"payment-form-creditCardPay-security-code\" class=\"placeholder\"> <span> 安全代码 <\/span> <\/label> <input type=\"text\" class=\"kp-num\" id=\"payment-form-creditCardPay-security-code\" /> <\/span> <div rel=\"security-code-help\" class=\"whats-this right bottom\"> <span class=\"toggle\">这是什么？<\/span> <div class=\"info\"> <h3>何处可以找到您的安全代码<\/h3> <h4 class=\"cvv_card visa\">维萨/万事达卡/Discover 卡<\/h4><span class=\"a11y\">对于 American Express 卡，安全代码是卡片正面上的最后四位数字。该代码独立于实际的信用卡号码。<\/span> <h5 class=\"cvv_card amex\">美国运通卡<\/h5><span class=\"a11y\">对于 Visa、Mastercard 或 Discover 卡，安全代码位于卡片的背面。卡片背面编号的最后三位数字就是该代码，通常位于签名栏的右侧。<\/span> <\/div> <\/div> <\/div> <\/div> <p class=\"optional-multicol clearfix\"> <span class=\"first\"> <span class=\"label\"> 到期日期 <\/span> <span class=\"expirationMonth-field\"> <label for=\"payment-form-creditCardPay-expirationMonth\" class=\"a11y\">信用卡到期月份<\/label> <select id=\"payment-form-creditCardPay-expirationMonth\" name=\"payment-form-creditCardPay-expirationMonth\"><option value=\"WONoSelectionString\">月<\/option> <option value=\"01\">01<\/option> <option value=\"02\">02<\/option> <option value=\"03\">03<\/option> <option value=\"04\">04<\/option> <option value=\"05\">05<\/option> <option value=\"06\">06<\/option> <option value=\"07\">07<\/option> <option value=\"08\">08<\/option> <option value=\"09\">09<\/option> <option value=\"10\">10<\/option> <option value=\"11\">11<\/option> <option value=\"12\">12<\/option><\/select> <\/span> <span class=\"expirationYear-field\"> <label for=\"payment-form-creditCardPay-expirationYear\" class=\"a11y\">信用卡到期年份<\/label> <select id=\"payment-form-creditCardPay-expirationYear\" name=\"payment-form-creditCardPay-expirationYear\"><option value=\"WONoSelectionString\">年<\/option> <option value=\"2017\">2017<\/option> <option value=\"2018\">2018<\/option> <option value=\"2019\">2019<\/option> <option value=\"2020\">2020<\/option> <option value=\"2021\">2021<\/option> <option value=\"2022\">2022<\/option> <option value=\"2023\">2023<\/option> <option value=\"2024\">2024<\/option> <option value=\"2025\">2025<\/option> <option value=\"2026\">2026<\/option> <option value=\"2027\">2027<\/option> <option value=\"2028\">2028<\/option> <option value=\"2029\">2029<\/option> <option value=\"2030\">2030<\/option> <option value=\"2031\">2031<\/option> <option value=\"2032\">2032<\/option> <option value=\"2033\">2033<\/option> <option value=\"2034\">2034<\/option> <option value=\"2035\">2035<\/option> <option value=\"2036\">2036<\/option> <option value=\"2037\">2037<\/option><\/select> <\/span> <\/span> <\/p> <\/div> <\/fieldset> <\/div> ","id":"payment-form-creditCardPay"},{"value":" <div class=\"user-form-block countrySelector\" id=\"credit-card-country-details\"> <fieldset class=\"CN first user-form-fieldset\"> <legend> <strong> <span id=\"country-selector\">信用卡帐单地址所在的国家/地区<\/span> <\/strong> <\/legend> <div class=\"fieldset-content\"> <p class=\"optional-multicol\"> <span class=\"country-field\"> <select id=\"payment-form-countrySelector-countryCode\" name=\"payment-form-countrySelector-countryCode\"><option value=\"WONoSelectionString\">选择信用卡帐单地址所在的国家/地区<\/option> <option value=\"CN\">中国<\/option> <option value=\"CA\">加拿大<\/option> <option value=\"SG\">新加坡<\/option> <option value=\"US\">美国<\/option> <option value=\"GB\">英国<\/option> <option value=\"HK\">香港<\/option> <option value=\"MY\">马来西亚<\/option><\/select> <\/span> <\/p> <\/div> <\/fieldset> <\/div> ","id":"payment-form-countrySelector"},{"value":" <div id=\"payment-popular-options\" class=\"payment-additional-options clearfix\"> <fieldset aria-labelledby=\"\" tabindex=\"\" role=\"\" id=\"cash-option\"> <legend id=\"a1r4\"> <strong>常用付款类型<\/strong> <\/legend> <div> <div class=\"options-list\"> <span class=\"card-option\"> <input id=\"payment-form-options-Alipay-0\" type=\"radio\" value=\"Alipay\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-Alipay-0\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-Alipay?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=rSkkD2\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=rSkkD2\" /> <span class=\"a11y\"> <\/span> <\/label> <\/span> <span class=\"card-option\"> <input aria-describedby=\"wechat-instr-content\" id=\"payment-form-options-WeChat-0\" type=\"radio\" value=\"WeChat\" name=\"payment-form-options-bankOption\" /> <label for=\"payment-form-options-WeChat-0\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-WeChat?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" alt=\"\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" /> <span class=\"a11y\"> <\/span> <\/label> <\/span> <\/div> <\/div> <\/fieldset> <\/div> ","id":"payment-form-options-CheckoutBillingPopularPayment"}]},"url":"/cn/shop/checkoutx"}}
		 */
	},
	fillBill: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: context => ({
			sessionID:context.session.sessionID,
			bankOption:'WeChat',
			_a:'bill.cont',
			_fid:'co'
		}),
		parser: JSON.parse

		/**
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"summary":{"total":"RMB 15,976","show-tax-inclusive-prices":true,"totalnoship":"RMB 15,975","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 15,976","cart-subtotal-enabled":false,"placeOrderTerms":"","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}}},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 发货： 我们收到付款后就会与你确认日期。 <\/span> <span> - 免费 <\/span> <\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"summary","_actions":{"edit":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.edit&_fid=co&_m=cart","validate":false}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"perform":"action","omniture":"omniture.Edit ButtonDelivery","event":"click","target":"cart._actions.edit"},{"perform":"focus","event":"click","target":"delivery-box"}],"id":"edit-deliveryandpickup-link"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=bill.edit&_fid=co","validate":false}},"_forms":{"main":{"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonPayment","event":"click","target":"billing._actions.edit"},{"perform":"focus","event":"click","target":"payment-box"}],"id":"payment-edit-button"}],"events":[{"event":"load","omniture":"omniture.continuePayment | WECHAT | EXTERNAL_PAYMENT"}]}},"editable":true,"enabled":true},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":175173,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"Bank:Van Lanschot BankiersPaymentIdeal":{"microEvent":[{"action":"Bank:Van Lanschot Bankiers","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"smsNotificationSelectedShipping":{"microEvent":[{"action":"smsNotificationSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:RabobankPaymentIdeal":{"microEvent":[{"action":"Bank:Rabobank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Regio BankPaymentIdeal":{"microEvent":[{"action":"Bank:Regio Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:KnabPaymentIdeal":{"microEvent":[{"action":"Bank:Knab","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Business address uncheckedShipping":{"microEvent":[{"action":"Business address unchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editPayment":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Primary Pickup SMSShipping":{"microEvent":[{"action":"Primary Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Edit ButtonShipping":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Invoice"}},"editShippingCallToActionInvoice":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Invoice","eVar":"eVar21"}]},"smsSelectedShipping":{"microEvent":[{"action":"smsSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Business address checkedShipping":{"microEvent":[{"action":"Business address checked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"Edit ButtonPayment":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"3rd Party Pickup SMSShipping":{"microEvent":[{"action":"3rd Party Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"Bank:ABN AMRO BankPaymentIdeal":{"microEvent":[{"action":"Bank:ABN AMRO Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"SMS Notification not selectedShipping":{"microEvent":[{"action":"SMS Notification not selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:INGPaymentIdeal":{"microEvent":[{"action":"Bank:ING","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:SNS BankPaymentIdeal":{"microEvent":[{"action":"Bank:SNS Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"continueInvoice":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"businessAddressUncheckedShipping":{"microEvent":[{"action":"businessAddressUnchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editDelivery":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Bank:ASN BankPaymentIdeal":{"microEvent":[{"action":"Bank:ASN Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Edit ButtonDelivery":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"scrollToShippingCallToActionInvoice":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Invoice","eVar":"eVar21"}]},"vatSpecialInvoice":{"microEvent":[{"action":"vatSpecial","slot":"AOS: Checkout","feature":"Invoice","eVar":"eVar21"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"businessAddressCheckedShipping":{"microEvent":[{"action":"businessAddressChecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"Bank:Triodos BankPaymentIdeal":{"microEvent":[{"action":"Bank:Triodos Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Friesland BankPaymentIdeal":{"microEvent":[{"action":"Bank:Friesland Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"continuePayment | WECHAT | EXTERNAL_PAYMENT":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Payment | WECHAT | EXTERNAL_PAYMENT","eVar":"prop37"}]},"Bank:Bunq BankPaymentIdeal":{"microEvent":[{"action":"Bank:Bunq Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"SMS Notification selectedShipping":{"microEvent":[{"action":"SMS Notification selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"editShipping":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"vatPersonalInvoice":{"microEvent":[{"action":"vatPersonal","slot":"AOS: Checkout","feature":"Invoice","eVar":"eVar21"}]},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}},"vatStandardInvoice":{"microEvent":[{"action":"vatStandard","slot":"AOS: Checkout","feature":"Invoice","eVar":"eVar21"}]}},"common":{"_actions":{"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"},{"name":"overrideFormat"}],"subForms":["cart._forms.main","shipping._forms.main","billing._forms.main","invoice._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 西城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=ship.edit&_fid=co","validate":false}},"address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","mobilePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"title":true,"_forms":{"shippingAddressForm":{"views":[{"key":"shipping.address.lastName","id":"shipping-summary-user-lastName"},{"key":"shipping.address.firstName","id":"shipping-summary-user-firstName"},{"key":"shipping.address.daytimePhoneAreaCode","id":"shipping-summary-user-daytimePhoneAreaCode"},{"key":"shipping.address.daytimePhone","id":"shipping-summary-user-daytimePhone"},{"key":"shipping.address.state","id":"shipping-summary-user-state"},{"key":"shipping.address.city","id":"shipping-summary-user-city"},{"key":"shipping.address.district","id":"shipping-summary-user-district"},{"key":"shipping.address.street","id":"shipping-summary-user-street"},{"key":"shipping.address.street2","id":"shipping-summary-user-street2"},{"key":"shipping.address.postalCode","id":"shipping-summary-user-postalCode"},{"key":"shipping.address.country","id":"shipping-summary-user-country"},{"key":"shipping.address.emailAddress","id":"shipping-summary-user-emailAddress"},{"key":"shipping.address.mobilePhone","id":"shipping-summary-user-mobilePhone"}]},"main":{"subForms":["shipping._forms.shippingAddressForm"],"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonShipping","event":"click","target":"shipping._actions.edit"},{"perform":"focus","event":"click","target":"shipping-box"}],"id":"shipping-edit-button"}]}},"enabled":true},"terms":{"mode":"blank","editable":true,"enabled":true},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":2,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item first product-price\"> <span class=\"a11y\">物品价格：<\/span> RMB 7,988 <\/li> <li class=\"item phl quantity-select\"> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity\"><\/span> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 15,976<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"edit","_actions":{"continue":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=invoice.cont&_fid=co"}},"editable":true,"fapiao":{"_actions":{"invoiceType":{"form":"invoice._forms.invoiceOptionsForm","url":"/cn/shop/checkoutx/invoice?_a=invoice.change&_fid=co","validate":false}},"selection":"none","invoiceEmailAddress":{"country":"中国","emailAddress":"liuyunwei@yanxiu.com","countryCode":"CN"}},"_forms":{"invoiceOptionsForm":{"fields":[{"name":"invoice-form-options-selection","id":"invoice-form-options","type":"radio","key":"invoice.fapiao.selection","_events":[{"perform":"action","event":"change","target":"invoice.fapiao._actions.invoiceType"}]}]},"main":{"subForms":["invoice._forms.invoiceEmailAddressForm","invoice._forms.invoiceOptionsForm","invoice._forms.document"]},"invoiceEmailAddressForm":{"fields":[{"name":"invoice-user-invoiceEmailAddress-emailAddress","id":"invoice-user-invoiceEmailAddress-emailAddress","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":35,"maxSize":64,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"invoice.fapiao.invoiceEmailAddress.emailAddress"}],"views":[{"id":"invoice-user-invoiceEmailAddress-contact_section"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"}]}},"enabled":true,"_events":[{"perform":"focus","omniture":"omniture.metricEvent","event":"load","target":"invoice-form-options-appleStandard"}]},"account":{"mode":"blank","editable":true,"enabled":true}},"update":{"htmls":[{"value":" <div class=\"user-address subsection\" id=\"shipping-summary-user-address_section\"> <h3 class=\"label\">送货地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"shipping-summary-user-lastName\"> <\/span> <span class=\"firstName\" id=\"shipping-summary-user-firstName\"> <\/span> <span id=\"shipping-summary-user-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-contactLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"shipping-summary-user-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"shipping-summary-user-daytimePhone\"> <\/span><span id=\"shipping-summary-user-contactLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-0-prf\"><\/span><span class=\"state\" id=\"shipping-summary-user-state\"> <\/span> <span class=\"city\" id=\"shipping-summary-user-city\"> <\/span> <span class=\"district\" id=\"shipping-summary-user-district\"> <\/span> <span id=\"shipping-summary-user-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-1-prf\"><\/span><span class=\"street\" id=\"shipping-summary-user-street\"> <\/span><span id=\"shipping-summary-user-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-2-prf\"><\/span><span class=\"street2\" id=\"shipping-summary-user-street2\"> <\/span><span id=\"shipping-summary-user-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-3-prf\"><\/span><span class=\"postalCode\" id=\"shipping-summary-user-postalCode\"> <\/span> <span id=\"shipping-summary-user-addressLines-3-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"shipping-summary-user-country\"><\/span><\/span> <\/p> <div id=\"shipping-summary-user-address-aux\"><\/div> <\/div> <div id=\"shipping-summary-user-address_section-aux\"><\/div> <\/div> <div class=\"user-contact subsection\" id=\"shipping-summary-user-contact_section\"> <h3 class=\"label\">发货通知<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-emailLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"shipping-summary-user-emailAddress\"> <\/span><span id=\"shipping-summary-user-emailLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-notificationLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"mobilePhone\" id=\"shipping-summary-user-mobilePhone\"> <\/span><span id=\"shipping-summary-user-notificationLines-0-ext\"><\/span><\/p> <\/div> <div id=\"shipping-summary-user-contact_section-aux\"><\/div> <\/div> ","id":"shipping-summary-user"},{"value":" <legend><strong>付款方式<\/strong><\/legend> <p><span> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-WeChat?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" alt=\"微信支付\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" /> <\/span><\/p> ","id":"payment-summary-method"},{"value":"","id":"installment-learn-more-link"},{"value":"","id":"payment-summary-user"},{"value":" <div id=\"invoice-form-options\" class=\"options-list\"> <div class=\"invoice-option mrl\"> <input id=\"invoice-form-options-appleStandard\" type=\"radio\" value=\"none\" name=\"invoice-form-options\" checked=\"checked\" /> <label for=\"invoice-form-options-appleStandard\" class=\"pls\"> <strong>Apple 电子收据<\/strong> <\/label> <p class=\"pts prl\">Apple 电子收据 这是您本次购买商品的 Apple 电子收据。本收据将于您的订单发货后发送到您订单上的电子邮件地址或 iMessage 电话号码。此收据可视为购买的正式凭证，可用于商品保修和维修等申请。<br/>注意：如果您需要其它类型发票，请在下面选择。<br/><br/> 如果您的公司具备\u201c一般纳税人资格\u201d，可以进行增值税进项抵扣，您将需要增值税专用发票。<\/p> <\/div> <div class=\"invoice-option mrl\"> <input id=\"invoice-form-options-faPiaoPersonal\" type=\"radio\" value=\"personal\" name=\"invoice-form-options\" /> <label for=\"invoice-form-options-faPiaoPersonal\" class=\"pls\"> <strong>Apple 电子收据与普通发票<\/strong> <\/label> <p class=\"pts prl\">普通发票 （个人，公司）：发票不随货物一起寄送，在订单发货后的 3 个工作日内，发票将通过EMS快递服务寄出。...<\/p> <\/div> <div class=\"invoice-option mrl\"> <label for=\"invoice-form-options-vatSpecial\" class=\"pls\"> <strong>Apple 电子收据与增值税专用发票 <\/strong> <\/label> <p class=\"pts prl\"> 如要索取增值税专用发票，你必须使用 \u201c公司银行转帐\u201d 作为订单支付方式。如需了解更多，请进行在线交流。 <\/p> <\/div> <div class=\"invoice-option mrl\"> <\/div> <\/div> ","id":"invoice-options"},{"value":" <div id=\"invoice-user-invoiceEmailAddress\"><\/div> <fieldset class=\"CN first user-form-fieldset\"> <legend class=\"label\">电子邮件地址 <\/legend> <div class=\"user-contact fieldset-content\" id=\"invoice-user-invoiceEmailAddress-contact_section\"> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceEmailAddress-contactLines-0-prf\"><\/span> <span class=\"emailAddress-field field-with-placeholder\"> <label for=\"invoice-user-invoiceEmailAddress-emailAddress\" class=\"placeholder\"> <span>电子邮件地址<\/span> <\/label> <input name=\"invoice-user-invoiceEmailAddress-emailAddress\" type=\"text\" size=\"35\" maxlength=\"64\" class=\"kp-email\" id=\"invoice-user-invoiceEmailAddress-emailAddress\" /> <\/span> <div rel=\"whats-this-email\" class=\"whats-this right bottom\"> <span class=\"toggle\">这是什么？<\/span> <div class=\"info\">您的 Apple 发票将发送至此电子邮件地址<\/div> <\/div> <\/div> <\/div> <\/fieldset> ","id":"invoice-details"},{"value":" ","id":"invoice-user"}]},"url":"/cn/shop/checkoutx"}}
		 */
	},
	/**
	 * this step maybe useless
	 * 
	 */
	fillInvoiceType: {
		url: context =>`${context.session.checkoutUrl}x/invoice`,
		method: "post",
		params: {
			'invoice-form-options-selection':'personal',
			_a:'invoice.change',
			_fid:'co'
		},
		parser: JSON.parse

		/**
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"omniture":{"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Invoice"}},"vatPersonalInvoice":{"microEvent":[{"action":"vatPersonal","slot":"AOS: Checkout","feature":"Invoice","eVar":"eVar21"}]},"vatSpecialInvoice":{"microEvent":[{"action":"vatSpecial","slot":"AOS: Checkout","feature":"Invoice","eVar":"eVar21"}]},"continueInvoice":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"vatStandardInvoice":{"microEvent":[{"action":"vatStandard","slot":"AOS: Checkout","feature":"Invoice","eVar":"eVar21"}]}},"invoice":{"mode":"edit","_actions":{"continue":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=invoice.cont&_fid=co"}},"invoiceDeliveryAddress":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","_actions":{"localityLookup":{"city":{"form":"invoice._forms.localityLookupForm.invoice_delivery.city","url":"/cn/shop/addressx/locality_lookup?_a=locale.lkup&_fid=locale","validate":false},"state":{"form":"invoice._forms.localityLookupForm.invoice_delivery.state","url":"/cn/shop/addressx/locality_lookup?_a=locale.lkup&_fid=locale","validate":false}}},"emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","localityOptions":{"state":[{"value":"","text":"省份"},{"value":"北京","text":"北京"},{"value":"上海","text":"上海"},{"value":"天津","text":"天津"},{"value":"重庆","text":"重庆"},{"value":"安徽","text":"安徽"},{"value":"福建","text":"福建"},{"value":"甘肃","text":"甘肃"},{"value":"广东","text":"广东"},{"value":"广西壮族自治区","text":"广西壮族自治区"},{"value":"贵州","text":"贵州"},{"value":"海南","text":"海南"},{"value":"河北","text":"河北"},{"value":"河南","text":"河南"},{"value":"黑龙江","text":"黑龙江"},{"value":"湖北","text":"湖北"},{"value":"湖南","text":"湖南"},{"value":"吉林","text":"吉林"},{"value":"江苏","text":"江苏"},{"value":"江西","text":"江西"},{"value":"辽宁","text":"辽宁"},{"value":"内蒙古自治区","text":"内蒙古自治区"},{"value":"宁夏回族自治区","text":"宁夏回族自治区"},{"value":"青海","text":"青海"},{"value":"山东","text":"山东"},{"value":"山西","text":"山西"},{"value":"陕西","text":"陕西"},{"value":"四川","text":"四川"},{"value":"西藏自治区","text":"西藏自治区"},{"value":"新疆维吾尔自治区","text":"新疆维吾尔自治区"},{"value":"云南","text":"云南"},{"value":"浙江","text":"浙江"}],"city":[{"value":"","text":"城镇/城市"},{"value":"北京","text":"北京"}],"district":[{"value":"","text":"区"},{"value":"东城区","text":"东城区"},{"value":"西城区","text":"西城区"},{"value":"朝阳区","text":"朝阳区"},{"value":"海淀区","text":"海淀区"},{"value":"丰台区","text":"丰台区"},{"value":"石景山区","text":"石景山区"},{"value":"通州区","text":"通州区"},{"value":"平谷区","text":"平谷区"},{"value":"顺义区","text":"顺义区"},{"value":"怀柔区","text":"怀柔区"},{"value":"密云区","text":"密云区"},{"value":"延庆区","text":"延庆区"},{"value":"昌平区","text":"昌平区"},{"value":"门头沟区","text":"门头沟区"},{"value":"房山区","text":"房山区"},{"value":"大兴区","text":"大兴区"}]},"daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"fapiao":{"invoiceHeader":"个人","_actions":{"invoiceType":{"form":"invoice._forms.invoiceOptionsForm","url":"/cn/shop/checkoutx/invoice?_a=invoice.change&_fid=co","validate":false}},"selection":"personal","taxPayer":"","invoiceEmailAddress":{"country":"中国","emailAddress":"liuyunwei@yanxiu.com","countryCode":"CN"}},"_forms":{"invoiceHeaderForm":{"fields":[{"name":"invoice-fapiao-invoiceHeader","id":"invoice-fapiao-invoiceHeader","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"invoice.fapiao.invoiceHeader"}]},"invoiceDeliveryAddressForm":{"fields":[{"name":"invoice-user-invoiceDeliveryAddress-lastName","id":"invoice-user-invoiceDeliveryAddress-lastName","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":20,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入姓氏。"},"key":"invoice.invoiceDeliveryAddress.lastName"},{"name":"invoice-user-invoiceDeliveryAddress-firstName","id":"invoice-user-invoiceDeliveryAddress-firstName","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":14,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入名字。"},"key":"invoice.invoiceDeliveryAddress.firstName"},{"name":"invoice-user-invoiceDeliveryAddress-daytimePhoneAreaCode","id":"invoice-user-invoiceDeliveryAddress-daytimePhoneAreaCode","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":4,"validRegexes":["^[0-9]{1,4}$"],"maxSize":4,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入电话号码区号。"},"type":"phoneNumber","key":"invoice.invoiceDeliveryAddress.daytimePhoneAreaCode"},{"name":"invoice-user-invoiceDeliveryAddress-daytimePhone","id":"invoice-user-invoiceDeliveryAddress-daytimePhone","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":11,"validRegexes":["^(1[0-9]{10}|[0-9]{7}|[0-9]{8})$"],"maxSize":11,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入电话号码。"},"type":"phoneNumber","key":"invoice.invoiceDeliveryAddress.daytimePhone"},{"name":"invoice-user-invoiceDeliveryAddress-companyName","id":"invoice-user-invoiceDeliveryAddress-companyName","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":17,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请填写此必填字段。"},"key":"invoice.invoiceDeliveryAddress.companyName"},{"resetOnDisable":false,"optionsValueKey":"invoice.invoiceDeliveryAddress.localityOptions.state.value","optionsDisplayKey":"invoice.invoiceDeliveryAddress.localityOptions.state.text","name":"invoice-user-invoiceDeliveryAddress-state","id":"invoice-user-invoiceDeliveryAddress-state","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","validValues":["北京","天津","河北","山西","内蒙古自治区","辽宁","吉林","宁夏回族自治区","上海","浙江","江苏","安徽","福建","江西","山东","河南","湖北","湖南","广西壮族自治区","广东","海南","重庆","四川","贵州","云南","西藏自治区","陕西","甘肃","青海","黑龙江","新疆维吾尔自治区"],"required":true,"requiredError":"请填写此必填字段。"},"type":"localitySelect","optionsKey":"invoice.invoiceDeliveryAddress.localityOptions.state","key":"invoice.invoiceDeliveryAddress.state"},{"resetOnDisable":false,"optionsValueKey":"invoice.invoiceDeliveryAddress.localityOptions.city.value","optionsDisplayKey":"invoice.invoiceDeliveryAddress.localityOptions.city.text","name":"invoice-user-invoiceDeliveryAddress-city","id":"invoice-user-invoiceDeliveryAddress-city","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":30,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"type":"localitySelect","optionsKey":"invoice.invoiceDeliveryAddress.localityOptions.city","key":"invoice.invoiceDeliveryAddress.city"},{"resetOnDisable":false,"optionsValueKey":"invoice.invoiceDeliveryAddress.localityOptions.district.value","optionsDisplayKey":"invoice.invoiceDeliveryAddress.localityOptions.district.text","name":"invoice-user-invoiceDeliveryAddress-district","id":"invoice-user-invoiceDeliveryAddress-district","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"type":"localitySelect","optionsKey":"invoice.invoiceDeliveryAddress.localityOptions.district","key":"invoice.invoiceDeliveryAddress.district"},{"name":"invoice-user-invoiceDeliveryAddress-street","id":"invoice-user-invoiceDeliveryAddress-street","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":20,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请输入街道地址。"},"key":"invoice.invoiceDeliveryAddress.street"},{"name":"invoice-user-invoiceDeliveryAddress-street2","id":"invoice-user-invoiceDeliveryAddress-street2","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":20,"maxSize":35,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请填写此必填字段。"},"key":"invoice.invoiceDeliveryAddress.street2"},{"name":"invoice-user-invoiceDeliveryAddress-postalCode","id":"invoice-user-invoiceDeliveryAddress-postalCode","validations":{"invalidValueError":"此输入无效。请填入3至6位数字。","size":5,"validRegexes":["^[0-9]{3,6}$"],"maxSize":6,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请输入邮政编码。"},"key":"invoice.invoiceDeliveryAddress.postalCode"}],"views":[{"id":"invoice-user-invoiceDeliveryAddress-address_section"},{"key":"invoice.invoiceDeliveryAddress.country","id":"invoice-user-invoiceDeliveryAddress-country"}]},"invoiceEmailAddressForm":{"fields":[{"name":"invoice-user-invoiceEmailAddress-emailAddress","id":"invoice-user-invoiceEmailAddress-emailAddress","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":35,"maxSize":64,"invalidFormatError":"您输入的格式不正确。","required":true,"requiredError":"请填写此必填字段。"},"key":"invoice.fapiao.invoiceEmailAddress.emailAddress"}],"views":[{"id":"invoice-user-invoiceEmailAddress-contact_section"}]},"taxPayerForm":{"fields":[{"name":"invoice-fapiao-taxPayerId","id":"invoice-fapiao-taxPayer","validations":{"invalidValueError":"此输入无效。请检查信息是否正确。","size":10,"validRegexes":["^[0-9a-zA-Z]{15,20}$"],"maxSize":20,"invalidFormatError":"您输入的格式不正确。","required":false,"requiredError":"请填写此必填字段。"},"key":"invoice.fapiao.taxPayer"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"}]},"invoiceOptionsForm":{"fields":[{"name":"invoice-form-options-selection","id":"invoice-form-options","type":"radio","key":"invoice.fapiao.selection","_events":[{"perform":"action","event":"change","target":"invoice.fapiao._actions.invoiceType"}]}]},"main":{"subForms":["invoice._forms.invoiceEmailAddressForm","invoice._forms.invoiceHeaderForm","invoice._forms.taxPayerForm","invoice._forms.invoiceOptionsForm","invoice._forms.document","invoice._forms.invoiceDeliveryAddressForm","invoice._forms.localityLookupForm.invoice_delivery.state","invoice._forms.localityLookupForm.invoice_delivery.city"]},"localityLookupForm":{"invoice_delivery":{"city":{"fields":[{"name":"state","key":"invoice.invoiceDeliveryAddress.state"},{"name":"city","key":"invoice.invoiceDeliveryAddress.city"},{"name":"keyPath","value":"invoice.invoiceDeliveryAddress"}]},"state":{"fields":[{"name":"state","key":"invoice.invoiceDeliveryAddress.state"},{"name":"keyPath","value":"invoice.invoiceDeliveryAddress"}]}}}},"enabled":true,"_events":[{"perform":"action","event":"change","key":"invoice.invoiceDeliveryAddress.state","target":"invoice.invoiceDeliveryAddress._actions.localityLookup.state"},{"perform":"action","event":"change","key":"invoice.invoiceDeliveryAddress.city","target":"invoice.invoiceDeliveryAddress._actions.localityLookup.city"},{"perform":"focus","omniture":"omniture.metricEvent","event":"load","target":"invoice-form-options-faPiaoPersonal"}]},"common":{"_forms":{"document":{"subForms":["invoice._forms.main"]}}}},"update":{"htmls":[{"value":" <div id=\"invoice-form-options\" class=\"options-list\"> <div class=\"invoice-option mrl\"> <input id=\"invoice-form-options-appleStandard\" type=\"radio\" value=\"none\" name=\"invoice-form-options\" /> <label for=\"invoice-form-options-appleStandard\" class=\"pls\"> <strong>Apple 电子收据<\/strong> <\/label> <p class=\"pts prl\">Apple 电子收据 可以用于保修。本收据将于你的订单发货后发送到你订单的电子邮件地址或 iMessage 电话号码。\u2026<\/p> <\/div> <div class=\"invoice-option mrl\"> <input id=\"invoice-form-options-faPiaoPersonal\" type=\"radio\" value=\"personal\" name=\"invoice-form-options\" checked=\"checked\" /> <label for=\"invoice-form-options-faPiaoPersonal\" class=\"pls\"> <strong>Apple 电子收据与普通发票<\/strong> <\/label> <p class=\"pts prl\">普通发票 （个人，公司）：发票不随货物一起寄送，通常在订单发货后的 3 个工作日内，发票将通过EMS快递服务寄出。<br/><br/>发票抬头 ： 你可以填写\u201c个人\u201d， 你的姓名或单位名称。<br/><br/> 纳税人识别号 ：个人抬头无需填写， 单位抬头请与贵单位财务部门确认后填写。<\/p> <\/div> <div class=\"invoice-option mrl\"> <label for=\"invoice-form-options-vatSpecial\" class=\"pls\"> <strong>Apple 电子收据与增值税专用发票 <\/strong> <\/label> <p class=\"pts prl\"> 如要索取增值税专用发票，你必须使用 \u201c公司银行转帐\u201d 作为订单支付方式。如需了解更多，请进行在线交流。 <\/p> <\/div> <div class=\"invoice-option mrl\"> <\/div> <\/div> ","id":"invoice-options"},{"value":" <div id=\"invoice-user-invoiceEmailAddress\"><\/div> <fieldset class=\"CN first user-form-fieldset\"> <legend class=\"label\">电子邮件地址 <\/legend> <div class=\"user-contact fieldset-content\" id=\"invoice-user-invoiceEmailAddress-contact_section\"> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceEmailAddress-contactLines-0-prf\"><\/span> <span class=\"emailAddress-field field-with-placeholder\"> <label for=\"invoice-user-invoiceEmailAddress-emailAddress\" class=\"placeholder\"> <span>电子邮件地址<\/span> <\/label> <input name=\"invoice-user-invoiceEmailAddress-emailAddress\" type=\"text\" size=\"35\" maxlength=\"64\" class=\"kp-email\" id=\"invoice-user-invoiceEmailAddress-emailAddress\" /> <\/span> <div rel=\"whats-this-email\" class=\"whats-this right bottom\"> <span class=\"toggle\">这是什么？<\/span> <div class=\"info\">您的 Apple 发票将发送至此电子邮件地址<\/div> <\/div> <\/div> <\/div> <\/fieldset> <fieldset class=\"CN\"> <legend><strong> <span>发票抬头<\/span> <\/strong><\/legend> <div class=\"fieldset-content\"> <div class=\"mbs\"> <span class=\"invoiceHeader-field field-with-placeholder\"> <label for=\"invoice-fapiao-invoiceHeader\" class=\"placeholder\"> <span>个人<\/span> <\/label> <input name=\"invoice-fapiao-invoiceHeader\" type=\"text\" maxlength=\"35\" id=\"invoice-fapiao-invoiceHeader\" /> <\/span> <div rel=\"invoice-header-help\" class=\"whats-this right bottom\"> <span class=\"toggle\">这是什么？<\/span> <span class=\"info\">你可以填写：\u2018个人\u2019，你的姓名或公司名称。<br>该信息将打印在发票上。<\/span> <\/div> <\/div> <div class=\"mbs\"> <span class=\"taxPayer-field field-with-placeholder\"> <label for=\"invoice-fapiao-taxPayer\" class=\"placeholder\"> <span>纳税人识别号或统一社会信用代码<\/span> <\/label> <input name=\"invoice-fapiao-taxPayerId\" type=\"text\" maxlength=\"20\" id=\"invoice-fapiao-taxPayer\" /> <\/span> <\/div> <p><a target=\"popupw640h394\" href=\"https://as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/fapiao/checkout-fapiao-personal-sample_GEO_CN?wid=640&hei=394&fmt=jpeg&qlt=95&op_sharpen=0&resMode=bicub&op_usm=0.5,0.5,0,0&iccEmbed=0&layer=comp&.v=NpUkV2\">查看个人发票示例<\/a><\/p> <\/div> <\/fieldset> ","id":"invoice-details"},{"value":" <div id=\"invoice-user-invoiceDeliveryAddress\"><\/div> ","id":"invoice-user"},{"value":" <fieldset class=\"CN first user-form-fieldset\"> <legend class=\"label\">发票寄送地址 <\/legend> <div class=\"user-address fieldset-content\" id=\"invoice-user-invoiceDeliveryAddress-address_section\"> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-nameLines-0-prf\"><\/span> <span class=\"lastName-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-lastName\" class=\"placeholder\"> <span>姓氏<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-lastName\" type=\"text\" size=\"10\" maxlength=\"20\" id=\"invoice-user-invoiceDeliveryAddress-lastName\" /> <\/span> <span class=\"firstName-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-firstName\" class=\"placeholder\"> <span>名字<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-firstName\" type=\"text\" size=\"10\" maxlength=\"14\" id=\"invoice-user-invoiceDeliveryAddress-firstName\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-addressLines-0-prf\"><\/span> <span class=\"daytimePhoneAreaCode-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-daytimePhoneAreaCode\" class=\"placeholder\"> <span>区号<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-daytimePhoneAreaCode\" type=\"text\" size=\"4\" maxlength=\"4\" class=\"kp-tel\" id=\"invoice-user-invoiceDeliveryAddress-daytimePhoneAreaCode\" /> <\/span> <span class=\"daytimePhone-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-daytimePhone\" class=\"placeholder\"> <span>联系号码 (如手机，区号输0)<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-daytimePhone\" type=\"text\" size=\"11\" maxlength=\"11\" class=\"kp-tel\" id=\"invoice-user-invoiceDeliveryAddress-daytimePhone\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-addressLines-1-prf\"><\/span> <span class=\"companyName-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-companyName\" class=\"placeholder\"> <span>公司名（可选）<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-companyName\" type=\"text\" size=\"17\" maxlength=\"35\" id=\"invoice-user-invoiceDeliveryAddress-companyName\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-addressLines-2-prf\"><\/span> <span class=\"state-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-state\" class=\"a11y\"> 省份 <\/label> <select name=\"invoice-user-invoiceDeliveryAddress-state\" id=\"invoice-user-invoiceDeliveryAddress-state\"><\/select> <\/span> <span class=\"city-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-city\" class=\"a11y\"> 城镇/城市 <\/label> <select name=\"invoice-user-invoiceDeliveryAddress-city\" id=\"invoice-user-invoiceDeliveryAddress-city\"><\/select> <\/span> <span class=\"district-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-district\" class=\"a11y\"> 区 <\/label> <select name=\"invoice-user-invoiceDeliveryAddress-district\" id=\"invoice-user-invoiceDeliveryAddress-district\"><\/select> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-addressLines-3-prf\"><\/span> <span class=\"street-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-street\" class=\"placeholder\"> <span>区，街道编号/名称，楼宇名称<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-street\" type=\"text\" size=\"20\" maxlength=\"35\" id=\"invoice-user-invoiceDeliveryAddress-street\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-addressLines-4-prf\"><\/span> <span class=\"street2-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-street2\" class=\"placeholder\"> <span>房间、套房、单元、楼层或街区<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-street2\" type=\"text\" size=\"20\" maxlength=\"35\" id=\"invoice-user-invoiceDeliveryAddress-street2\" /> <\/span> <\/div> <div class=\"mbs\"> <span class=\"editing\" id=\"invoice-user-invoiceDeliveryAddress-addressLines-5-prf\"><\/span> <span class=\"postalCode-field field-with-placeholder\"> <label for=\"invoice-user-invoiceDeliveryAddress-postalCode\" class=\"placeholder\"> <span>邮政编码<\/span> <\/label> <input name=\"invoice-user-invoiceDeliveryAddress-postalCode\" type=\"text\" size=\"5\" maxlength=\"6\" id=\"invoice-user-invoiceDeliveryAddress-postalCode\" /> <\/span> <\/div> <div class=\"optional-multicol\"> <span class=\"country-field field-with-placeholder first\"><span id=\"invoice-user-invoiceDeliveryAddress-country\"><\/span><\/span> <\/div> <\/div> <\/fieldset> ","id":"invoice-user-invoiceDeliveryAddress"}]},"url":"/cn/shop/checkoutx/invoice?_fid=co"}}
		 */
	},
	fillInvoice: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: context => ({
			sessionID:context.session.sessionID,
			'invoice-user-invoiceEmailAddress-emailAddress':context.user.emailAddress,
			'invoice-fapiao-invoiceHeader': context.user.invoiceHeader,
			'invoice-fapiao-taxPayerId':'',
			'invoice-form-options-selection':'personal',
			'invoice-user-invoiceDeliveryAddress-lastName':context.user.lastName,
			'invoice-user-invoiceDeliveryAddress-firstName':context.user.firstName,
			'invoice-user-invoiceDeliveryAddress-daytimePhoneAreaCode': context.user.daytimePhoneAreaCode,
			'invoice-user-invoiceDeliveryAddress-daytimePhone': context.user.daytimePhone,
			'invoice-user-invoiceDeliveryAddress-companyName':'',
			'invoice-user-invoiceDeliveryAddress-state':context.user.state,
			'invoice-user-invoiceDeliveryAddress-city': context.user.city,
			'invoice-user-invoiceDeliveryAddress-district': context.user.district,
			'invoice-user-invoiceDeliveryAddress-street':context.user.street,
			'invoice-user-invoiceDeliveryAddress-street2':context.user.street2,
			'invoice-user-invoiceDeliveryAddress-postalCode': context.user.postalCode,
			'state':context.user.state,
			'city': context.user.city,
			'keyPath':'invoice.invoiceDeliveryAddress',
			'_a':'invoice.cont',
			'_fid':'co'
		}),
		parser: JSON.parse

		/**
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"summary":{"total":"RMB 15,976","show-tax-inclusive-prices":true,"totalnoship":"RMB 15,975","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 15,976","cart-subtotal-enabled":false,"placeOrderTerms":"","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}}},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 发货： 我们收到付款后就会与你确认日期。 <\/span> <span> - 免费 <\/span> <\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"summary","_actions":{"edit":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.edit&_fid=co&_m=cart","validate":false}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"perform":"action","omniture":"omniture.Edit ButtonDelivery","event":"click","target":"cart._actions.edit"},{"perform":"focus","event":"click","target":"delivery-box"}],"id":"edit-deliveryandpickup-link"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=bill.edit&_fid=co","validate":false}},"_forms":{"main":{"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonPayment","event":"click","target":"billing._actions.edit"},{"perform":"focus","event":"click","target":"payment-box"}],"id":"payment-edit-button"}]}},"editable":true,"enabled":true},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":1046387,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"Bank:Van Lanschot BankiersPaymentIdeal":{"microEvent":[{"action":"Bank:Van Lanschot Bankiers","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"editShippingCallToActionAccount":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Account","eVar":"eVar21"}]},"smsNotificationSelectedShipping":{"microEvent":[{"action":"smsNotificationSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:RabobankPaymentIdeal":{"microEvent":[{"action":"Bank:Rabobank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Regio BankPaymentIdeal":{"microEvent":[{"action":"Bank:Regio Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:KnabPaymentIdeal":{"microEvent":[{"action":"Bank:Knab","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Business address uncheckedShipping":{"microEvent":[{"action":"Business address unchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editPayment":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Guest Checkout: Guest CreateAccountAccount":{"microEvent":[{"action":"Guest Checkout: Guest CreateAccount","slot":"AOS: Checkout","feature":"Account","eVar":"prop37"}]},"Guest Checkout: Existing SignedInAccount":{"microEvent":[{"action":"Guest Checkout: Existing SignedIn","slot":"AOS: Checkout","feature":"Account","eVar":"prop37"}]},"Edit ButtonInvoice":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"Primary Pickup SMSShipping":{"microEvent":[{"action":"Primary Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Edit ButtonShipping":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Account/New"}},"smsSelectedShipping":{"microEvent":[{"action":"smsSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Business address checkedShipping":{"microEvent":[{"action":"Business address checked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editInvoice":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"Edit ButtonPayment":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"3rd Party Pickup SMSShipping":{"microEvent":[{"action":"3rd Party Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"Bank:ABN AMRO BankPaymentIdeal":{"microEvent":[{"action":"Bank:ABN AMRO Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"SMS Notification not selectedShipping":{"microEvent":[{"action":"SMS Notification not selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:INGPaymentIdeal":{"microEvent":[{"action":"Bank:ING","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:SNS BankPaymentIdeal":{"microEvent":[{"action":"Bank:SNS Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"businessAddressUncheckedShipping":{"microEvent":[{"action":"businessAddressUnchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"scrollToShippingCallToActionAccount":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Account","eVar":"eVar21"}]},"editDelivery":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Bank:ASN BankPaymentIdeal":{"microEvent":[{"action":"Bank:ASN Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Edit ButtonDelivery":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"errorAccount":{"microEvent":[{"action":"error | ","slot":"AOS: Checkout","feature":"Account","eVar":"eVar25"}]},"Guest Checkout: Existing GuestAccount":{"microEvent":[{"action":"Guest Checkout: Existing Guest","slot":"AOS: Checkout","feature":"Account","eVar":"prop37"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"businessAddressCheckedShipping":{"microEvent":[{"action":"businessAddressChecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"Bank:Triodos BankPaymentIdeal":{"microEvent":[{"action":"Bank:Triodos Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Friesland BankPaymentIdeal":{"microEvent":[{"action":"Bank:Friesland Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"continuePayment | WECHAT | EXTERNAL_PAYMENT":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Payment | WECHAT | EXTERNAL_PAYMENT","eVar":"prop37"}]},"Guest Checkout: Guest GuestAccount":{"microEvent":[{"action":"Guest Checkout: Guest Guest","slot":"AOS: Checkout","feature":"Account","eVar":"prop37"}]},"Bank:Bunq BankPaymentIdeal":{"microEvent":[{"action":"Bank:Bunq Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"SMS Notification selectedShipping":{"microEvent":[{"action":"SMS Notification selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"editShipping":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}}},"common":{"_actions":{"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"},{"name":"overrideFormat"}],"subForms":["cart._forms.main","shipping._forms.main","billing._forms.main","invoice._forms.main","account._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 西城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=ship.edit&_fid=co","validate":false}},"address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","mobilePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"title":true,"_forms":{"shippingAddressForm":{"views":[{"key":"shipping.address.lastName","id":"shipping-summary-user-lastName"},{"key":"shipping.address.firstName","id":"shipping-summary-user-firstName"},{"key":"shipping.address.daytimePhoneAreaCode","id":"shipping-summary-user-daytimePhoneAreaCode"},{"key":"shipping.address.daytimePhone","id":"shipping-summary-user-daytimePhone"},{"key":"shipping.address.state","id":"shipping-summary-user-state"},{"key":"shipping.address.city","id":"shipping-summary-user-city"},{"key":"shipping.address.district","id":"shipping-summary-user-district"},{"key":"shipping.address.street","id":"shipping-summary-user-street"},{"key":"shipping.address.street2","id":"shipping-summary-user-street2"},{"key":"shipping.address.postalCode","id":"shipping-summary-user-postalCode"},{"key":"shipping.address.country","id":"shipping-summary-user-country"},{"key":"shipping.address.emailAddress","id":"shipping-summary-user-emailAddress"},{"key":"shipping.address.mobilePhone","id":"shipping-summary-user-mobilePhone"}]},"main":{"subForms":["shipping._forms.shippingAddressForm"],"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonShipping","event":"click","target":"shipping._actions.edit"},{"perform":"focus","event":"click","target":"shipping-box"}],"id":"shipping-edit-button"}]}},"enabled":true},"terms":{"mode":"blank","editable":true,"enabled":true},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":2,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item first product-price\"> <span class=\"a11y\">物品价格：<\/span> RMB 7,988 <\/li> <li class=\"item phl quantity-select\"> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity\"><\/span> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 15,976<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"summary","_actions":{"edit":{"omniture":"omniture.editInvoice","form":"common._forms.document","url":"/cn/shop/checkoutx?_a=invoice.edit&_fid=co","validate":true}},"invoiceDeliveryAddress":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"fapiao":{"invoiceHeader":"个人","address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"taxPayer":""},"_forms":{"invoiceHeaderForm":{"views":[{"key":"invoice.fapiao.invoiceHeader","id":"invoice-summary-user-fapiao-invoiceHeader"}]},"main":{"subForms":["invoice._forms.invoiceAddressForm","invoice._forms.invoiceHeaderForm","invoice._forms.taxPayerForm","invoice._forms.invoiceDeliveryAddressForm"]},"invoiceDeliveryAddressForm":{"views":[{"key":"invoice.invoiceDeliveryAddress.lastName","id":"invoice-summary-user-invoiceDeliveryAddress-lastName"},{"key":"invoice.invoiceDeliveryAddress.firstName","id":"invoice-summary-user-invoiceDeliveryAddress-firstName"},{"key":"invoice.invoiceDeliveryAddress.daytimePhoneAreaCode","id":"invoice-summary-user-invoiceDeliveryAddress-daytimePhoneAreaCode"},{"key":"invoice.invoiceDeliveryAddress.daytimePhone","id":"invoice-summary-user-invoiceDeliveryAddress-daytimePhone"},{"key":"invoice.invoiceDeliveryAddress.companyName","id":"invoice-summary-user-invoiceDeliveryAddress-companyName"},{"key":"invoice.invoiceDeliveryAddress.state","id":"invoice-summary-user-invoiceDeliveryAddress-state"},{"key":"invoice.invoiceDeliveryAddress.city","id":"invoice-summary-user-invoiceDeliveryAddress-city"},{"key":"invoice.invoiceDeliveryAddress.district","id":"invoice-summary-user-invoiceDeliveryAddress-district"},{"key":"invoice.invoiceDeliveryAddress.street","id":"invoice-summary-user-invoiceDeliveryAddress-street"},{"key":"invoice.invoiceDeliveryAddress.street2","id":"invoice-summary-user-invoiceDeliveryAddress-street2"},{"key":"invoice.invoiceDeliveryAddress.postalCode","id":"invoice-summary-user-invoiceDeliveryAddress-postalCode"},{"key":"invoice.invoiceDeliveryAddress.country","id":"invoice-summary-user-invoiceDeliveryAddress-country"}]},"invoiceAddressForm":{"views":[{"key":"invoice.fapiao.address.emailAddress","id":"invoice-summary-user-address-emailAddress"}]},"taxPayerForm":{"views":[{"key":"invoice.fapiao.taxPayer","id":"invoice-summary-user-fapiao-taxPayer"}]}},"enabled":true},"account":{"mode":"edit","commsPref":true,"_actions":{"createAccount":{"omniture":"omniture.Guest Checkout: Guest CreateAccountAccount","form":"account._forms.main","url":"/cn/shop/checkoutx?_a=acct.crte&_fid=co"},"switchCreate":{"url":"/cn/shop/checkoutx?_a=acct.swcr&_fid=co"},"continue":{"omniture":"omniture.Guest Checkout: Guest GuestAccount","form":"account._forms.main","url":"/cn/shop/checkoutx?_a=acct.cont&_fid=co","validate":false},"signIn":{"omniture":"omniture.Guest Checkout: Existing SignedInAccount","form":"account._forms.main","url":"/cn/shop/checkoutx?_a=acct.sign&_fid=co"},"switchFound":{"form":"account._forms.main","url":"/cn/shop/checkoutx?_a=acct.swfo&_fid=co","validate":false}},"editable":true,"state":"accountCreate","_forms":{"main":{"subForms":["account._forms.accountForm"],"views":[{"events":[{"perform":"action","event":"click","target":"account._actions.continue"}],"id":"continue-as-guest"},{"events":[{"perform":"action","event":"click","target":"account._actions.continue"}],"id":"account-continue-as-guest"},{"events":[{"perform":"action","event":"click","target":"account._actions.createAccount"}],"id":"account-create-account"},{"events":[{"perform":"action","event":"click","target":"account._actions.signIn"}],"id":"account-sign-in"}],"events":[{"event":"load","omniture":"omniture.metricEvent"},{"event":"load","omniture":"omniture.startAccount"}]},"accountForm":{"fields":[{"name":"account-appleId","id":"account-appleId","validations":{"required":true,"requiredError":"Apple ID 未填写。"},"key":"account.appleId"},{"name":"account-password","id":"account-password","validations":{"required":true,"requiredError":"密码未填写。"},"key":"account.password"},{"name":"account-passwordAgain","id":"account-passwordAgain","validations":{"required":true,"requiredError":"再次输入密码。"},"key":"account.passwordAgain"},{"name":"account-commsPref","id":"account-commsPref","type":"checkbox","key":"account.commsPref"}],"views":[{"html":" <div class=\"form-content clearfix\" id=\"account-form-create\"> <div class=\"gs grid-1of2\"> <div class=\"account-info substep pam pln\"> <legend><strong>创建 Apple ID （可选） <\/strong> <\/legend> <p>如果您创建一个 Apple ID，我们将保存您的信息，这样您就可以让您的购物体验独具特色，并可以在线访问\u201c订单状态\u201d页面来查看和更改您的订单。您还可以使用自己的帐户在 App Store 购物、注册您的产品，以及执行诸多其他操作。<\/p> <p style=\"display:none;\" id=\"account-guest-prompt\">如果不想创建帐户，可以 <button id=\"continue-as-guest\" type=\"button\" class=\"text-action\">以访客身份继续。<\/button> <\/p> <\/div> <\/div> <div class=\"gs grid-1of2 gs-last\"> <div class=\"account-fields substep pam\"> <fieldset class=\"user-form-block\"> <p class=\"label-value-list pvs\"> <span class=\"label\">Apple ID：<\/span> <span class=\"value\">liuyunwei@yanxiu.com<\/span> <\/p> <p> <span class=\"password-field\"> <label for=\"account-password\" class=\"placeholder\"> <span>密码（至少8个字符）<\/span> <\/label> <input maxlength=\"32\" name=\"account-password\" id=\"account-password\" type=\"password\"/> <\/span> <\/p> <p> <span class=\"password-field password2-field\"> <label for=\"account-passwordAgain\" class=\"placeholder\"> <span>再次输入密码<\/span> <\/label> <input maxlength=\"32\" name=\"account-passwordAgain\" id=\"account-passwordAgain\" type=\"password\"/> <\/span> <\/p> <p class=\"pts keep-up-to-date\"> <span class=\"label-block\"> <span id=\"account-commsPref-checkbox-toggle-slider\" class=\"toggle-slider\"> <input name=\"account-commsPref\" id=\"account-commsPref\" type=\"checkbox\" class=\"checkbox\"/> <\/span> <label for=\"account-commsPref\"> 保持联系！请随时向我提供最新的 Apple 新闻。 <\/label> <\/span> <\/p> <\/fieldset> <\/div> <\/div> <\/div> ","id":"account-form"}]}},"enabled":true}},"update":{"htmls":[{"value":" <div class=\"user-address subsection\" id=\"shipping-summary-user-address_section\"> <h3 class=\"label\">送货地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"shipping-summary-user-lastName\"> <\/span> <span class=\"firstName\" id=\"shipping-summary-user-firstName\"> <\/span> <span id=\"shipping-summary-user-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-contactLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"shipping-summary-user-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"shipping-summary-user-daytimePhone\"> <\/span><span id=\"shipping-summary-user-contactLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-0-prf\"><\/span><span class=\"state\" id=\"shipping-summary-user-state\"> <\/span> <span class=\"city\" id=\"shipping-summary-user-city\"> <\/span> <span class=\"district\" id=\"shipping-summary-user-district\"> <\/span> <span id=\"shipping-summary-user-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-1-prf\"><\/span><span class=\"street\" id=\"shipping-summary-user-street\"> <\/span><span id=\"shipping-summary-user-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-2-prf\"><\/span><span class=\"street2\" id=\"shipping-summary-user-street2\"> <\/span><span id=\"shipping-summary-user-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-3-prf\"><\/span><span class=\"postalCode\" id=\"shipping-summary-user-postalCode\"> <\/span> <span id=\"shipping-summary-user-addressLines-3-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"shipping-summary-user-country\"><\/span><\/span> <\/p> <div id=\"shipping-summary-user-address-aux\"><\/div> <\/div> <div id=\"shipping-summary-user-address_section-aux\"><\/div> <\/div> <div class=\"user-contact subsection\" id=\"shipping-summary-user-contact_section\"> <h3 class=\"label\">发货通知<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-emailLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"shipping-summary-user-emailAddress\"> <\/span><span id=\"shipping-summary-user-emailLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-notificationLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"mobilePhone\" id=\"shipping-summary-user-mobilePhone\"> <\/span><span id=\"shipping-summary-user-notificationLines-0-ext\"><\/span><\/p> <\/div> <div id=\"shipping-summary-user-contact_section-aux\"><\/div> <\/div> ","id":"shipping-summary-user"},{"value":" <legend><strong>付款方式<\/strong><\/legend> <p><span> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-WeChat?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" alt=\"微信支付\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" /> <\/span><\/p> ","id":"payment-summary-method"},{"value":"","id":"installment-learn-more-link"},{"value":"","id":"payment-summary-user"},{"value":" <div class=\"subsection\" id=\"invoice-summary-user-option\"><\/div> <div id=\"invoice-summary-user-details\" class=\"subsection\"><\/div> <div id=\"invoice-summary-user-invoiceDeliveryAddress\" class=\"subsection\"><\/div> ","id":"invoice-summary-user"},{"value":" <div class=\"invoice-option subsection\"> <h3 class=\"label\">发票类型<\/h3> <div class=\"value\"> <p> <span>Apple 电子收据与普通发票<\/span> <\/p> <\/div> <\/div> ","id":"invoice-summary-user-option"},{"value":" <div class=\"invoice-details\"> <div class=\"value\"> <div class=\"user-contact subsection\" id=\"invoice-summary-user-address-contact_section\"> <h3 class=\"label\">电子邮件地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"invoice-summary-user-address-contactLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"invoice-summary-user-address-emailAddress\"> <\/span><span id=\"invoice-summary-user-address-contactLines-0-ext\"><\/span><\/p> <\/div> <div id=\"invoice-summary-user-address-contact_section-aux\"><\/div> <\/div> <\/div> <\/div> <div class=\"invoice-details subsection\"> <strong class=\"label\"> <span>发票抬头<\/span> <\/strong> <div class=\"value\"> <div class=\"mbs\"> <span id=\"invoice-summary-user-fapiao-invoiceHeader\"><\/span> <\/div> <div class=\"mbs\"> <span id=\"invoice-summary-user-fapiao-taxPayer\"><\/span> <\/div> <\/div> <\/div> ","id":"invoice-summary-user-details"},{"value":" <div class=\"user-address subsection\" id=\"invoice-summary-user-invoiceDeliveryAddress-address_section\"> <h3 class=\"label\">发票寄送地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"invoice-summary-user-invoiceDeliveryAddress-lastName\"> <\/span> <span class=\"firstName\" id=\"invoice-summary-user-invoiceDeliveryAddress-firstName\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"invoice-summary-user-invoiceDeliveryAddress-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"invoice-summary-user-invoiceDeliveryAddress-daytimePhone\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-1-prf\"><\/span><span class=\"companyName\" id=\"invoice-summary-user-invoiceDeliveryAddress-companyName\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-2-prf\"><\/span><span class=\"state\" id=\"invoice-summary-user-invoiceDeliveryAddress-state\"> <\/span> <span class=\"city\" id=\"invoice-summary-user-invoiceDeliveryAddress-city\"> <\/span> <span class=\"district\" id=\"invoice-summary-user-invoiceDeliveryAddress-district\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-3-prf\"><\/span><span class=\"street\" id=\"invoice-summary-user-invoiceDeliveryAddress-street\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-3-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-4-prf\"><\/span><span class=\"street2\" id=\"invoice-summary-user-invoiceDeliveryAddress-street2\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-4-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-5-prf\"><\/span><span class=\"postalCode\" id=\"invoice-summary-user-invoiceDeliveryAddress-postalCode\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-5-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"invoice-summary-user-invoiceDeliveryAddress-country\"><\/span><\/span> <\/p> <div id=\"invoice-summary-user-invoiceDeliveryAddress-address-aux\"><\/div> <\/div> <div id=\"invoice-summary-user-invoiceDeliveryAddress-address_section-aux\"><\/div> <\/div> ","id":"invoice-summary-user-invoiceDeliveryAddress"}]},"url":"/cn/shop/checkoutx"}}
		 */
	},
	fillAccount: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: context => ({
			//sessionID:context.session.sessionID,
			'account-appleId':'',
			'account-password':'',
			'account-passwordAgain':'',
			'account-commsPref':'true',
			'_a':'acct.cont',
			'_fid':'co'
		}),
		parser: JSON.parse

		/**
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"summary":{"total":"RMB 15,976","show-tax-inclusive-prices":true,"totalnoship":"RMB 15,975","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 15,976","cart-subtotal-enabled":false,"placeOrderTerms":"","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}}},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 发货： 我们收到付款后就会与你确认日期。 <\/span> <span> - 免费 <\/span> <\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"summary","_actions":{"edit":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.edit&_fid=co&_m=cart","validate":false}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"perform":"action","omniture":"omniture.Edit ButtonDelivery","event":"click","target":"cart._actions.edit"},{"perform":"focus","event":"click","target":"delivery-box"}],"id":"edit-deliveryandpickup-link"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=bill.edit&_fid=co","validate":false}},"_forms":{"main":{"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonPayment","event":"click","target":"billing._actions.edit"},{"perform":"focus","event":"click","target":"payment-box"}],"id":"payment-edit-button"}]}},"editable":true,"enabled":true},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":483154,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"Bank:Van Lanschot BankiersPaymentIdeal":{"microEvent":[{"action":"Bank:Van Lanschot Bankiers","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"smsNotificationSelectedShipping":{"microEvent":[{"action":"smsNotificationSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:RabobankPaymentIdeal":{"microEvent":[{"action":"Bank:Rabobank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Regio BankPaymentIdeal":{"microEvent":[{"action":"Bank:Regio Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:KnabPaymentIdeal":{"microEvent":[{"action":"Bank:Knab","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Business address uncheckedShipping":{"microEvent":[{"action":"Business address unchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editPayment":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Edit ButtonInvoice":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"Primary Pickup SMSShipping":{"microEvent":[{"action":"Primary Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Edit ButtonShipping":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Terms"}},"editShippingCallToActionTerms":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Terms","eVar":"eVar21"}]},"smsSelectedShipping":{"microEvent":[{"action":"smsSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Business address checkedShipping":{"microEvent":[{"action":"Business address checked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editInvoice":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"AT&T next loan agreement displayedTerms":{"microEvent":[{"action":"AT&T next loan agreement displayed","feature":"Terms","eVar":"eVar21"}]},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"Edit ButtonPayment":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"3rd Party Pickup SMSShipping":{"microEvent":[{"action":"3rd Party Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"scrollToShippingCallToActionTerms":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Terms","eVar":"eVar21"}]},"Bank:ABN AMRO BankPaymentIdeal":{"microEvent":[{"action":"Bank:ABN AMRO Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"SMS Notification not selectedShipping":{"microEvent":[{"action":"SMS Notification not selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:INGPaymentIdeal":{"microEvent":[{"action":"Bank:ING","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:SNS BankPaymentIdeal":{"microEvent":[{"action":"Bank:SNS Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"businessAddressUncheckedShipping":{"microEvent":[{"action":"businessAddressUnchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editDelivery":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Bank:ASN BankPaymentIdeal":{"microEvent":[{"action":"Bank:ASN Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Edit ButtonDelivery":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"businessAddressCheckedShipping":{"microEvent":[{"action":"businessAddressChecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"Bank:Triodos BankPaymentIdeal":{"microEvent":[{"action":"Bank:Triodos Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Friesland BankPaymentIdeal":{"microEvent":[{"action":"Bank:Friesland Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"continuePayment | WECHAT | EXTERNAL_PAYMENT":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Payment | WECHAT | EXTERNAL_PAYMENT","eVar":"prop37"}]},"Bank:Bunq BankPaymentIdeal":{"microEvent":[{"action":"Bank:Bunq Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"SMS Notification selectedShipping":{"microEvent":[{"action":"SMS Notification selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"editShipping":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}}},"common":{"_actions":{"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"},{"name":"overrideFormat"}],"subForms":["cart._forms.main","shipping._forms.main","billing._forms.main","invoice._forms.main","terms._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 西城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=ship.edit&_fid=co","validate":false}},"address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","mobilePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"title":true,"_forms":{"shippingAddressForm":{"views":[{"key":"shipping.address.lastName","id":"shipping-summary-user-lastName"},{"key":"shipping.address.firstName","id":"shipping-summary-user-firstName"},{"key":"shipping.address.daytimePhoneAreaCode","id":"shipping-summary-user-daytimePhoneAreaCode"},{"key":"shipping.address.daytimePhone","id":"shipping-summary-user-daytimePhone"},{"key":"shipping.address.state","id":"shipping-summary-user-state"},{"key":"shipping.address.city","id":"shipping-summary-user-city"},{"key":"shipping.address.district","id":"shipping-summary-user-district"},{"key":"shipping.address.street","id":"shipping-summary-user-street"},{"key":"shipping.address.street2","id":"shipping-summary-user-street2"},{"key":"shipping.address.postalCode","id":"shipping-summary-user-postalCode"},{"key":"shipping.address.country","id":"shipping-summary-user-country"},{"key":"shipping.address.emailAddress","id":"shipping-summary-user-emailAddress"},{"key":"shipping.address.mobilePhone","id":"shipping-summary-user-mobilePhone"}]},"main":{"subForms":["shipping._forms.shippingAddressForm"],"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonShipping","event":"click","target":"shipping._actions.edit"},{"perform":"focus","event":"click","target":"shipping-box"}],"id":"shipping-edit-button"}]}},"enabled":true},"terms":{"mode":"edit","_actions":{"continue":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=terms.cont&_fid=co"},"eConsentLink":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=terms.eConsent&_fid=co"}},"editable":true,"acceptAppleTnc":false,"_forms":{"main":{"subForms":["terms._forms.termsForm"],"views":[{"events":[{"perform":"action","event":"click","target":"terms._actions.continue"}],"id":"terms-continue-button"},{"events":[{"perform":"action","event":"click","target":"terms._actions.eConsentLink"}],"id":"eConsent-link"}],"events":[{"event":"load","omniture":"omniture.metricEvent"}]},"termsForm":{"fields":[{"name":"accept","binding":"termsAccept","id":"terms-accept","type":"checkbox","key":"terms.accept"},{"name":"acceptAppleTnc","binding":"termsAcceptACPlus","id":"terms-acceptAppleTnc","type":"checkbox","key":"terms.acceptAppleTnc"}],"views":[{"html":" <div class=\"terms-content section\"> <p class=\"single-checkbox clearfix\"> <span class=\"toggle-slider\" id=\"terms-accept-checkbox-toggle-slider\"> <input type=\"checkbox\" class=\"checkbox\" id=\"terms-accept\" /> <\/span> <label for=\"terms-accept\"> 通过单击 \u201c下单\u201d，我同意接受 Apple Store 在线商店<a href=\"/shop/go/salespolicies\" target=\"_blank\">条款和条件<\/a>。<br /><br /> 请注意以下内容：<br />发货和送达日期为 Apple 做出的最佳估算时间。就少数订单，由于无法预料的产品短缺或超出我们控制以外的因素，实际时间可能会更长。如有延迟，我们将联系您，您可以选择取消订单及要求全额退款。<br />我们网站上的产品和定价信息在公布前已经过核实。但是，在极少数情形下可能有误。如果我们发现定价错误，我们将通知您，取消您的订单，并对订单金额全额退款。 <\/label> <\/p> <\/div> ","id":"terms-form"}]}},"enabled":true,"accept":false},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":2,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item first product-price\"> <span class=\"a11y\">物品价格：<\/span> RMB 7,988 <\/li> <li class=\"item phl quantity-select\"> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity\"><\/span> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 15,976<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"summary","_actions":{"edit":{"omniture":"omniture.editInvoice","form":"common._forms.document","url":"/cn/shop/checkoutx?_a=invoice.edit&_fid=co","validate":true}},"invoiceDeliveryAddress":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"fapiao":{"invoiceHeader":"个人","address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"taxPayer":""},"_forms":{"invoiceHeaderForm":{"views":[{"key":"invoice.fapiao.invoiceHeader","id":"invoice-summary-user-fapiao-invoiceHeader"}]},"main":{"subForms":["invoice._forms.invoiceAddressForm","invoice._forms.invoiceHeaderForm","invoice._forms.taxPayerForm","invoice._forms.invoiceDeliveryAddressForm"]},"invoiceDeliveryAddressForm":{"views":[{"key":"invoice.invoiceDeliveryAddress.lastName","id":"invoice-summary-user-invoiceDeliveryAddress-lastName"},{"key":"invoice.invoiceDeliveryAddress.firstName","id":"invoice-summary-user-invoiceDeliveryAddress-firstName"},{"key":"invoice.invoiceDeliveryAddress.daytimePhoneAreaCode","id":"invoice-summary-user-invoiceDeliveryAddress-daytimePhoneAreaCode"},{"key":"invoice.invoiceDeliveryAddress.daytimePhone","id":"invoice-summary-user-invoiceDeliveryAddress-daytimePhone"},{"key":"invoice.invoiceDeliveryAddress.companyName","id":"invoice-summary-user-invoiceDeliveryAddress-companyName"},{"key":"invoice.invoiceDeliveryAddress.state","id":"invoice-summary-user-invoiceDeliveryAddress-state"},{"key":"invoice.invoiceDeliveryAddress.city","id":"invoice-summary-user-invoiceDeliveryAddress-city"},{"key":"invoice.invoiceDeliveryAddress.district","id":"invoice-summary-user-invoiceDeliveryAddress-district"},{"key":"invoice.invoiceDeliveryAddress.street","id":"invoice-summary-user-invoiceDeliveryAddress-street"},{"key":"invoice.invoiceDeliveryAddress.street2","id":"invoice-summary-user-invoiceDeliveryAddress-street2"},{"key":"invoice.invoiceDeliveryAddress.postalCode","id":"invoice-summary-user-invoiceDeliveryAddress-postalCode"},{"key":"invoice.invoiceDeliveryAddress.country","id":"invoice-summary-user-invoiceDeliveryAddress-country"}]},"invoiceAddressForm":{"views":[{"key":"invoice.fapiao.address.emailAddress","id":"invoice-summary-user-address-emailAddress"}]},"taxPayerForm":{"views":[{"key":"invoice.fapiao.taxPayer","id":"invoice-summary-user-fapiao-taxPayer"}]}},"enabled":true},"account":{"mode":"summary","commsPref":true,"editable":false,"_forms":{"main":{"subForms":["account._forms.accountForm"]},"accountForm":{"views":[{"html":" <div class=\"summary-content\" id=\"account-summary-content\"> <ul class=\"label-value-list\"> <li class=\"no-label\"> <span class=\"label\"> 未创建 ID <\/span> <span class=\"value\"> 访客 <\/span> <\/li> <\/ul> <\/div> ","id":"account-summary"},{"key":"account.appleId","id":"account-summary-appleId"}]}},"appleId":"liuyunwei@yanxiu.com","enabled":true}},"update":{"htmls":[{"value":" <div class=\"user-address subsection\" id=\"shipping-summary-user-address_section\"> <h3 class=\"label\">送货地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"shipping-summary-user-lastName\"> <\/span> <span class=\"firstName\" id=\"shipping-summary-user-firstName\"> <\/span> <span id=\"shipping-summary-user-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-contactLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"shipping-summary-user-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"shipping-summary-user-daytimePhone\"> <\/span><span id=\"shipping-summary-user-contactLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-0-prf\"><\/span><span class=\"state\" id=\"shipping-summary-user-state\"> <\/span> <span class=\"city\" id=\"shipping-summary-user-city\"> <\/span> <span class=\"district\" id=\"shipping-summary-user-district\"> <\/span> <span id=\"shipping-summary-user-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-1-prf\"><\/span><span class=\"street\" id=\"shipping-summary-user-street\"> <\/span><span id=\"shipping-summary-user-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-2-prf\"><\/span><span class=\"street2\" id=\"shipping-summary-user-street2\"> <\/span><span id=\"shipping-summary-user-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-3-prf\"><\/span><span class=\"postalCode\" id=\"shipping-summary-user-postalCode\"> <\/span> <span id=\"shipping-summary-user-addressLines-3-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"shipping-summary-user-country\"><\/span><\/span> <\/p> <div id=\"shipping-summary-user-address-aux\"><\/div> <\/div> <div id=\"shipping-summary-user-address_section-aux\"><\/div> <\/div> <div class=\"user-contact subsection\" id=\"shipping-summary-user-contact_section\"> <h3 class=\"label\">发货通知<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-emailLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"shipping-summary-user-emailAddress\"> <\/span><span id=\"shipping-summary-user-emailLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-notificationLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"mobilePhone\" id=\"shipping-summary-user-mobilePhone\"> <\/span><span id=\"shipping-summary-user-notificationLines-0-ext\"><\/span><\/p> <\/div> <div id=\"shipping-summary-user-contact_section-aux\"><\/div> <\/div> ","id":"shipping-summary-user"},{"value":" <legend><strong>付款方式<\/strong><\/legend> <p><span> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-WeChat?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" alt=\"微信支付\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" /> <\/span><\/p> ","id":"payment-summary-method"},{"value":"","id":"installment-learn-more-link"},{"value":"","id":"payment-summary-user"},{"value":" <div class=\"subsection\" id=\"invoice-summary-user-option\"><\/div> <div id=\"invoice-summary-user-details\" class=\"subsection\"><\/div> <div id=\"invoice-summary-user-invoiceDeliveryAddress\" class=\"subsection\"><\/div> ","id":"invoice-summary-user"},{"value":" <div class=\"invoice-option subsection\"> <h3 class=\"label\">发票类型<\/h3> <div class=\"value\"> <p> <span>Apple 电子收据与普通发票<\/span> <\/p> <\/div> <\/div> ","id":"invoice-summary-user-option"},{"value":" <div class=\"invoice-details\"> <div class=\"value\"> <div class=\"user-contact subsection\" id=\"invoice-summary-user-address-contact_section\"> <h3 class=\"label\">电子邮件地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"invoice-summary-user-address-contactLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"invoice-summary-user-address-emailAddress\"> <\/span><span id=\"invoice-summary-user-address-contactLines-0-ext\"><\/span><\/p> <\/div> <div id=\"invoice-summary-user-address-contact_section-aux\"><\/div> <\/div> <\/div> <\/div> <div class=\"invoice-details subsection\"> <strong class=\"label\"> <span>发票抬头<\/span> <\/strong> <div class=\"value\"> <div class=\"mbs\"> <span id=\"invoice-summary-user-fapiao-invoiceHeader\"><\/span> <\/div> <div class=\"mbs\"> <span id=\"invoice-summary-user-fapiao-taxPayer\"><\/span> <\/div> <\/div> <\/div> ","id":"invoice-summary-user-details"},{"value":" <div class=\"user-address subsection\" id=\"invoice-summary-user-invoiceDeliveryAddress-address_section\"> <h3 class=\"label\">发票寄送地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"invoice-summary-user-invoiceDeliveryAddress-lastName\"> <\/span> <span class=\"firstName\" id=\"invoice-summary-user-invoiceDeliveryAddress-firstName\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"invoice-summary-user-invoiceDeliveryAddress-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"invoice-summary-user-invoiceDeliveryAddress-daytimePhone\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-1-prf\"><\/span><span class=\"companyName\" id=\"invoice-summary-user-invoiceDeliveryAddress-companyName\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-2-prf\"><\/span><span class=\"state\" id=\"invoice-summary-user-invoiceDeliveryAddress-state\"> <\/span> <span class=\"city\" id=\"invoice-summary-user-invoiceDeliveryAddress-city\"> <\/span> <span class=\"district\" id=\"invoice-summary-user-invoiceDeliveryAddress-district\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-3-prf\"><\/span><span class=\"street\" id=\"invoice-summary-user-invoiceDeliveryAddress-street\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-3-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-4-prf\"><\/span><span class=\"street2\" id=\"invoice-summary-user-invoiceDeliveryAddress-street2\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-4-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-5-prf\"><\/span><span class=\"postalCode\" id=\"invoice-summary-user-invoiceDeliveryAddress-postalCode\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-5-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"invoice-summary-user-invoiceDeliveryAddress-country\"><\/span><\/span> <\/p> <div id=\"invoice-summary-user-invoiceDeliveryAddress-address-aux\"><\/div> <\/div> <div id=\"invoice-summary-user-invoiceDeliveryAddress-address_section-aux\"><\/div> <\/div> ","id":"invoice-summary-user-invoiceDeliveryAddress"}]},"url":"/cn/shop/checkoutx"}}
		 */
	},
	fillTnc: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: context => ({
			sessionID:context.session.sessionID,
			accept:true,
			acceptAppleTnc:false,
			_a:'terms.cont',
			_fid:'co'
		}),
		parser: JSON.parse

		/**
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"summary":{"total":"RMB 15,976","show-tax-inclusive-prices":true,"totalnoship":"RMB 15,975","shipping":{"cost":"RMB 0","free":true,"enabled":true},"subtotal":"RMB 15,976","cart-subtotal-enabled":false,"placeOrderTerms":"单击\u201c立即下订单\u201d按钮，即表示您确认自己接受本次销售交易的<a href=\"https://www.apple.com/cn/shop/browse/open/salespolicies\" target=\"_blank\" data-s-object-id=\"418f8d4224e58c0836bf806b55d9c1fe\"  data-evar1=\"AOS: com.apple.store.application.oscar.co2.components.Checkout2Handler |  | Astro Link | 0 | AOS: open/salespolicies\" data-evar30=\"com.apple.store.application.oscar.co2.components.Checkout2Handler/Astro_Link\" data-prop37=\"AOS: com.apple.store.application.oscar.co2.components.Checkout2Handler |  | Astro Link | 0 | AOS: open/salespolicies | Checkout:Verify: Sales & Refund\">条款和条件<\/a>。","_forms":{"main":{"views":[{"id":"purchase-totals","type":"OrderSummary","summaryType":"cart","key":"summary"},{"id":"secondary","type":"OrderSummary","summaryType":"sidebar","key":"summary"},{"id":"cart-utility-message","type":"OrderSummary","summaryType":"message","key":"summary"},{"id":"place-order-footer","type":"OrderSummary","summaryType":"placeorder","key":"summary"},{"html":" ","id":"amount-due-text"}]}},"placeOrderButton":"<button type=\"submit\" class=\"button rect transactional\" id=\"place-order-button\" title=\"立即下订单\">\n            <span><span class=\"label\">立即下订单<\/span><\/span>\n        <\/button>"},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery":{"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship._forms.main"],"views":[{"html":" <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8\"><\/div> <div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-complete-A8\"><\/div> <div class=\"line-item-address\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-itemAddress\"><\/div> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery"}]}}},"pickup":{"mode":"blank","editable":true,"enabled":false},"ignoreHighlightFirstErrorInCurrentStep":false,"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-ship":{"_forms":{"main":{"views":[{"html":" <label for=\"\"> <span class=\"delivery-details\"> <span> <span> 发货： 我们收到付款后就会与你确认日期。 <\/span> <span> - 免费 <\/span> <\/span> <\/span> <\/label> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-A8"}]}}},"login":false,"cart":{"mode":"summary","_actions":{"edit":{"submit":true,"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=cart.edit&_fid=co&_m=cart","validate":false}},"editable":true,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main._forms.main"],"views":[{"html":"&nbsp; ","id":"delivery-header"},{"html":" 送货选项 ","id":"delivery-box-title"},{"html":" <span class=\"singleAdressMode\"><\/span> ","id":"cart-continue-message"},{"events":[{"perform":"action","omniture":"omniture.Edit ButtonDelivery","event":"click","target":"cart._actions.edit"},{"perform":"focus","event":"click","target":"delivery-box"}],"id":"edit-deliveryandpickup-link"},{"keys":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.html"],"id":"cart-product-list"},{"id":"cart-error"},{"id":"cart-acknowledgement"}]}},"enabled":true,"a11y-message":"正在载入内容，请稍候","canContinue":true,"_events":[{"perform":"method","event":"load","target":"closeRecentAddressOverlay"}]},"billing":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=bill.edit&_fid=co","validate":false}},"_forms":{"main":{"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonPayment","event":"click","target":"billing._actions.edit"},{"perform":"focus","event":"click","target":"payment-box"}],"id":"payment-edit-button"}]}},"editable":true,"enabled":true},"sessionExtension":{"_actions":{"sto":{"sessionExtensionConfirm":"/cn/shop/checkoutx?_a=sto.seo&_fid=co","sessionExtension":"/cn/shop/checkoutx?_a=sto.se&_fid=co"}},"sto":{"params":{"sessionCanBeExtended":true,"sessionAlertDiff":60000,"sessionAutoAlertDiff":300000,"sessionLength":334415,"sessionExpiredURL":"https://www.apple.com/cn/shop/sorry_message/session_expired?m=PHA*PHN0cm9uZz4-Pz8-Pz8-Pz8-Pzwvc3Ryb25nPjwvcD4gPHA*Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-Pz8-PyAyMCA-Pz8-Pz88YnIgLz4gPz8-Pz8-Pz8-Pz8-Pz8-Pz8-PzwvcD4"}}},"omniture":{"Bank:Van Lanschot BankiersPaymentIdeal":{"microEvent":[{"action":"Bank:Van Lanschot Bankiers","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"smsNotificationSelectedShipping":{"microEvent":[{"action":"smsNotificationSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:RabobankPaymentIdeal":{"microEvent":[{"action":"Bank:Rabobank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Regio BankPaymentIdeal":{"microEvent":[{"action":"Bank:Regio Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:KnabPaymentIdeal":{"microEvent":[{"action":"Bank:Knab","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Business address uncheckedShipping":{"microEvent":[{"action":"Business address unchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editPayment":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Edit ButtonInvoice":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"Primary Pickup SMSShipping":{"microEvent":[{"action":"Primary Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"metricEvent":{"metrics":{"pageName":"AOS: Checkout/Verify"}},"Edit ButtonShipping":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"smsSelectedShipping":{"microEvent":[{"action":"smsSelected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Business address checkedShipping":{"microEvent":[{"action":"Business address checked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editInvoice":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Invoice","eVar":"prop37"}]},"More optionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"More options","feature":"Delivery","eVar":"prop37"}]}},"Edit ButtonPayment":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Payment","eVar":"prop37"}]},"Get Delivery datesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Get Delivery dates","feature":"Delivery","eVar":"prop37"}]}},"3rd Party Pickup SMSShipping":{"microEvent":[{"action":"3rd Party Pickup SMS","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Dates_Options_footerDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"Dates_Options_footer","feature":"Delivery","eVar":"prop37"}]}},"Continue to iDealVerify":{"microEvent":[{"action":"Continue to iDeal","slot":"AOS: Checkout","feature":"Verify","eVar":"prop37"}]},"Bank:ABN AMRO BankPaymentIdeal":{"microEvent":[{"action":"Bank:ABN AMRO Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"shipFasterOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"shipFasterOptions","feature":"Delivery","eVar":"prop37"}]}},"SMS Notification not selectedShipping":{"microEvent":[{"action":"SMS Notification not selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"Bank:INGPaymentIdeal":{"microEvent":[{"action":"Bank:ING","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:SNS BankPaymentIdeal":{"microEvent":[{"action":"Bank:SNS Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"scrollToShippingCallToActionVerify":{"microEvent":[{"action":"scrollToShippingCallToAction","slot":"Shipping Call To Action","feature":"Verify","eVar":"eVar21"}]},"businessAddressUncheckedShipping":{"microEvent":[{"action":"businessAddressUnchecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"editDelivery":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Bank:ASN BankPaymentIdeal":{"microEvent":[{"action":"Bank:ASN Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"editShippingCallToActionVerify":{"microEvent":[{"action":"editShippingCallToAction","slot":"Shipping Call To Action","feature":"Verify","eVar":"eVar21"}]},"Edit ButtonDelivery":{"microEvent":[{"action":"Edit Button","slot":"AOS: Checkout","feature":"Delivery","eVar":"prop37"}]},"Continueedit cart | overlay":{"microEvent":[{"action":"Continue","slot":"AOS: Checkout","feature":"edit cart | overlay","eVar":"eVar21"}]},"businessAddressCheckedShipping":{"microEvent":[{"action":"businessAddressChecked","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"MoreOptionsDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"MoreOptions","feature":"Delivery","eVar":"prop37"}]}},"Bank:Triodos BankPaymentIdeal":{"microEvent":[{"action":"Bank:Triodos Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"Bank:Friesland BankPaymentIdeal":{"microEvent":[{"action":"Bank:Friesland Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"pickTimeSlotDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"pickTimeSlot","feature":"Delivery","eVar":"prop37"}]}},"continuePayment | WECHAT | EXTERNAL_PAYMENT":{"microEvent":[{"action":"continue","slot":"AOS: Checkout","feature":"Payment | WECHAT | EXTERNAL_PAYMENT","eVar":"prop37"}]},"Bank:Bunq BankPaymentIdeal":{"microEvent":[{"action":"Bank:Bunq Bank","slot":"AOS: Checkout","feature":"PaymentIdeal","eVar":"prop37"}]},"SMS Notification selectedShipping":{"microEvent":[{"action":"SMS Notification selected","slot":"AOS: Checkout","feature":"Shipping","eVar":"eVar21"}]},"editShipping":{"microEvent":[{"action":"edit","slot":"AOS: Checkout","feature":"Shipping","eVar":"prop37"}]},"GetDeliveryDatesDelivery":{"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions":{"microEvent":[{"action":"GetDeliveryDates","feature":"Delivery","eVar":"prop37"}]}}},"common":{"_actions":{"placeOrder":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=po&_fid=co"},"editCart":{"form":"common._forms.main","url":"/cn/shop/checkoutx?_a=ec&_fid=co","validate":false}},"_operation":"process","_forms":{"main":{"fields":[{"name":"aywysya","type":"aywysya"}],"subForms":["common._forms.document","summary._forms.main","promo._forms.main"],"views":[{"id":"alerts"}]},"document":{"fields":[{"name":"sessionID","value":"0475e44b594b78652efa5c6c40bfb15fca85028d636c35849dae75e127f92dc0"},{"name":"overrideFormat"}],"subForms":["cart._forms.main","shipping._forms.main","billing._forms.main","invoice._forms.main","terms._forms.main"]}},"_events":[{"perform":"action","omniture":"omniture.Continueedit cart | overlay","id":"edit-cart","event":"click","target":"common._actions.editCart"},{"perform":"action","id":"place-order-button","event":"click","target":"common._actions.placeOrder"},{"event":"load","omniture":"omniture.metricEvent"}]},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink":{"_actions":{"changeShippingOptions":{"url":"/cn/shop/checkoutx?_a=cso&_fid=co&_id=9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6&_m=item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink"}},"_forms":{"main":{"views":[{"html":" <span class=\"block\"> <span class=\"delivery-getting\"> 是否要选择固定时间段送货？ <\/span> <span class=\"item pipe\"> <button class=\"change-shipping-options\" id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions\"> 北京 北京 西城区 的更多选项 <\/button> <\/span> <\/span> ","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions"},{"html":" <button id=\"shipping-options-button\" type=\"button\" class=\"button rect secondary mrm\"> <span>查看送货选项<\/span> <\/button> ","id":"shipping-options"}]}},"_events":[{"perform":"action","omniture":"omniture.pickTimeSlotDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions-changeShippingOptions","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"},{"perform":"action","omniture":"omniture.Dates_Options_footerDelivery.cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery-ship-shippingOptions","id":"shipping-options-button","event":"click","target":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._actions.changeShippingOptions"}]},"shipping":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=ship.edit&_fid=co","validate":false}},"address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","mobilePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"title":true,"_forms":{"shippingAddressForm":{"views":[{"key":"shipping.address.lastName","id":"shipping-summary-user-lastName"},{"key":"shipping.address.firstName","id":"shipping-summary-user-firstName"},{"key":"shipping.address.daytimePhoneAreaCode","id":"shipping-summary-user-daytimePhoneAreaCode"},{"key":"shipping.address.daytimePhone","id":"shipping-summary-user-daytimePhone"},{"key":"shipping.address.state","id":"shipping-summary-user-state"},{"key":"shipping.address.city","id":"shipping-summary-user-city"},{"key":"shipping.address.district","id":"shipping-summary-user-district"},{"key":"shipping.address.street","id":"shipping-summary-user-street"},{"key":"shipping.address.street2","id":"shipping-summary-user-street2"},{"key":"shipping.address.postalCode","id":"shipping-summary-user-postalCode"},{"key":"shipping.address.country","id":"shipping-summary-user-country"},{"key":"shipping.address.emailAddress","id":"shipping-summary-user-emailAddress"},{"key":"shipping.address.mobilePhone","id":"shipping-summary-user-mobilePhone"}]},"main":{"subForms":["shipping._forms.shippingAddressForm"],"views":[{"events":[{"perform":"action","omniture":"omniture.Edit ButtonShipping","event":"click","target":"shipping._actions.edit"},{"perform":"focus","event":"click","target":"shipping-box"}],"id":"shipping-edit-button"}]}},"enabled":true},"terms":{"mode":"summary","_actions":{"edit":{"form":"common._forms.document","url":"/cn/shop/checkoutx?_a=terms.edit&_fid=co","validate":false}},"_forms":{"main":{"views":[{"events":[{"perform":"action","event":"click","target":"terms._actions.edit"},{"perform":"focus","event":"click","target":"terms-box"}],"id":"terms-edit-button"}]}},"editable":true,"enabled":true},"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main":{"omniture":{"showProductDetailsDelivery":{"microEvent":[{"action":"showProductDetails","feature":"Delivery","eVar":"prop37"}]},"hideProductDetailsDelivery":{"microEvent":[{"action":"hideProductDetails","feature":"Delivery","eVar":"prop37"}]}},"quantity":2,"html":" <li class=\"cart-product clearfix top-divided\"> <div class=\"product-container\"> <div class=\"media-block\"> <div class=\"media product-image mtm\"> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/i/ph/iphone8/plus/iphone8-plus-gold-select-2017?wid=220&amp;hei=156&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" alt=\"\" width=\"110\" height=\"78\" data-scale-params-1=\"wid=110&amp;hei=78&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1504041014365\" /> <\/div> <div class=\"content product-info pvm\"> <div class=\"product-head media-block alt clearfix\"> <div class=\"product-title\"> <h3 class=\"content h3 strong\"> iPhone 8 Plus 256GB 金色 <\/h3> <\/div> <ul class=\" media h-list price-quantity\"> <li class=\"item first product-price\"> <span class=\"a11y\">物品价格：<\/span> RMB 7,988 <\/li> <li class=\"item phl quantity-select\"> <span id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity\"><\/span> <\/li> <li class=\"item quantity-price h4\"> <span class=\"a11y\">合计价格：<\/span> <strong>RMB 15,976<\/strong> <\/li> <\/ul> <\/div> <div class=\"shipping-product-admin section top-divided mbm\"> <p class=\"rebate mbn\"><\/p> <ul class=\"product-shipping\"> <li><div id=\"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery\"><\/div><\/li> <\/ul> <\/div> <div style=\"display: none\" class=\"product-details-content\"> <\/div> <\/div> <\/div> <\/div> <\/li> ","updated":false,"_forms":{"main":{"subForms":["item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-delivery._forms.main","item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-shippingOptionsLink._forms.main"],"views":[{"key":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.quantity","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-quantity"}]}},"_events":[{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.showProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-productDetails","event":"click","target":"toggleProductDetails"},{"perform":"method","omniture":"item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-main.omniture.hideProductDetailsDelivery","id":"cart-item-9b9a2fab-6b9f-4697-8a23-86fa7e1d8ec6-hideproductDetails","event":"click","target":"toggleProductDetails"}]},"invoice":{"mode":"summary","_actions":{"edit":{"omniture":"omniture.editInvoice","form":"common._forms.document","url":"/cn/shop/checkoutx?_a=invoice.edit&_fid=co","validate":true}},"invoiceDeliveryAddress":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"editable":true,"fapiao":{"invoiceHeader":"个人","address":{"lastName":"刘","country":"中国","street3":"","city":"北京","firstName":"云伟","emailAddress":"liuyunwei@yanxiu.com","daytimePhoneAreaCode":"\u2022","street":"黄寺大街北广大厦","countryCode":"CN","district":"西城区","street2":"1018室","state":"北京","daytimePhone":"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202281"},"taxPayer":""},"_forms":{"invoiceHeaderForm":{"views":[{"key":"invoice.fapiao.invoiceHeader","id":"invoice-summary-user-fapiao-invoiceHeader"}]},"main":{"subForms":["invoice._forms.invoiceAddressForm","invoice._forms.invoiceHeaderForm","invoice._forms.taxPayerForm","invoice._forms.invoiceDeliveryAddressForm"]},"invoiceDeliveryAddressForm":{"views":[{"key":"invoice.invoiceDeliveryAddress.lastName","id":"invoice-summary-user-invoiceDeliveryAddress-lastName"},{"key":"invoice.invoiceDeliveryAddress.firstName","id":"invoice-summary-user-invoiceDeliveryAddress-firstName"},{"key":"invoice.invoiceDeliveryAddress.daytimePhoneAreaCode","id":"invoice-summary-user-invoiceDeliveryAddress-daytimePhoneAreaCode"},{"key":"invoice.invoiceDeliveryAddress.daytimePhone","id":"invoice-summary-user-invoiceDeliveryAddress-daytimePhone"},{"key":"invoice.invoiceDeliveryAddress.companyName","id":"invoice-summary-user-invoiceDeliveryAddress-companyName"},{"key":"invoice.invoiceDeliveryAddress.state","id":"invoice-summary-user-invoiceDeliveryAddress-state"},{"key":"invoice.invoiceDeliveryAddress.city","id":"invoice-summary-user-invoiceDeliveryAddress-city"},{"key":"invoice.invoiceDeliveryAddress.district","id":"invoice-summary-user-invoiceDeliveryAddress-district"},{"key":"invoice.invoiceDeliveryAddress.street","id":"invoice-summary-user-invoiceDeliveryAddress-street"},{"key":"invoice.invoiceDeliveryAddress.street2","id":"invoice-summary-user-invoiceDeliveryAddress-street2"},{"key":"invoice.invoiceDeliveryAddress.postalCode","id":"invoice-summary-user-invoiceDeliveryAddress-postalCode"},{"key":"invoice.invoiceDeliveryAddress.country","id":"invoice-summary-user-invoiceDeliveryAddress-country"}]},"invoiceAddressForm":{"views":[{"key":"invoice.fapiao.address.emailAddress","id":"invoice-summary-user-address-emailAddress"}]},"taxPayerForm":{"views":[{"key":"invoice.fapiao.taxPayer","id":"invoice-summary-user-fapiao-taxPayer"}]}},"enabled":true},"account":{"mode":"summary","commsPref":true,"editable":false,"_forms":{"main":{"subForms":["account._forms.accountForm"]},"accountForm":{"views":[{"html":" <div class=\"summary-content\" id=\"account-summary-content\"> <ul class=\"label-value-list\"> <li class=\"no-label\"> <span class=\"label\"> 未创建 ID <\/span> <span class=\"value\"> 访客 <\/span> <\/li> <\/ul> <\/div> ","id":"account-summary"},{"key":"account.appleId","id":"account-summary-appleId"}]}},"appleId":"liuyunwei@yanxiu.com","enabled":true}},"update":{"htmls":[{"value":" <div class=\"user-address subsection\" id=\"shipping-summary-user-address_section\"> <h3 class=\"label\">送货地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"shipping-summary-user-lastName\"> <\/span> <span class=\"firstName\" id=\"shipping-summary-user-firstName\"> <\/span> <span id=\"shipping-summary-user-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-contactLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"shipping-summary-user-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"shipping-summary-user-daytimePhone\"> <\/span><span id=\"shipping-summary-user-contactLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-0-prf\"><\/span><span class=\"state\" id=\"shipping-summary-user-state\"> <\/span> <span class=\"city\" id=\"shipping-summary-user-city\"> <\/span> <span class=\"district\" id=\"shipping-summary-user-district\"> <\/span> <span id=\"shipping-summary-user-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-1-prf\"><\/span><span class=\"street\" id=\"shipping-summary-user-street\"> <\/span><span id=\"shipping-summary-user-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-2-prf\"><\/span><span class=\"street2\" id=\"shipping-summary-user-street2\"> <\/span><span id=\"shipping-summary-user-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"shipping-summary-user-addressLines-3-prf\"><\/span><span class=\"postalCode\" id=\"shipping-summary-user-postalCode\"> <\/span> <span id=\"shipping-summary-user-addressLines-3-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"shipping-summary-user-country\"><\/span><\/span> <\/p> <div id=\"shipping-summary-user-address-aux\"><\/div> <\/div> <div id=\"shipping-summary-user-address_section-aux\"><\/div> <\/div> <div class=\"user-contact subsection\" id=\"shipping-summary-user-contact_section\"> <h3 class=\"label\">发货通知<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"shipping-summary-user-emailLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"shipping-summary-user-emailAddress\"> <\/span><span id=\"shipping-summary-user-emailLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"shipping-summary-user-notificationLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"mobilePhone\" id=\"shipping-summary-user-mobilePhone\"> <\/span><span id=\"shipping-summary-user-notificationLines-0-ext\"><\/span><\/p> <\/div> <div id=\"shipping-summary-user-contact_section-aux\"><\/div> <\/div> ","id":"shipping-summary-user"},{"value":" <legend><strong>付款方式<\/strong><\/legend> <p><span> <img class=\"ir\" src=\"https://store.storeimages.cdn-apple.com/8750/as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-WeChat?wid=280&amp;hei=52&amp;fmt=jpeg&amp;qlt=80&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" alt=\"微信支付\" width=\"140\" height=\"26\" data-scale-params-1=\"wid=140&amp;hei=26&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,1.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=bdikp2\" /> <\/span><\/p> ","id":"payment-summary-method"},{"value":"","id":"installment-learn-more-link"},{"value":"","id":"payment-summary-user"},{"value":" <div class=\"subsection\" id=\"invoice-summary-user-option\"><\/div> <div id=\"invoice-summary-user-details\" class=\"subsection\"><\/div> <div id=\"invoice-summary-user-invoiceDeliveryAddress\" class=\"subsection\"><\/div> ","id":"invoice-summary-user"},{"value":" <div class=\"invoice-option subsection\"> <h3 class=\"label\">发票类型<\/h3> <div class=\"value\"> <p> <span>Apple 电子收据与普通发票<\/span> <\/p> <\/div> <\/div> ","id":"invoice-summary-user-option"},{"value":" <div class=\"invoice-details\"> <div class=\"value\"> <div class=\"user-contact subsection\" id=\"invoice-summary-user-address-contact_section\"> <h3 class=\"label\">电子邮件地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"invoice-summary-user-address-contactLines-0-prf\"><\/span><span class=\"emailAddress\" id=\"invoice-summary-user-address-emailAddress\"> <\/span><span id=\"invoice-summary-user-address-contactLines-0-ext\"><\/span><\/p> <\/div> <div id=\"invoice-summary-user-address-contact_section-aux\"><\/div> <\/div> <\/div> <\/div> <div class=\"invoice-details subsection\"> <strong class=\"label\"> <span>发票抬头<\/span> <\/strong> <div class=\"value\"> <div class=\"mbs\"> <span id=\"invoice-summary-user-fapiao-invoiceHeader\"><\/span> <\/div> <div class=\"mbs\"> <span id=\"invoice-summary-user-fapiao-taxPayer\"><\/span> <\/div> <\/div> <\/div> ","id":"invoice-summary-user-details"},{"value":" <div class=\"user-address subsection\" id=\"invoice-summary-user-invoiceDeliveryAddress-address_section\"> <h3 class=\"label\">发票寄送地址<\/h3> <div class=\"value\"> <p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-nameLines-0-prf\"><\/span><span class=\"lastName\" id=\"invoice-summary-user-invoiceDeliveryAddress-lastName\"> <\/span> <span class=\"firstName\" id=\"invoice-summary-user-invoiceDeliveryAddress-firstName\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-nameLines-0-ext\"><\/span><\/p> <p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-0-prf\"><\/span><span class=\"a11y\">电话号码的最后两位<\/span><span class=\"daytimePhoneAreaCode\" id=\"invoice-summary-user-invoiceDeliveryAddress-daytimePhoneAreaCode\"> <\/span> <span class=\"daytimePhone\" id=\"invoice-summary-user-invoiceDeliveryAddress-daytimePhone\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-0-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-1-prf\"><\/span><span class=\"companyName\" id=\"invoice-summary-user-invoiceDeliveryAddress-companyName\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-1-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-2-prf\"><\/span><span class=\"state\" id=\"invoice-summary-user-invoiceDeliveryAddress-state\"> <\/span> <span class=\"city\" id=\"invoice-summary-user-invoiceDeliveryAddress-city\"> <\/span> <span class=\"district\" id=\"invoice-summary-user-invoiceDeliveryAddress-district\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-2-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-3-prf\"><\/span><span class=\"street\" id=\"invoice-summary-user-invoiceDeliveryAddress-street\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-3-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-4-prf\"><\/span><span class=\"street2\" id=\"invoice-summary-user-invoiceDeliveryAddress-street2\"> <\/span><span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-4-ext\"><\/span><\/p><p><span class=\"viewing\" id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-5-prf\"><\/span><span class=\"postalCode\" id=\"invoice-summary-user-invoiceDeliveryAddress-postalCode\"> <\/span> <span id=\"invoice-summary-user-invoiceDeliveryAddress-addressLines-5-ext\"><\/span><\/p> <p> <span class=\"country-field field-with-placeholder\"><span id=\"invoice-summary-user-invoiceDeliveryAddress-country\"><\/span><\/span> <\/p> <div id=\"invoice-summary-user-invoiceDeliveryAddress-address-aux\"><\/div> <\/div> <div id=\"invoice-summary-user-invoiceDeliveryAddress-address_section-aux\"><\/div> <\/div> ","id":"invoice-summary-user-invoiceDeliveryAddress"}]},"url":"/cn/shop/checkoutx"}}
		 */
	},
	confirmBill: {
		url: context =>`${context.session.checkoutUrl}x`,
		method: "post",
		params: context => ({
			aywysya: getMocker({documentUrl: context.lastStep.url}).aosform(),
			sessionID: context.session.sessionID,
			'promo-code':'',
			_a:'po',
			_fid:'co'
		}),
		parser: JSON.parse

	},
	confirmStatus: {
		url: context =>`${context.session.host}/cn/shop/checkout/status`,
		method: "get"
	},
	confirmCheckout: {
		url: context => `${context.session.host}/cn/shop/checkoutx/status?_a=status&_fid=co&_m=common`,
		method: "get"
	},
	showBillDetail: {
		url: context => `${context.session.host}/cn/shop/checkout/thankyou`,
		method: "get"
	},
	requestPay: {
		url: context => `${context.session.host}/cn/shop/checkoutx/thankyou`,
		method: "get",
		params: {
			_a: 'wechatpaynow',
			_fid: 'co'
		}
	},
	requestPayQrImage: {
		url: context => `${context.session.host}/cn/shop/checkoutx/thankyou`,
		method: "get",
		params: {
			_a: 'wechatpaynow',
			_fid: 'co',
			_m: 'common' 
		},
		parser: function(rawRes) {
			const res = JSON.parse(rawRes);
			return {
				orderNumber: res.body.replace.common.orderNumber,
				QrImageHtml: res.body.update.htmls[0].value
			};
		}
		/**
		 * {"head":{"data":{},"status":"200"},"body":{"replace":{"common":{"_operation":"process","orderNumber":"W519224464","_forms":{"document":{"subForms":["wechatPayNow._forms.main"]}}},"wechatPayNow":{"_forms":{"main":{"a11y-message":"生成二维码"}},"_events":[{"dialog":"true","using":"overlay","hasCloseButton":true,"classname":"overlay wechat-overlay","perform":"show","type":"WeChat","event":"load","target":"overlay-content"}]}},"update":{"htmls":[{"value":" <div id=\"wechat-paynow\"> <div id=\"overlay-header\" class=\"header\"> <h1>微信支付二维码<\/h1> <\/div> <div class=\"main\"> <div class=\"payment-summary\"> <div class=\"qr-code\"> <img alt=\"用于微信支付的二维码\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAAB9CAIAAAAA4vtyAAACCUlEQVR42u3aUW6EMAwFQO5/aXqAlSqIX5wA8z6rhS7TyiSOj1NW5EDAnbtw5y7cuQt37sKdu3Dnzl24cxfu3GWJ+1HLrftc+fDvZzqfgjt37lPdi1f9c58rv6J4w9RTcOfOvce9WHzHlG+V7Ian4M6d+87uVwTHvsat+s6dO/f3uV8xHftMcRnKnTv39+1Xi+2wsd2pPgF37o9wT/Xf1/7ku+ce3Llv7J5KvGQ/Ity5cy/W97FdZWdDf6x27/5e5c79de5jHfD43jg+NVX8D+POnXuze0OhjzfZd++/c+f+JffUF5130tY5ecmdO/ep7g2l/9Y7IH4Vd+7cl/ff541FFgVTR3e7r9+5c/+2e7zbnuqLxae3uXPn3rNfLS4oO/eQ8wa7uXPn3uOemiyc1yAbWz7uXt+5c3+de2r9V3zO1NhTcWXJnTv3VevIVGFNjTPG23PcuXPvqe+p50x124t/yNQWnTt37jvX93ivf6xZP1b6uXPnPrW+N7wVis24+NA2d+7cm+t76snHeuupCaRia547d+4z3ItXpRZw8U3p7vtV7tw/6R4//l+yxBw7+ePOnfsj3OddlWqZbbqO5M6d+/3zuXjPq2FGijt37o/YrxYr/j57Ue7cue/Wfx/ryDdMM7z83IM79ye4y5r6Lty5C3fuwp07d+HOXbhzF+7chTt34c5dzvMPs9NoEGmO8jEAAAAASUVORK5CYII=\" id=\"wechat-qr-code\" /> <\/div> <div class=\"payment\"> <div class=\"payment-method\"> <img width=\"140\" height=\"26\" src=\"https://as-images.apple.com/is/image/AppleInc/aos/published/images/c/he/checkout/bank/checkout-bank-WeChat?wid=280&hei=52&fmt=png-alpha&qlt=95&.v=bdikp2\" alt=\"\" style=\"vertical-align: middle; background-size:contain;\" /> <\/div> <div class=\"payment-total\"> <span class=\"total-label\">交易金额<\/span> <span class=\"total-value\">RMB 15,976<\/span> <\/div> <\/div> <\/div> <div class=\"wechat-instr\"> <h2>微信支付付款说明<\/h2> <ul> <li>我们将在确认付款后处理你的订单，并向你发送一封包含更新后的送货信息的电子邮件或 iMessage 。<\/li> <li>在收货时，需提供订单购买人或订单中列明的接收人的身份证明，或者发货通知邮件或 iMessage 。<\/li> <\/ul> <\/div> <\/div> <div class=\"footer\"> <\/div> <\/div> ","id":"overlay-content"}]}}}
		 */
	}


};




class Client extends Emitter {
	/**
	 * 
	 * 
	 * 
	 * 	{
			iphone: {dimensionColor, dimensionScreensize, product, dimensionCapacity, detailUrl, name, quantity },
			user:{
				lastName, firstName, invoiceHeader, 
				emailAddress, daytimePhoneAreaCode, daytimePhone,
				state, city, district, street, street2, postalCode,
			}

		}
	 */
	constructor({
		iphone, user
	}){

		super();
		this.uid = md5(JSON.stringify({iphone, user}));
		this.debug = debug(`client-${this.uid}`);
		this.debug.enabled = true;
		this.context = {
			uid: this.uid,
			iphone,
			user,
			system,
			session: {}
		};
		this.maxTryTimes = 3;
		this.actions = [
			/**
			 * select item to add to bag
			 */
			"scanItem", "selectItem", "addBag", "scanBag", "updateQuantity", "shoppingCart",

			/**
			 * process user session
			 */
			"gotoSign", "signIn", "startSession",

			/**
			 * fill other infos
			 */
			"checkout", "fillCart", "fillShip", "fillBill", "fillInvoiceType", "fillInvoice", "fillAccount", "fillTnc", 

			/**
			 * confirm and confirm, print the Bill detail finnaly if OK
			 */
			"confirmBill", "confirmStatus", "confirmCheckout", "showBillDetail",

			/**
			 * show pay info
			 */
			"requestPay", "delay", "requestPayQrImage"

			
		];


		this.cookieFileName = `./cookies/${this.uid}.json`;
		if(!fs.existsSync(this.cookieFileName)) {
			fs.writeFileSync(this.cookieFileName, '');
		}
		this.jar = request.jar(new FileCookieStore(this.cookieFileName));
		//this.jar = request.jar();
		this.request = request.defaults({
			jar: this.jar,
			timeout: 5000,
		 	headers: {
		    	'User-Agent': system.userAgent
		  	}
		});

		this.debug(`uid:${this.uid}`);
		console.log(`context:`, this.context);

	}

	async start(){
		const startTime = new Date();
		let context = this.context, lastRes = null, lastStep = null;


		// apply the actions one by one
		for(let actionName of this.actions) {
			this.debug(`========================= processing the step: [${actionName}] ==================`);

			if(actionName == "delay") {
				await new Promise(resolve => {
					setTimeout(resolve, 2000);
				});
				continue;
			}

			let action = actions[actionName];
			let step = action;



			// action support both thunk function and value
			if(action instanceof Function) {
				step = action.bind(this).call(this, context, lastRes);
			}

			context.currentActionName = actionName;
			context.currentStep = step;

			// all this attr support both thunk function and value
			for(let attrName of ["url", "method", "params","headers"]) {
				let attr = step[attrName];
				if(attr instanceof Function) {
					step[attrName] = attr.bind(this).call(this, context, lastRes);
				}
			}
			step.tryTimes = 0;
			const thunkRequest = (async function(){
				// send a request
				const {url, method, params, headers} = step;
				this.debug(`request:`, step);
				const rawRes = await this.request({
					url, method, headers,
					[method == "post" ? "form": "qs"]: params

				});
				
				console.log(actionName, rawRes);
				// parse a "set-cookie" meta tag in html
				this.parseCookies(rawRes);

				// use parser to parse  rawRes
				lastRes = step.parser? step.parser.bind(this).call(this, rawRes): rawRes;
				lastStep = step;
			}).bind(this);

			while(step.tryTimes++ < this.maxTryTimes) {
				try{
					await thunkRequest();
					break;
				} catch(e) {
					this.debug(`>>>>>>>>>>>>>>>>> ERROR in action [${actionName}] <<<<<<<<`, e);
					if(step.tryTimes >= this.maxTryTimes - 1) {
						if(step.skipAble) {
							this.debug(">>>>>>>>>> FAIL in action [${actionName}], but skippable, SKIP it!!! <<<<<<<<", e);
						} else {
							this.debug(`>>>>>>>> FAIL in action [${actionName}] <<<<<<<<<`, e);
							throw new Error({
								e: e
							});
						}

					} else {
						this.debug(`trying again: ${step.tryTimes+1} times`);
					}
				}
			}

			context.lastRes = lastRes;
			context.lastStep = lastStep;
			this.debug(`-----------------------  the step end: [${actionName}] ----------------------\n\n\n`);
		}

		const costTime = Math.ceil((new Date() - startTime)/1000);
		this.debug(`cost: ${costTime}s`);

		return {
			status: lastRes.orderNumber ? "SUCCESS": "FAIL",
			data: lastRes,
			context: this.context
		};

	}
	/**
	 * @param  {string} rawRes ,the resopnse body, maybe a string or stringBuffer
	 * @return {null}
	 */
	parseCookies(rawRes){
		
		rawRes = rawRes+"";

		let matches = rawRes.match(/http-equiv="Set-Cookie" content=\"(.+)\"/);
		if(matches && matches[1]) {
			let cookieString = matches[1];
			this.debug("find a cookie:", cookieString);
			
			let cookie = this.request.cookie(cookieString);
			this.jar.setCookie(cookie, this.context.currentStep.url);
		}
		
	}

}


module.exports = Client;
